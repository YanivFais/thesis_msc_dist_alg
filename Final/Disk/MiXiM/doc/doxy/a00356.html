<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>MiXiM: base/phyLayer/BaseDecider.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.8 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="dir_1538cff59aa1d865678ab06d5aac9144.html">base</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_098be402d6c2a2f6f8c8b868d19ba831.html">phyLayer</a>
  </div>
</div>
<div class="contents">
<h1>BaseDecider.h</h1><a href="a00179.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment"> * BaseDecider.h</span>
<a name="l00003"></a>00003 <span class="comment"> *</span>
<a name="l00004"></a>00004 <span class="comment"> *  Created on: 24.02.2009</span>
<a name="l00005"></a>00005 <span class="comment"> *      Author: karl</span>
<a name="l00006"></a>00006 <span class="comment"> */</span>
<a name="l00007"></a>00007 
<a name="l00008"></a>00008 <span class="preprocessor">#ifndef BASEDECIDER_H_</span>
<a name="l00009"></a>00009 <span class="preprocessor"></span><span class="preprocessor">#define BASEDECIDER_H_</span>
<a name="l00010"></a>00010 <span class="preprocessor"></span>
<a name="l00011"></a>00011 <span class="preprocessor">#include "<a class="code" href="a00187.html">Decider.h</a>"</span>
<a name="l00012"></a>00012 
<a name="l00013"></a><a class="code" href="a00179.html#43107a17c21e08a3b52d6957f01d3987">00013</a> <span class="preprocessor">#define debugEV (ev.isDisabled()||!debug) ? ev : ev &lt;&lt; "[Host " &lt;&lt; myIndex &lt;&lt; "] - PhyLayer(Decider): "</span>
<a name="l00014"></a>00014 <span class="preprocessor"></span>
<a name="l00040"></a><a class="code" href="a00011.html">00040</a> <span class="keyword">class </span><a class="code" href="a00011.html" title="Provides some base functionality for most common deciders.">BaseDecider</a>: <span class="keyword">public</span> <a class="code" href="a00052.html" title="The basic Decider class.">Decider</a> {
<a name="l00041"></a>00041 <span class="keyword">protected</span>:
<a name="l00042"></a><a class="code" href="a00011.html#e4acbca8f960e9c49379ae2a82e2d90b">00042</a>   <span class="keyword">enum</span> <a class="code" href="a00011.html#e4acbca8f960e9c49379ae2a82e2d90b">SignalState</a>{
<a name="l00043"></a><a class="code" href="a00011.html#e4acbca8f960e9c49379ae2a82e2d90b3276f47da7417662597b21ee3afa2d31">00043</a>     <a class="code" href="a00011.html#e4acbca8f960e9c49379ae2a82e2d90b3276f47da7417662597b21ee3afa2d31">NEW</a>,      
<a name="l00044"></a><a class="code" href="a00011.html#e4acbca8f960e9c49379ae2a82e2d90bf0a66719215a9be8335546666facaab6">00044</a>     <a class="code" href="a00011.html#e4acbca8f960e9c49379ae2a82e2d90bf0a66719215a9be8335546666facaab6" title="Signal is received the first time.">EXPECT_HEADER</a>,  
<a name="l00045"></a><a class="code" href="a00011.html#e4acbca8f960e9c49379ae2a82e2d90b5539b8e545c0676dab0b0efb80dfeeac">00045</a>     <a class="code" href="a00011.html#e4acbca8f960e9c49379ae2a82e2d90b5539b8e545c0676dab0b0efb80dfeeac" title="Waiting for the header of the signal.">EXPECT_END</a>,   
<a name="l00046"></a>00046   };
<a name="l00047"></a>00047 
<a name="l00049"></a><a class="code" href="a00011.html#5eece8bf532f92912ccbd0a3bc4d6fb0">00049</a>   <span class="keywordtype">double</span> <a class="code" href="a00011.html#5eece8bf532f92912ccbd0a3bc4d6fb0" title="sensitivity value for receiving an AirFrame">sensitivity</a>;
<a name="l00050"></a>00050 
<a name="l00052"></a><a class="code" href="a00011.html#4b3ede0e569c778173b7e430d958f92a">00052</a>   <span class="keyword">typedef</span> std::pair&lt;AirFrame*, int&gt; <a class="code" href="a00011.html#4b3ede0e569c778173b7e430d958f92a" title="Pair of a AirFrame and the state it is in.">ReceivedSignal</a>;
<a name="l00053"></a>00053 
<a name="l00055"></a><a class="code" href="a00011.html#22e578e992fab5ab54fe5fcdf196d9e3">00055</a>   <a class="code" href="a00011.html#4b3ede0e569c778173b7e430d958f92a" title="Pair of a AirFrame and the state it is in.">ReceivedSignal</a> <a class="code" href="a00011.html#22e578e992fab5ab54fe5fcdf196d9e3" title="pointer to the currently received AirFrame">currentSignal</a>;
<a name="l00056"></a>00056 
<a name="l00058"></a><a class="code" href="a00011.html#535bb5ab48036db02bed8fcf5c4e415d">00058</a>   <span class="keywordtype">bool</span> <a class="code" href="a00011.html#535bb5ab48036db02bed8fcf5c4e415d" title="Stores the idle state of the channel.">isChannelIdle</a>;
<a name="l00059"></a>00059 
<a name="l00061"></a><a class="code" href="a00011.html#cf6221fc304163856f01b71710922cd3">00061</a>   <span class="keyword">typedef</span> std::pair&lt;ChannelSenseRequest*, simtime_t&gt; <a class="code" href="a00011.html#cf6221fc304163856f01b71710922cd3" title="Pair of a ChannelSenseRequest and the simtime it started.">CSRInfo</a>;
<a name="l00062"></a>00062 
<a name="l00064"></a><a class="code" href="a00011.html#c6cd60e58a8a557ed511f8193ced4f7e">00064</a>   <a class="code" href="a00011.html#cf6221fc304163856f01b71710922cd3" title="Pair of a ChannelSenseRequest and the simtime it started.">CSRInfo</a> <a class="code" href="a00011.html#c6cd60e58a8a557ed511f8193ced4f7e" title="pointer to the currently running ChannelSenseRequest and its start-time">currentChannelSenseRequest</a>;
<a name="l00065"></a>00065 
<a name="l00068"></a><a class="code" href="a00011.html#33e7f02028e78116193d09d6cdbc987e">00068</a>   <span class="keywordtype">int</span> <a class="code" href="a00011.html#33e7f02028e78116193d09d6cdbc987e" title="index for this Decider-instance given by Phy-Layer (mostly Host-index) default-value...">myIndex</a>;
<a name="l00069"></a>00069 
<a name="l00071"></a><a class="code" href="a00011.html#a22cd5156240713e37578172ba5557ce">00071</a>   <span class="keywordtype">bool</span> <a class="code" href="a00011.html#a22cd5156240713e37578172ba5557ce" title="toggles display of debugging messages">debug</a>;
<a name="l00072"></a>00072 
<a name="l00073"></a>00073 <span class="keyword">public</span>:
<a name="l00074"></a><a class="code" href="a00011.html#cff4618fa7a9c2e9abf257e60e487de2">00074</a>   <a class="code" href="a00011.html#cff4618fa7a9c2e9abf257e60e487de2">BaseDecider</a>(<a class="code" href="a00057.html" title="This class is the interface for a Decider to the BasePhyLayer.">DeciderToPhyInterface</a>* <a class="code" href="a00052.html#e47e3459af2a4a7a1f14f6e60d2fc4c8" title="A pointer to the physical layer of this Decider.">phy</a>, <span class="keywordtype">double</span> <a class="code" href="a00011.html#5eece8bf532f92912ccbd0a3bc4d6fb0" title="sensitivity value for receiving an AirFrame">sensitivity</a>, <span class="keywordtype">int</span> <a class="code" href="a00011.html#33e7f02028e78116193d09d6cdbc987e" title="index for this Decider-instance given by Phy-Layer (mostly Host-index) default-value...">myIndex</a>, <span class="keywordtype">bool</span> <a class="code" href="a00011.html#a22cd5156240713e37578172ba5557ce" title="toggles display of debugging messages">debug</a>):
<a name="l00075"></a>00075     <a class="code" href="a00052.html" title="The basic Decider class.">Decider</a>(phy),
<a name="l00076"></a>00076     sensitivity(sensitivity),
<a name="l00077"></a>00077     <a class="code" href="a00011.html#535bb5ab48036db02bed8fcf5c4e415d" title="Stores the idle state of the channel.">isChannelIdle</a>(true),
<a name="l00078"></a>00078     myIndex(myIndex),
<a name="l00079"></a>00079     debug(debug)
<a name="l00080"></a>00080   {
<a name="l00081"></a>00081     <a class="code" href="a00011.html#22e578e992fab5ab54fe5fcdf196d9e3" title="pointer to the currently received AirFrame">currentSignal</a>.first = 0;
<a name="l00082"></a>00082     <a class="code" href="a00011.html#22e578e992fab5ab54fe5fcdf196d9e3" title="pointer to the currently received AirFrame">currentSignal</a>.second = <a class="code" href="a00011.html#e4acbca8f960e9c49379ae2a82e2d90b3276f47da7417662597b21ee3afa2d31">NEW</a>;
<a name="l00083"></a>00083     <a class="code" href="a00011.html#c6cd60e58a8a557ed511f8193ced4f7e" title="pointer to the currently running ChannelSenseRequest and its start-time">currentChannelSenseRequest</a> = std::pair&lt;ChannelSenseRequest*, simtime_t&gt;(0, -1);
<a name="l00084"></a>00084   }
<a name="l00085"></a>00085 
<a name="l00086"></a><a class="code" href="a00011.html#486cd5548e3f75deff4dc9e3bd52fbb1">00086</a>   <span class="keyword">virtual</span> <a class="code" href="a00011.html#486cd5548e3f75deff4dc9e3bd52fbb1">~BaseDecider</a>() {}
<a name="l00087"></a>00087 
<a name="l00088"></a>00088 <span class="keyword">public</span>:
<a name="l00094"></a>00094   <span class="keyword">virtual</span> simtime_t <a class="code" href="a00011.html#273892d7b0c9874e4efe3c7755aa7a17" title="Processes an AirFrame given by the PhyLayer.">processSignal</a>(AirFrame* frame);
<a name="l00095"></a>00095 
<a name="l00103"></a>00103   <span class="keyword">virtual</span> <a class="code" href="a00037.html" title="Provides information about the current state of the channel:.">ChannelState</a> <a class="code" href="a00011.html#f471a55749109aacb99429b409ccb9c1" title="A function that returns information about the channel state.">getChannelState</a>();
<a name="l00104"></a>00104 
<a name="l00117"></a>00117   <span class="keyword">virtual</span> simtime_t <a class="code" href="a00011.html#fd31e5a65d1798d329ace9bdbec25d64" title="This function is called by the PhyLayer to hand over a ChannelSenseRequest.">handleChannelSenseRequest</a>(ChannelSenseRequest* request);
<a name="l00118"></a>00118 
<a name="l00119"></a>00119 <span class="keyword">protected</span>:
<a name="l00129"></a>00129   <span class="keyword">virtual</span> simtime_t <a class="code" href="a00011.html#6a480f87157d0509c0c1fccf94ea9fef" title="Processes a new Signal. Returns the time it wants to handle the signal again.">processNewSignal</a>(AirFrame* frame);
<a name="l00130"></a>00130 
<a name="l00138"></a><a class="code" href="a00011.html#d931e0965c66fef10c9407d4abecbaf5">00138</a>   <span class="keyword">virtual</span> simtime_t <a class="code" href="a00011.html#d931e0965c66fef10c9407d4abecbaf5" title="Processes the end of the header of a received Signal.">processSignalHeader</a>(AirFrame* frame) {
<a name="l00139"></a>00139     opp_error(<span class="stringliteral">"BaseDecider does not handle Signal headers!"</span>);
<a name="l00140"></a>00140     <span class="keywordflow">return</span> <a class="code" href="a00052.html#3edae7484aed7b0b874521c724bd3c30" title="simtime that tells the Phy-Layer not to pass an AirFrame again">notAgain</a>;
<a name="l00141"></a>00141   }
<a name="l00142"></a>00142 
<a name="l00152"></a>00152   <span class="keyword">virtual</span> simtime_t <a class="code" href="a00011.html#b9cfef6c04e12d2524d45e881f341300" title="Processes the end of a received Signal.">processSignalEnd</a>(AirFrame* frame);
<a name="l00153"></a>00153 
<a name="l00158"></a><a class="code" href="a00011.html#8a84e9ec29da8ec490d94dd7e68a6b04">00158</a>   <span class="keyword">virtual</span> simtime_t <a class="code" href="a00011.html#8a84e9ec29da8ec490d94dd7e68a6b04" title="Processes any Signal for which no state could be found. (is an error case).">processUnknownSignal</a>(AirFrame* frame) {
<a name="l00159"></a>00159     opp_error(<span class="stringliteral">"Unknown state for the AirFrame with ID %d"</span>, frame-&gt;getId());
<a name="l00160"></a>00160     <span class="keywordflow">return</span> <a class="code" href="a00052.html#3edae7484aed7b0b874521c724bd3c30" title="simtime that tells the Phy-Layer not to pass an AirFrame again">notAgain</a>;
<a name="l00161"></a>00161   }
<a name="l00162"></a>00162 
<a name="l00170"></a>00170   <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="a00011.html#a41d7cb370ba4069108ede77732b3bc8" title="Returns the SignalState for the passed AirFrame.">getSignalState</a>(AirFrame* frame);
<a name="l00171"></a>00171 
<a name="l00176"></a>00176   <span class="keyword">virtual</span> simtime_t <a class="code" href="a00011.html#1dba383c238fba606279ef483b435f78" title="Handles a new incoming ChannelSenseRequest and returns the next (or latest) time...">handleNewSenseRequest</a>(ChannelSenseRequest* request);
<a name="l00177"></a>00177 
<a name="l00182"></a>00182   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="a00011.html#04331dd4b050ca2bc431254a15eee174" title="Handles the timeout of a ChannelSenseRequest by calculating the ChannelState and...">handleSenseRequestTimeout</a>(<a class="code" href="a00011.html#cf6221fc304163856f01b71710922cd3" title="Pair of a ChannelSenseRequest and the simtime it started.">CSRInfo</a>&amp; requestInfo);
<a name="l00183"></a>00183 
<a name="l00190"></a>00190   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="a00011.html#e535b44e34061014fe282c36c27b0193" title="Changes the &amp;quot;isIdle&amp;quot;-status to the passed value.">setChannelIdleStatus</a>(<span class="keywordtype">bool</span> isIdle);
<a name="l00191"></a>00191 
<a name="l00196"></a>00196   <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="a00011.html#685497c4babb03a50b8967fb7505acc0" title="Returns true if the ChannelSenseRequest of the passed CSRInfo can be answered (e...">canAnswerCSR</a>(<span class="keyword">const</span> <a class="code" href="a00011.html#cf6221fc304163856f01b71710922cd3" title="Pair of a ChannelSenseRequest and the simtime it started.">CSRInfo</a>&amp; requestInfo);
<a name="l00197"></a>00197 
<a name="l00209"></a>00209   <span class="keyword">virtual</span> <span class="keywordtype">double</span> <a class="code" href="a00011.html#f326e85e885a64d5deea135dc4bcdb85" title="Calculates the RSSI value for the passed ChannelSenseRequest.">calcChannelSenseRSSI</a>(<a class="code" href="a00011.html#cf6221fc304163856f01b71710922cd3" title="Pair of a ChannelSenseRequest and the simtime it started.">CSRInfo</a>&amp; requestInfo);
<a name="l00210"></a>00210 
<a name="l00217"></a>00217   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="a00011.html#b8e925001d1f8630338c50f8ec10bb0d" title="Answers the ChannelSenseRequest (CSR) from the passed CSRInfo.">answerCSR</a>(<a class="code" href="a00011.html#cf6221fc304163856f01b71710922cd3" title="Pair of a ChannelSenseRequest and the simtime it started.">CSRInfo</a>&amp; requestInfo);
<a name="l00218"></a>00218 
<a name="l00219"></a>00219   <span class="comment">//------Utility methods------------</span>
<a name="l00220"></a>00220 
<a name="l00232"></a>00232   <span class="keyword">virtual</span> <a class="code" href="a00092.html" title="Represents a changeable mapping (mathematical function) from at least time to double...">Mapping</a>* <a class="code" href="a00011.html#bac709d59f48d292f147919854c002e2" title="Calculates a SNR-Mapping for a Signal.">calculateSnrMapping</a>(AirFrame* frame);
<a name="l00233"></a>00233 
<a name="l00241"></a>00241   <span class="keyword">virtual</span> <a class="code" href="a00092.html" title="Represents a changeable mapping (mathematical function) from at least time to double...">Mapping</a>* <a class="code" href="a00011.html#11e802adb6060617d7357d308d3b2cdb" title="Calculates a RSSI-Mapping (or Noise-Strength-Mapping) for a Signal.">calculateRSSIMapping</a>(  simtime_t start,
<a name="l00242"></a>00242                       simtime_t end,
<a name="l00243"></a>00243                       AirFrame* exclude = 0);
<a name="l00244"></a>00244 };
<a name="l00245"></a>00245 
<a name="l00246"></a>00246 <span class="preprocessor">#endif </span><span class="comment">/* BASEDECIDER_H_ */</span>
</pre></div></div>
<hr size="1"><address style="text-align: right;"><small>Generated on Mon Sep 28 15:56:34 2009 for MiXiM by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.8 </small></address>
</body>
</html>
