<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>MiXiM: base/phyLayer/PhyUtils.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.8 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="dir_1538cff59aa1d865678ab06d5aac9144.html">base</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_098be402d6c2a2f6f8c8b868d19ba831.html">phyLayer</a>
  </div>
</div>
<div class="contents">
<h1>PhyUtils.h</h1><a href="a00199.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="preprocessor">#ifndef PHYUTILS_H_</span>
<a name="l00002"></a>00002 <span class="preprocessor"></span><span class="preprocessor">#define PHYUTILS_H_</span>
<a name="l00003"></a>00003 <span class="preprocessor"></span>
<a name="l00004"></a>00004 <span class="preprocessor">#include "<a class="code" href="a00177.html">AnalogueModel.h</a>"</span>
<a name="l00005"></a>00005 <span class="preprocessor">#include "<a class="code" href="a00192.html">Mapping.h</a>"</span>
<a name="l00006"></a>00006 
<a name="l00007"></a>00007 <span class="preprocessor">#include &lt;omnetpp.h&gt;</span>
<a name="l00008"></a>00008 <span class="preprocessor">#include &lt;iostream&gt;</span>
<a name="l00009"></a>00009 <span class="preprocessor">#include &lt;assert.h&gt;</span>
<a name="l00010"></a>00010 <span class="preprocessor">#include &lt;list&gt;</span>
<a name="l00011"></a>00011 
<a name="l00012"></a>00012 
<a name="l00013"></a>00013 
<a name="l00014"></a>00014 <span class="keyword">class </span><a class="code" href="a00122.html" title="This class represents the corresponding mapping to a RadioStateAnalogueModel (RSAM)...">RSAMMapping</a>;
<a name="l00015"></a>00015 
<a name="l00023"></a><a class="code" href="a00113.html">00023</a> <span class="keyword">class </span><a class="code" href="a00113.html" title="This special AnalogueModel provides filtering of a Signal according to the actual...">RadioStateAnalogueModel</a> : <span class="keyword">public</span> <a class="code" href="a00001.html" title="Interface for the analogue models of the physical layer.">AnalogueModel</a>
<a name="l00024"></a>00024 {
<a name="l00025"></a><a class="code" href="a00113.html#6ec9262901fa86ea2ef6d08fc9410144">00025</a>   <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="a00122.html" title="This class represents the corresponding mapping to a RadioStateAnalogueModel (RSAM)...">RSAMMapping</a>;
<a name="l00026"></a><a class="code" href="a00113.html#b901736afc45f0b8dbe019c39356aa09">00026</a>   <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="a00121.html" title="ConstMapingIterator implementation for a RSAM.">RSAMConstMappingIterator</a>;
<a name="l00027"></a>00027 
<a name="l00028"></a>00028 <span class="keyword">protected</span>:
<a name="l00029"></a>00029 
<a name="l00037"></a><a class="code" href="a00114.html">00037</a>   <span class="keyword">class </span><a class="code" href="a00114.html" title="data structure for the list elements, consists basically of a pair of a simtime_t...">ListEntry</a>
<a name="l00038"></a>00038   {
<a name="l00039"></a>00039 
<a name="l00040"></a>00040   <span class="keyword">protected</span>:
<a name="l00041"></a><a class="code" href="a00114.html#612bcfd425207b239ec965148083602f">00041</a>     std::pair&lt;simtime_t, double&gt; <a class="code" href="a00114.html#612bcfd425207b239ec965148083602f">basicTimestamp</a>;
<a name="l00042"></a>00042 
<a name="l00043"></a>00043   <span class="keyword">public</span>:
<a name="l00044"></a><a class="code" href="a00114.html#3fc741bf8d71f76627c4cabb1cdb2142">00044</a>     <a class="code" href="a00114.html#3fc741bf8d71f76627c4cabb1cdb2142">ListEntry</a>(simtime_t time, <span class="keywordtype">double</span> value)
<a name="l00045"></a>00045     {
<a name="l00046"></a>00046       <a class="code" href="a00114.html#612bcfd425207b239ec965148083602f">basicTimestamp</a> = std::pair&lt;simtime_t, double&gt; (time, value);
<a name="l00047"></a>00047     }
<a name="l00048"></a>00048 
<a name="l00049"></a><a class="code" href="a00114.html#de75614e1843674432f4f3109da28999">00049</a>     <span class="keyword">virtual</span> <a class="code" href="a00114.html#de75614e1843674432f4f3109da28999">~ListEntry</a>() {}
<a name="l00050"></a>00050 
<a name="l00051"></a><a class="code" href="a00114.html#d1695bd2a9c109c69efa6ef248267078">00051</a>     simtime_t <a class="code" href="a00114.html#d1695bd2a9c109c69efa6ef248267078">getTime</a>()<span class="keyword"> const</span>
<a name="l00052"></a>00052 <span class="keyword">    </span>{
<a name="l00053"></a>00053       <span class="keywordflow">return</span> <a class="code" href="a00114.html#612bcfd425207b239ec965148083602f">basicTimestamp</a>.first;
<a name="l00054"></a>00054     }
<a name="l00055"></a>00055 
<a name="l00056"></a><a class="code" href="a00114.html#0ff05521a541a9fb77ffd1acf5ed599f">00056</a>     <span class="keywordtype">void</span> <a class="code" href="a00114.html#0ff05521a541a9fb77ffd1acf5ed599f">setTime</a>(simtime_t time)
<a name="l00057"></a>00057     {
<a name="l00058"></a>00058       <a class="code" href="a00114.html#612bcfd425207b239ec965148083602f">basicTimestamp</a>.first = time;
<a name="l00059"></a>00059     }
<a name="l00060"></a>00060 
<a name="l00061"></a><a class="code" href="a00114.html#608d0d3fd2c8a86bd880188af7f8b5cd">00061</a>     <span class="keywordtype">double</span> <a class="code" href="a00114.html#608d0d3fd2c8a86bd880188af7f8b5cd">getValue</a>()<span class="keyword"> const</span>
<a name="l00062"></a>00062 <span class="keyword">    </span>{
<a name="l00063"></a>00063       <span class="keywordflow">return</span> <a class="code" href="a00114.html#612bcfd425207b239ec965148083602f">basicTimestamp</a>.second;
<a name="l00064"></a>00064     }
<a name="l00065"></a>00065 
<a name="l00066"></a><a class="code" href="a00114.html#e1882415e537e0b31c7798977e4c0e18">00066</a>     <span class="keywordtype">void</span> <a class="code" href="a00114.html#e1882415e537e0b31c7798977e4c0e18">setValue</a>(<span class="keywordtype">double</span> value)
<a name="l00067"></a>00067     {
<a name="l00068"></a>00068       <a class="code" href="a00114.html#612bcfd425207b239ec965148083602f">basicTimestamp</a>.second = value;
<a name="l00069"></a>00069     }
<a name="l00070"></a>00070 
<a name="l00075"></a><a class="code" href="a00114.html#8c47995f6607bcbfd28b494582de0a40">00075</a>     <span class="keyword">friend</span> <span class="keywordtype">bool</span> <a class="code" href="a00114.html#8c47995f6607bcbfd28b494582de0a40">operator&lt;</a>(<span class="keyword">const</span> <a class="code" href="a00114.html" title="data structure for the list elements, consists basically of a pair of a simtime_t...">ListEntry</a>&amp; e, <span class="keyword">const</span> simtime_t&amp; t)
<a name="l00076"></a>00076     {
<a name="l00077"></a>00077       <span class="keywordflow">return</span> (e.<a class="code" href="a00114.html#d1695bd2a9c109c69efa6ef248267078">getTime</a>() &lt; t);
<a name="l00078"></a>00078     }
<a name="l00079"></a>00079 
<a name="l00080"></a><a class="code" href="a00114.html#826615cf375c4118449aa4c8519df244">00080</a>     <span class="keyword">friend</span> <span class="keywordtype">bool</span> <a class="code" href="a00114.html#8c47995f6607bcbfd28b494582de0a40">operator&lt;</a>(<span class="keyword">const</span> simtime_t&amp; t, <span class="keyword">const</span> <a class="code" href="a00114.html" title="data structure for the list elements, consists basically of a pair of a simtime_t...">ListEntry</a>&amp; e)
<a name="l00081"></a>00081     {
<a name="l00082"></a>00082       <span class="keywordflow">return</span> (t &lt; e.<a class="code" href="a00114.html#d1695bd2a9c109c69efa6ef248267078">getTime</a>());
<a name="l00083"></a>00083     }
<a name="l00084"></a>00084 
<a name="l00085"></a>00085 
<a name="l00086"></a>00086   };
<a name="l00087"></a>00087 
<a name="l00088"></a>00088 
<a name="l00092"></a><a class="code" href="a00113.html#576c1bc7398c256153ac9e22bbc84f61">00092</a>   <span class="keywordtype">bool</span> <a class="code" href="a00113.html#576c1bc7398c256153ac9e22bbc84f61" title="Indicator variable whether we are currently tracking changes.">currentlyTracking</a>;
<a name="l00093"></a>00093 
<a name="l00097"></a><a class="code" href="a00113.html#65205e0c07b6e08e7fa236ebf4f052e4">00097</a>   std::list&lt;ListEntry&gt; <a class="code" href="a00113.html#65205e0c07b6e08e7fa236ebf4f052e4" title="Data structure to track when the Radio is receiving.">radioIsReceiving</a>;
<a name="l00098"></a>00098 
<a name="l00099"></a>00099 
<a name="l00100"></a>00100 
<a name="l00101"></a>00101 <span class="keyword">public</span>:
<a name="l00102"></a>00102 
<a name="l00108"></a><a class="code" href="a00113.html#b02ae65f079ab5d2f2bd967b551d6384">00108</a>   <a class="code" href="a00113.html#b02ae65f079ab5d2f2bd967b551d6384" title="Standard constructor for a RadioStateAnalogueModel instance.">RadioStateAnalogueModel</a>(<span class="keywordtype">double</span> initValue,
<a name="l00109"></a>00109               <span class="keywordtype">bool</span> <a class="code" href="a00113.html#576c1bc7398c256153ac9e22bbc84f61" title="Indicator variable whether we are currently tracking changes.">currentlyTracking</a> = <span class="keyword">true</span>,
<a name="l00110"></a>00110               simtime_t initTime = 0)
<a name="l00111"></a>00111     : <a class="code" href="a00113.html#576c1bc7398c256153ac9e22bbc84f61" title="Indicator variable whether we are currently tracking changes.">currentlyTracking</a>(<a class="code" href="a00113.html#576c1bc7398c256153ac9e22bbc84f61" title="Indicator variable whether we are currently tracking changes.">currentlyTracking</a>)
<a name="l00112"></a>00112   {
<a name="l00113"></a>00113     <span class="comment">// put the initial Timestamp to the list</span>
<a name="l00114"></a>00114     <a class="code" href="a00113.html#65205e0c07b6e08e7fa236ebf4f052e4" title="Data structure to track when the Radio is receiving.">radioIsReceiving</a>.push_back(<a class="code" href="a00114.html" title="data structure for the list elements, consists basically of a pair of a simtime_t...">ListEntry</a>(initTime, initValue));
<a name="l00115"></a>00115   }
<a name="l00116"></a>00116 
<a name="l00117"></a><a class="code" href="a00113.html#c076409f51f9df8493e3cccf03428445">00117</a>   <span class="keyword">virtual</span> <a class="code" href="a00113.html#c076409f51f9df8493e3cccf03428445">~RadioStateAnalogueModel</a>() {}
<a name="l00118"></a>00118 
<a name="l00127"></a>00127   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="a00113.html#5deb97ebb47b1e2e26f45cd8d3f5e916" title="Filters the Signal according to the RadioState (passively), i.e. adding an appropriate...">filterSignal</a>(<a class="code" href="a00124.html" title="The signal class stores the physical representation of the signal of an AirFrame...">Signal</a>&amp; s);
<a name="l00128"></a>00128 
<a name="l00132"></a><a class="code" href="a00113.html#9a3457871c28e3e86759f70a9def9f28">00132</a>   <span class="keywordtype">void</span> <a class="code" href="a00113.html#9a3457871c28e3e86759f70a9def9f28" title="sets tracking mode">setTrackingModeTo</a>(<span class="keywordtype">bool</span> b)
<a name="l00133"></a>00133   {
<a name="l00134"></a>00134     <a class="code" href="a00113.html#576c1bc7398c256153ac9e22bbc84f61" title="Indicator variable whether we are currently tracking changes.">currentlyTracking</a> = b;
<a name="l00135"></a>00135   }
<a name="l00136"></a>00136 
<a name="l00147"></a><a class="code" href="a00113.html#45c41f132d4f928e74ebd011668e1f17">00147</a>   <span class="keywordtype">void</span> <a class="code" href="a00113.html#45c41f132d4f928e74ebd011668e1f17" title="Cleans up all stored information strictly before the given time-point, i.e. all elements...">cleanUpUntil</a>(simtime_t t)
<a name="l00148"></a>00148   {
<a name="l00149"></a>00149     <span class="comment">// assert that list is not empty</span>
<a name="l00150"></a>00150     assert(!<a class="code" href="a00113.html#65205e0c07b6e08e7fa236ebf4f052e4" title="Data structure to track when the Radio is receiving.">radioIsReceiving</a>.empty());
<a name="l00151"></a>00151 
<a name="l00152"></a>00152     <span class="comment">/* the list contains at least one element */</span>
<a name="l00153"></a>00153 
<a name="l00154"></a>00154     <span class="comment">// CASE: t is smaller or equal the timepoint of the first element ==&gt; nothing to do, return</span>
<a name="l00155"></a>00155     <span class="keywordflow">if</span> ( t &lt;= <a class="code" href="a00113.html#65205e0c07b6e08e7fa236ebf4f052e4" title="Data structure to track when the Radio is receiving.">radioIsReceiving</a>.front().getTime() )
<a name="l00156"></a>00156     {
<a name="l00157"></a>00157       <span class="keywordflow">return</span>;
<a name="l00158"></a>00158     }
<a name="l00159"></a>00159 
<a name="l00160"></a>00160 
<a name="l00161"></a>00161     <span class="comment">// CASE: t is greater than the timepoint of the last element</span>
<a name="l00162"></a>00162     <span class="comment">// ==&gt; clear complete list except the last element, return</span>
<a name="l00163"></a>00163     <span class="keywordflow">if</span> ( t &gt; <a class="code" href="a00113.html#65205e0c07b6e08e7fa236ebf4f052e4" title="Data structure to track when the Radio is receiving.">radioIsReceiving</a>.back().getTime() )
<a name="l00164"></a>00164     {
<a name="l00165"></a>00165       <a class="code" href="a00114.html" title="data structure for the list elements, consists basically of a pair of a simtime_t...">ListEntry</a> lastEntry = <a class="code" href="a00113.html#65205e0c07b6e08e7fa236ebf4f052e4" title="Data structure to track when the Radio is receiving.">radioIsReceiving</a>.back();
<a name="l00166"></a>00166       <a class="code" href="a00113.html#65205e0c07b6e08e7fa236ebf4f052e4" title="Data structure to track when the Radio is receiving.">radioIsReceiving</a>.clear();
<a name="l00167"></a>00167       <a class="code" href="a00113.html#65205e0c07b6e08e7fa236ebf4f052e4" title="Data structure to track when the Radio is receiving.">radioIsReceiving</a>.push_back(lastEntry);
<a name="l00168"></a>00168       <span class="keywordflow">return</span>;
<a name="l00169"></a>00169     }
<a name="l00170"></a>00170 
<a name="l00171"></a>00171     <span class="comment">/*</span>
<a name="l00172"></a>00172 <span class="comment">     * preconditions from now on:</span>
<a name="l00173"></a>00173 <span class="comment">     * 1. list contains at least two elements, since 2. + 3.</span>
<a name="l00174"></a>00174 <span class="comment">     * 2. t &gt; first_timepoint</span>
<a name="l00175"></a>00175 <span class="comment">     * 3. t &lt;= last_timepoint</span>
<a name="l00176"></a>00176 <span class="comment">     */</span>
<a name="l00177"></a>00177 
<a name="l00178"></a>00178     <span class="comment">// get an iterator and set it to the first timepoint &gt;= t</span>
<a name="l00179"></a>00179     std::list&lt;ListEntry&gt;::iterator it;
<a name="l00180"></a>00180     it = lower_bound(<a class="code" href="a00113.html#65205e0c07b6e08e7fa236ebf4f052e4" title="Data structure to track when the Radio is receiving.">radioIsReceiving</a>.begin(), <a class="code" href="a00113.html#65205e0c07b6e08e7fa236ebf4f052e4" title="Data structure to track when the Radio is receiving.">radioIsReceiving</a>.end(), t);
<a name="l00181"></a>00181 
<a name="l00182"></a>00182 
<a name="l00183"></a>00183     <span class="comment">// CASE: list contains an element with exactly the given key</span>
<a name="l00184"></a>00184     <span class="keywordflow">if</span> ( it-&gt;getTime() == t )
<a name="l00185"></a>00185     {
<a name="l00186"></a>00186       <a class="code" href="a00113.html#65205e0c07b6e08e7fa236ebf4f052e4" title="Data structure to track when the Radio is receiving.">radioIsReceiving</a>.erase(<a class="code" href="a00113.html#65205e0c07b6e08e7fa236ebf4f052e4" title="Data structure to track when the Radio is receiving.">radioIsReceiving</a>.begin(), it);
<a name="l00187"></a>00187       <span class="keywordflow">return</span>;
<a name="l00188"></a>00188     }
<a name="l00189"></a>00189 
<a name="l00190"></a>00190     <span class="comment">// CASE: t is "in between two elements"</span>
<a name="l00191"></a>00191     <span class="comment">// ==&gt; set the iterators predecessors time to t, it becomes the first element</span>
<a name="l00192"></a>00192     it--; <span class="comment">// go back one element, possible since this one has not been the first one</span>
<a name="l00193"></a>00193 
<a name="l00194"></a>00194     it-&gt;setTime(t); <span class="comment">// set this elements time to t</span>
<a name="l00195"></a>00195     <a class="code" href="a00113.html#65205e0c07b6e08e7fa236ebf4f052e4" title="Data structure to track when the Radio is receiving.">radioIsReceiving</a>.erase(<a class="code" href="a00113.html#65205e0c07b6e08e7fa236ebf4f052e4" title="Data structure to track when the Radio is receiving.">radioIsReceiving</a>.begin(), it); <span class="comment">// and erase all previous elements</span>
<a name="l00196"></a>00196 
<a name="l00197"></a>00197   }
<a name="l00198"></a>00198 
<a name="l00204"></a><a class="code" href="a00113.html#ce9a38fbb5e55ee098fc6604e826788d">00204</a>   <span class="keywordtype">void</span> <a class="code" href="a00113.html#ce9a38fbb5e55ee098fc6604e826788d" title="Stores an entry of the form &amp;quot;time-point/attenuation (from now on)&amp;quot;.">writeRecvEntry</a>(simtime_t time, <span class="keywordtype">double</span> value)
<a name="l00205"></a>00205   {
<a name="l00206"></a>00206     <span class="comment">// bugfixed on 08.04.2008</span>
<a name="l00207"></a>00207     assert( (<a class="code" href="a00113.html#65205e0c07b6e08e7fa236ebf4f052e4" title="Data structure to track when the Radio is receiving.">radioIsReceiving</a>.empty()) || (time &gt;= <a class="code" href="a00113.html#65205e0c07b6e08e7fa236ebf4f052e4" title="Data structure to track when the Radio is receiving.">radioIsReceiving</a>.back().getTime()) );
<a name="l00208"></a>00208 
<a name="l00209"></a>00209     <span class="keywordflow">if</span> (<a class="code" href="a00113.html#576c1bc7398c256153ac9e22bbc84f61" title="Indicator variable whether we are currently tracking changes.">currentlyTracking</a>)
<a name="l00210"></a>00210     {
<a name="l00211"></a>00211       <a class="code" href="a00113.html#65205e0c07b6e08e7fa236ebf4f052e4" title="Data structure to track when the Radio is receiving.">radioIsReceiving</a>.push_back(<a class="code" href="a00114.html" title="data structure for the list elements, consists basically of a pair of a simtime_t...">ListEntry</a>(time, value));
<a name="l00212"></a>00212     }
<a name="l00213"></a>00213   }
<a name="l00214"></a>00214 
<a name="l00215"></a>00215 
<a name="l00216"></a>00216 
<a name="l00217"></a>00217 
<a name="l00218"></a>00218 }; <span class="comment">// end class RadioStateAnalogueModel</span>
<a name="l00219"></a>00219 
<a name="l00220"></a>00220 
<a name="l00221"></a>00221 
<a name="l00222"></a>00222 
<a name="l00235"></a><a class="code" href="a00112.html">00235</a> <span class="keyword">class </span><a class="code" href="a00112.html" title="The class that represents the Radio as a state machine.">Radio</a>
<a name="l00236"></a>00236 {
<a name="l00237"></a>00237 <span class="keyword">public</span>:
<a name="l00243"></a><a class="code" href="a00112.html#7314de88eaecfa054e682ccc84ef0ffa">00243</a>   <span class="keyword">enum</span> <a class="code" href="a00112.html#7314de88eaecfa054e682ccc84ef0ffa" title="The state of the radio of the nic.">RadioState</a> {
<a name="l00244"></a>00244     <span class="comment">/* receiving state*/</span>
<a name="l00245"></a><a class="code" href="a00112.html#7314de88eaecfa054e682ccc84ef0ffa0a9f9ba2fd83cf0f5f4eaf4f32d6a9c1">00245</a>     <a class="code" href="a00112.html#7314de88eaecfa054e682ccc84ef0ffa0a9f9ba2fd83cf0f5f4eaf4f32d6a9c1">RX</a> = 0,
<a name="l00246"></a>00246     <span class="comment">/* transmiting state*/</span>
<a name="l00247"></a><a class="code" href="a00112.html#7314de88eaecfa054e682ccc84ef0ffa55eab2480eb0876c6b76dc0df92882f7">00247</a>     <a class="code" href="a00112.html#7314de88eaecfa054e682ccc84ef0ffa55eab2480eb0876c6b76dc0df92882f7">TX</a>,
<a name="l00248"></a>00248     <span class="comment">/* sleeping*/</span>
<a name="l00249"></a><a class="code" href="a00112.html#7314de88eaecfa054e682ccc84ef0ffac023b5b1d5d9ddbbff72007fb46449a7">00249</a>     <a class="code" href="a00112.html#7314de88eaecfa054e682ccc84ef0ffac023b5b1d5d9ddbbff72007fb46449a7">SLEEP</a>,
<a name="l00250"></a>00250     <span class="comment">/* switching between two states*/</span>
<a name="l00251"></a><a class="code" href="a00112.html#7314de88eaecfa054e682ccc84ef0ffa6519b535977bcb0a1a70ec6259c1cb61">00251</a>     <a class="code" href="a00112.html#7314de88eaecfa054e682ccc84ef0ffa6519b535977bcb0a1a70ec6259c1cb61">SWITCHING</a>,
<a name="l00252"></a>00252 
<a name="l00253"></a>00253     <span class="comment">/* New entries from here... */</span>
<a name="l00254"></a>00254 
<a name="l00255"></a>00255     <span class="comment">/* ... to here. */</span>
<a name="l00256"></a>00256 
<a name="l00257"></a>00257     <span class="comment">/*</span>
<a name="l00258"></a>00258 <span class="comment">     * NOTE: THIS IS NO REAL RADIOSTATE, JUST A COUNTER FOR THE NUMBER OF RADIOSTATES</span>
<a name="l00259"></a>00259 <span class="comment">     * IT ALWAYS NEEDS TO BE THE LAST ENTRY IN THIS ENUM!</span>
<a name="l00260"></a>00260 <span class="comment">     */</span>
<a name="l00261"></a><a class="code" href="a00112.html#7314de88eaecfa054e682ccc84ef0ffa8da48e8e62858b5c327db67d526d060c">00261</a>     <a class="code" href="a00112.html#7314de88eaecfa054e682ccc84ef0ffa8da48e8e62858b5c327db67d526d060c">NUM_RADIO_STATES</a>
<a name="l00262"></a>00262   };
<a name="l00263"></a>00263 
<a name="l00264"></a>00264 <span class="keyword">protected</span>:
<a name="l00265"></a>00265 
<a name="l00269"></a><a class="code" href="a00112.html#e4346f81181327cb3a20350b775d4e9a">00269</a>   <span class="keywordtype">int</span> <a class="code" href="a00112.html#e4346f81181327cb3a20350b775d4e9a">state</a>;
<a name="l00270"></a><a class="code" href="a00112.html#764847977db60861bf2f307860eb71c8">00270</a>   <span class="keywordtype">int</span> <a class="code" href="a00112.html#764847977db60861bf2f307860eb71c8">nextState</a>;
<a name="l00271"></a>00271 
<a name="l00272"></a>00272 
<a name="l00276"></a><a class="code" href="a00112.html#f5d634f5d958e278cdd14d76c3ee5227">00276</a>   <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="a00112.html#f5d634f5d958e278cdd14d76c3ee5227">numRadioStates</a>;
<a name="l00277"></a><a class="code" href="a00112.html#c1b1b9d714b4be07e364582fa5f26b69">00277</a>   simtime_t** <a class="code" href="a00112.html#c1b1b9d714b4be07e364582fa5f26b69">swTimes</a>;
<a name="l00278"></a>00278 
<a name="l00282"></a><a class="code" href="a00112.html#ce88ba24573764780744da4962f0f5a5">00282</a>   <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="a00112.html#ce88ba24573764780744da4962f0f5a5">minAtt</a>;
<a name="l00283"></a><a class="code" href="a00112.html#17c29ca1bf56277132bc4d52534aaa7a">00283</a>   <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="a00112.html#17c29ca1bf56277132bc4d52534aaa7a">maxAtt</a>;
<a name="l00284"></a>00284 
<a name="l00289"></a><a class="code" href="a00112.html#409b73b9be7b5bafc746406a3c6e3081">00289</a>   <a class="code" href="a00113.html" title="This special AnalogueModel provides filtering of a Signal according to the actual...">RadioStateAnalogueModel</a> <a class="code" href="a00112.html#409b73b9be7b5bafc746406a3c6e3081">rsam</a>;
<a name="l00290"></a>00290 
<a name="l00291"></a>00291 <span class="keyword">public</span>:
<a name="l00292"></a>00292 
<a name="l00296"></a><a class="code" href="a00112.html#6f3d949a5e09c5d38887273e982c734f">00296</a>   <a class="code" href="a00112.html#6f3d949a5e09c5d38887273e982c734f" title="Default constructor for instances of class Radio.">Radio</a>(<span class="keywordtype">int</span> initialState = <a class="code" href="a00112.html#7314de88eaecfa054e682ccc84ef0ffa0a9f9ba2fd83cf0f5f4eaf4f32d6a9c1">RX</a>, <span class="keywordtype">double</span> <a class="code" href="a00112.html#ce88ba24573764780744da4962f0f5a5">minAtt</a> = 1.0, <span class="keywordtype">double</span> <a class="code" href="a00112.html#17c29ca1bf56277132bc4d52534aaa7a">maxAtt</a> = 0.0)
<a name="l00297"></a>00297     : <a class="code" href="a00112.html#e4346f81181327cb3a20350b775d4e9a">state</a>(initialState), <a class="code" href="a00112.html#764847977db60861bf2f307860eb71c8">nextState</a>(initialState), <a class="code" href="a00112.html#f5d634f5d958e278cdd14d76c3ee5227">numRadioStates</a>(<a class="code" href="a00112.html#7314de88eaecfa054e682ccc84ef0ffa8da48e8e62858b5c327db67d526d060c">NUM_RADIO_STATES</a>),
<a name="l00298"></a>00298     <a class="code" href="a00112.html#ce88ba24573764780744da4962f0f5a5">minAtt</a>(<a class="code" href="a00112.html#ce88ba24573764780744da4962f0f5a5">minAtt</a>), <a class="code" href="a00112.html#17c29ca1bf56277132bc4d52534aaa7a">maxAtt</a>(<a class="code" href="a00112.html#17c29ca1bf56277132bc4d52534aaa7a">maxAtt</a>), <a class="code" href="a00112.html#409b73b9be7b5bafc746406a3c6e3081">rsam</a>(<a class="code" href="a00112.html#8dff66d0cee3ac3618bf70292ba60af0" title="maps RadioState to attenuation, the Radios receiving characteristic">mapStateToAtt</a>(initialState))
<a name="l00299"></a>00299   {
<a name="l00300"></a>00300     <span class="comment">// allocate memory for one dimension</span>
<a name="l00301"></a>00301     <a class="code" href="a00112.html#c1b1b9d714b4be07e364582fa5f26b69">swTimes</a> = <span class="keyword">new</span> simtime_t* [<a class="code" href="a00112.html#f5d634f5d958e278cdd14d76c3ee5227">numRadioStates</a>];
<a name="l00302"></a>00302 
<a name="l00303"></a>00303     <span class="comment">// go through the first dimension and</span>
<a name="l00304"></a>00304     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="a00112.html#f5d634f5d958e278cdd14d76c3ee5227">numRadioStates</a>; i++)
<a name="l00305"></a>00305     {
<a name="l00306"></a>00306       <span class="comment">// allocate memory for the second dimension</span>
<a name="l00307"></a>00307       <a class="code" href="a00112.html#c1b1b9d714b4be07e364582fa5f26b69">swTimes</a>[i] = <span class="keyword">new</span> simtime_t[numRadioStates];
<a name="l00308"></a>00308     }
<a name="l00309"></a>00309 
<a name="l00310"></a>00310     <span class="comment">// initialize all matrix entries to 0.0</span>
<a name="l00311"></a>00311     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; numRadioStates; i++)
<a name="l00312"></a>00312     {
<a name="l00313"></a>00313       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; numRadioStates; j++)
<a name="l00314"></a>00314       {
<a name="l00315"></a>00315         <a class="code" href="a00112.html#c1b1b9d714b4be07e364582fa5f26b69">swTimes</a>[i][j] = 0;
<a name="l00316"></a>00316       }
<a name="l00317"></a>00317     }
<a name="l00318"></a>00318 
<a name="l00319"></a>00319 
<a name="l00320"></a>00320   }
<a name="l00321"></a>00321 
<a name="l00325"></a><a class="code" href="a00112.html#29debcd5a10f48aaa1df6cf28da79873">00325</a>   <span class="keyword">virtual</span> <a class="code" href="a00112.html#29debcd5a10f48aaa1df6cf28da79873" title="Destructor for the Radio class.">~Radio</a>()
<a name="l00326"></a>00326   {
<a name="l00327"></a>00327     <span class="comment">// delete all allocated memory for the switching times matrix</span>
<a name="l00328"></a>00328     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="a00112.html#f5d634f5d958e278cdd14d76c3ee5227">numRadioStates</a>; i++)
<a name="l00329"></a>00329     {
<a name="l00330"></a>00330       <span class="keyword">delete</span>[] <a class="code" href="a00112.html#c1b1b9d714b4be07e364582fa5f26b69">swTimes</a>[i];
<a name="l00331"></a>00331     }
<a name="l00332"></a>00332 
<a name="l00333"></a>00333     <span class="keyword">delete</span>[] <a class="code" href="a00112.html#c1b1b9d714b4be07e364582fa5f26b69">swTimes</a>;
<a name="l00334"></a>00334     <a class="code" href="a00112.html#c1b1b9d714b4be07e364582fa5f26b69">swTimes</a> = 0;
<a name="l00335"></a>00335 
<a name="l00336"></a>00336   }
<a name="l00337"></a>00337 
<a name="l00349"></a><a class="code" href="a00112.html#615c12ca30bd915fd030c5fa1a81d0c8">00349</a>   simtime_t <a class="code" href="a00112.html#615c12ca30bd915fd030c5fa1a81d0c8" title="A function called by the Physical Layer to start the switching process to a new RadioState...">switchTo</a>(<span class="keywordtype">int</span> newState, simtime_t now)
<a name="l00350"></a>00350   {
<a name="l00351"></a>00351     <span class="comment">// state to switch to must be in a valid range, i.e. 0 &lt;= newState &lt; numRadioStates</span>
<a name="l00352"></a>00352     assert(0 &lt;= newState &amp;&amp; newState &lt; <a class="code" href="a00112.html#f5d634f5d958e278cdd14d76c3ee5227">numRadioStates</a>);
<a name="l00353"></a>00353 
<a name="l00354"></a>00354     <span class="comment">// state to switch to must not be SWITCHING</span>
<a name="l00355"></a>00355     assert(newState != <a class="code" href="a00112.html#7314de88eaecfa054e682ccc84ef0ffa6519b535977bcb0a1a70ec6259c1cb61">SWITCHING</a>);
<a name="l00356"></a>00356 
<a name="l00357"></a>00357 
<a name="l00358"></a>00358     <span class="comment">// return error value if newState is the same as the current state</span>
<a name="l00359"></a>00359     <span class="comment">// if (newState == state) return -1;</span>
<a name="l00360"></a>00360 
<a name="l00361"></a>00361     <span class="comment">// return error value if Radio is currently switching</span>
<a name="l00362"></a>00362     <span class="keywordflow">if</span> (<a class="code" href="a00112.html#e4346f81181327cb3a20350b775d4e9a">state</a> == <a class="code" href="a00112.html#7314de88eaecfa054e682ccc84ef0ffa6519b535977bcb0a1a70ec6259c1cb61">SWITCHING</a>) <span class="keywordflow">return</span> -1;
<a name="l00363"></a>00363 
<a name="l00364"></a>00364 
<a name="l00365"></a>00365     <span class="comment">/* REGULAR CASE */</span>
<a name="l00366"></a>00366 
<a name="l00367"></a>00367 
<a name="l00368"></a>00368     <span class="comment">// set the nextState to the newState and the current state to SWITCHING</span>
<a name="l00369"></a>00369     <a class="code" href="a00112.html#764847977db60861bf2f307860eb71c8">nextState</a> = newState;
<a name="l00370"></a>00370     <span class="keywordtype">int</span> lastState = <a class="code" href="a00112.html#e4346f81181327cb3a20350b775d4e9a">state</a>;
<a name="l00371"></a>00371     <a class="code" href="a00112.html#e4346f81181327cb3a20350b775d4e9a">state</a> = <a class="code" href="a00112.html#7314de88eaecfa054e682ccc84ef0ffa6519b535977bcb0a1a70ec6259c1cb61">SWITCHING</a>;
<a name="l00372"></a>00372 
<a name="l00373"></a>00373     <span class="comment">// make entry to RSAM</span>
<a name="l00374"></a>00374     <a class="code" href="a00112.html#7998737bfb657f69ddb9c199499d4f1e" title="responsible for making entries to the RSAM">makeRSAMEntry</a>(now, <a class="code" href="a00112.html#e4346f81181327cb3a20350b775d4e9a">state</a>);
<a name="l00375"></a>00375 
<a name="l00376"></a>00376     <span class="comment">// return matching entry from the switch times matrix</span>
<a name="l00377"></a>00377     <span class="keywordflow">return</span> <a class="code" href="a00112.html#c1b1b9d714b4be07e364582fa5f26b69">swTimes</a>[lastState][<a class="code" href="a00112.html#764847977db60861bf2f307860eb71c8">nextState</a>];
<a name="l00378"></a>00378   }
<a name="l00379"></a>00379 
<a name="l00385"></a><a class="code" href="a00112.html#fcf12d0322d579b330a5a28d32ab8c5b">00385</a>   <span class="keywordtype">void</span> <a class="code" href="a00112.html#fcf12d0322d579b330a5a28d32ab8c5b" title="function called by PhyLayer in order to make an entry in the switch times matrix...">setSwitchTime</a>(<span class="keywordtype">int</span> from, <span class="keywordtype">int</span> to, simtime_t time)
<a name="l00386"></a>00386   {
<a name="l00387"></a>00387     <span class="comment">// assert parameters are in valid range</span>
<a name="l00388"></a>00388     assert(time &gt;= 0.0);
<a name="l00389"></a>00389     assert(0 &lt;= from &amp;&amp; from &lt; <a class="code" href="a00112.html#f5d634f5d958e278cdd14d76c3ee5227">numRadioStates</a>);
<a name="l00390"></a>00390     assert(0 &lt;= to &amp;&amp; to &lt; <a class="code" href="a00112.html#f5d634f5d958e278cdd14d76c3ee5227">numRadioStates</a>);
<a name="l00391"></a>00391 
<a name="l00392"></a>00392     <span class="comment">// it shall not be possible to set times to/from SWITCHING</span>
<a name="l00393"></a>00393     assert(from != <a class="code" href="a00112.html#7314de88eaecfa054e682ccc84ef0ffa6519b535977bcb0a1a70ec6259c1cb61">SWITCHING</a> &amp;&amp; to != <a class="code" href="a00112.html#7314de88eaecfa054e682ccc84ef0ffa6519b535977bcb0a1a70ec6259c1cb61">SWITCHING</a>);
<a name="l00394"></a>00394 
<a name="l00395"></a>00395 
<a name="l00396"></a>00396     <a class="code" href="a00112.html#c1b1b9d714b4be07e364582fa5f26b69">swTimes</a>[from][to] = time;
<a name="l00397"></a>00397     <span class="keywordflow">return</span>;
<a name="l00398"></a>00398   }
<a name="l00399"></a>00399 
<a name="l00404"></a><a class="code" href="a00112.html#1c9dcb8d49198c04d9001732e8c4421e">00404</a>   <span class="keywordtype">int</span> <a class="code" href="a00112.html#1c9dcb8d49198c04d9001732e8c4421e">getCurrentState</a>()<span class="keyword"> const</span>
<a name="l00405"></a>00405 <span class="keyword">  </span>{
<a name="l00406"></a>00406 
<a name="l00407"></a>00407     <span class="keywordflow">return</span> <a class="code" href="a00112.html#e4346f81181327cb3a20350b775d4e9a">state</a>;
<a name="l00408"></a>00408   }
<a name="l00409"></a>00409 
<a name="l00410"></a>00410 
<a name="l00411"></a>00411 
<a name="l00422"></a><a class="code" href="a00112.html#c37d427d9200c9ee5cde23e2b469f5f3">00422</a>   <span class="keywordtype">void</span> <a class="code" href="a00112.html#c37d427d9200c9ee5cde23e2b469f5f3" title="called by PhyLayer when duration-time for the current switching process is up">endSwitch</a>(simtime_t now)
<a name="l00423"></a>00423   {
<a name="l00424"></a>00424     <span class="comment">// make sure we are currently switching</span>
<a name="l00425"></a>00425     assert(<a class="code" href="a00112.html#e4346f81181327cb3a20350b775d4e9a">state</a> == <a class="code" href="a00112.html#7314de88eaecfa054e682ccc84ef0ffa6519b535977bcb0a1a70ec6259c1cb61">SWITCHING</a>);
<a name="l00426"></a>00426 
<a name="l00427"></a>00427     <span class="comment">// set the current state finally to the next state</span>
<a name="l00428"></a>00428     <a class="code" href="a00112.html#e4346f81181327cb3a20350b775d4e9a">state</a> = <a class="code" href="a00112.html#764847977db60861bf2f307860eb71c8">nextState</a>;
<a name="l00429"></a>00429 
<a name="l00430"></a>00430     <span class="comment">// make entry to RSAM</span>
<a name="l00431"></a>00431     <a class="code" href="a00112.html#7998737bfb657f69ddb9c199499d4f1e" title="responsible for making entries to the RSAM">makeRSAMEntry</a>(now, <a class="code" href="a00112.html#e4346f81181327cb3a20350b775d4e9a">state</a>);
<a name="l00432"></a>00432 
<a name="l00433"></a>00433     <span class="keywordflow">return</span>;
<a name="l00434"></a>00434   }
<a name="l00435"></a>00435 
<a name="l00442"></a><a class="code" href="a00112.html#4903c7a92d2d890c04b27bbdf133cf92">00442</a>   <a class="code" href="a00113.html" title="This special AnalogueModel provides filtering of a Signal according to the actual...">RadioStateAnalogueModel</a>* <a class="code" href="a00112.html#4903c7a92d2d890c04b27bbdf133cf92" title="Returns a pointer to the RadioStateAnalogueModel.">getAnalogueModel</a>()
<a name="l00443"></a>00443   {
<a name="l00444"></a>00444     <span class="keywordflow">return</span> (&amp;<a class="code" href="a00112.html#409b73b9be7b5bafc746406a3c6e3081">rsam</a>);
<a name="l00445"></a>00445   }
<a name="l00446"></a>00446 
<a name="l00451"></a><a class="code" href="a00112.html#629c6360c5ae7608c37c5c46eae04f2c">00451</a>   <span class="keywordtype">void</span> <a class="code" href="a00112.html#629c6360c5ae7608c37c5c46eae04f2c" title="discards information in the RadioStateAnalogueModel before given time-point">cleanAnalogueModelUntil</a>(simtime_t t)
<a name="l00452"></a>00452   {
<a name="l00453"></a>00453     <a class="code" href="a00112.html#409b73b9be7b5bafc746406a3c6e3081">rsam</a>.<a class="code" href="a00113.html#45c41f132d4f928e74ebd011668e1f17" title="Cleans up all stored information strictly before the given time-point, i.e. all elements...">cleanUpUntil</a>(t);
<a name="l00454"></a>00454   }
<a name="l00455"></a>00455 
<a name="l00456"></a>00456 
<a name="l00457"></a>00457 <span class="keyword">protected</span>:
<a name="l00461"></a><a class="code" href="a00112.html#7998737bfb657f69ddb9c199499d4f1e">00461</a>   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="a00112.html#7998737bfb657f69ddb9c199499d4f1e" title="responsible for making entries to the RSAM">makeRSAMEntry</a>(simtime_t time, <span class="keywordtype">int</span> <a class="code" href="a00112.html#e4346f81181327cb3a20350b775d4e9a">state</a>)
<a name="l00462"></a>00462   {
<a name="l00463"></a>00463     <a class="code" href="a00112.html#409b73b9be7b5bafc746406a3c6e3081">rsam</a>.<a class="code" href="a00113.html#ce9a38fbb5e55ee098fc6604e826788d" title="Stores an entry of the form &amp;quot;time-point/attenuation (from now on)&amp;quot;.">writeRecvEntry</a>(time, <a class="code" href="a00112.html#8dff66d0cee3ac3618bf70292ba60af0" title="maps RadioState to attenuation, the Radios receiving characteristic">mapStateToAtt</a>(state));
<a name="l00464"></a>00464   }
<a name="l00465"></a>00465 
<a name="l00470"></a><a class="code" href="a00112.html#8dff66d0cee3ac3618bf70292ba60af0">00470</a>   <span class="keyword">virtual</span> <span class="keywordtype">double</span> <a class="code" href="a00112.html#8dff66d0cee3ac3618bf70292ba60af0" title="maps RadioState to attenuation, the Radios receiving characteristic">mapStateToAtt</a>(<span class="keywordtype">int</span> <a class="code" href="a00112.html#e4346f81181327cb3a20350b775d4e9a">state</a>)
<a name="l00471"></a>00471   {
<a name="l00472"></a>00472     <span class="keywordflow">if</span> (state == <a class="code" href="a00112.html#7314de88eaecfa054e682ccc84ef0ffa0a9f9ba2fd83cf0f5f4eaf4f32d6a9c1">RX</a>)
<a name="l00473"></a>00473     {
<a name="l00474"></a>00474       <span class="keywordflow">return</span> <a class="code" href="a00112.html#ce88ba24573764780744da4962f0f5a5">minAtt</a>;
<a name="l00475"></a>00475     } <span class="keywordflow">else</span>
<a name="l00476"></a>00476     {
<a name="l00477"></a>00477       <span class="keywordflow">return</span> <a class="code" href="a00112.html#17c29ca1bf56277132bc4d52534aaa7a">maxAtt</a>;
<a name="l00478"></a>00478     }
<a name="l00479"></a>00479   }
<a name="l00480"></a>00480 
<a name="l00481"></a>00481 
<a name="l00482"></a>00482 
<a name="l00483"></a>00483 }; <span class="comment">// end class Radio</span>
<a name="l00484"></a>00484 
<a name="l00485"></a>00485 
<a name="l00486"></a>00486 
<a name="l00492"></a><a class="code" href="a00121.html">00492</a> <span class="keyword">class </span><a class="code" href="a00121.html" title="ConstMapingIterator implementation for a RSAM.">RSAMConstMappingIterator</a> : <span class="keyword">public</span> <a class="code" href="a00046.html" title="Defines an const iterator for a ConstMapping which is able to iterate over the Mapping...">ConstMappingIterator</a>
<a name="l00493"></a>00493 {
<a name="l00494"></a>00494 <span class="keyword">protected</span>:
<a name="l00495"></a>00495 
<a name="l00496"></a><a class="code" href="a00121.html#ad2e47c90690500114b0715ac93fdea0">00496</a>   <span class="keyword">const</span> <a class="code" href="a00113.html" title="This special AnalogueModel provides filtering of a Signal according to the actual...">RadioStateAnalogueModel</a>* <a class="code" href="a00121.html#ad2e47c90690500114b0715ac93fdea0">rsam</a>;
<a name="l00497"></a>00497 
<a name="l00498"></a><a class="code" href="a00121.html#b27af19743434c8f938fa12240ce2b76">00498</a>   <span class="keyword">typedef</span> std::list&lt;RadioStateAnalogueModel::ListEntry&gt; <a class="code" href="a00121.html#b27af19743434c8f938fa12240ce2b76">CurrList</a>;
<a name="l00499"></a><a class="code" href="a00121.html#611fd29b7a53da28738c0871132fcc5f">00499</a>   CurrList::const_iterator <a class="code" href="a00121.html#611fd29b7a53da28738c0871132fcc5f">it</a>;
<a name="l00500"></a>00500 
<a name="l00501"></a><a class="code" href="a00121.html#9039bc33a7d35f7fefa980d1bc48ad5f">00501</a>   <a class="code" href="a00003.html" title="Defines an argument for a mapping.">Argument</a> <a class="code" href="a00121.html#9039bc33a7d35f7fefa980d1bc48ad5f">position</a>;
<a name="l00502"></a><a class="code" href="a00121.html#926d1e5571f715a515233de3f245dea2">00502</a>   <a class="code" href="a00003.html" title="Defines an argument for a mapping.">Argument</a> <a class="code" href="a00121.html#926d1e5571f715a515233de3f245dea2">nextPosition</a>;
<a name="l00503"></a>00503 
<a name="l00504"></a><a class="code" href="a00121.html#44e62faddab1436a85e70e80d00080ab">00504</a>   simtime_t <a class="code" href="a00121.html#44e62faddab1436a85e70e80d00080ab">signalStart</a>;
<a name="l00505"></a><a class="code" href="a00121.html#1f51b46c71a890d8331afb993bf1cc54">00505</a>   simtime_t <a class="code" href="a00121.html#1f51b46c71a890d8331afb993bf1cc54">signalEnd</a>;
<a name="l00506"></a>00506 
<a name="l00507"></a>00507 
<a name="l00508"></a>00508 
<a name="l00509"></a>00509 <span class="keyword">public</span>:
<a name="l00510"></a>00510 
<a name="l00511"></a><a class="code" href="a00121.html#e9bfee34024c42618fdda0a089b51876">00511</a>   <a class="code" href="a00121.html#e9bfee34024c42618fdda0a089b51876">RSAMConstMappingIterator</a>(<span class="keyword">const</span> <a class="code" href="a00113.html" title="This special AnalogueModel provides filtering of a Signal according to the actual...">RadioStateAnalogueModel</a>* <a class="code" href="a00121.html#ad2e47c90690500114b0715ac93fdea0">rsam</a>,
<a name="l00512"></a>00512                 simtime_t <a class="code" href="a00121.html#44e62faddab1436a85e70e80d00080ab">signalStart</a>,
<a name="l00513"></a>00513                 simtime_t <a class="code" href="a00121.html#1f51b46c71a890d8331afb993bf1cc54">signalEnd</a>) :
<a name="l00514"></a>00514     rsam(rsam),
<a name="l00515"></a>00515     signalStart(signalStart),
<a name="l00516"></a>00516     signalEnd(signalEnd)
<a name="l00517"></a>00517   {
<a name="l00518"></a>00518     assert(rsam);
<a name="l00519"></a>00519 
<a name="l00520"></a>00520     assert( !(signalStart &lt; rsam-&gt;radioIsReceiving.front().getTime()) );
<a name="l00521"></a>00521 
<a name="l00522"></a>00522     <a class="code" href="a00121.html#3a34a4fb1e22f7e0bbac13e21d08415e" title="Lets the iterator point to the begin of the function.">jumpToBegin</a>();
<a name="l00523"></a>00523   }
<a name="l00524"></a>00524 
<a name="l00525"></a><a class="code" href="a00121.html#94df8b87b252de13463b326c7d77e3cf">00525</a>   <span class="keyword">virtual</span> <a class="code" href="a00121.html#94df8b87b252de13463b326c7d77e3cf">~RSAMConstMappingIterator</a>() {}
<a name="l00526"></a>00526 
<a name="l00533"></a><a class="code" href="a00121.html#07fd56b95f802e1c510d24b505778d80">00533</a>   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="a00121.html#07fd56b95f802e1c510d24b505778d80" title="Lets the iterator point to the passed position.">jumpTo</a>(<span class="keyword">const</span> <a class="code" href="a00003.html" title="Defines an argument for a mapping.">Argument</a>&amp; pos)
<a name="l00534"></a>00534   {
<a name="l00535"></a>00535     <span class="comment">// extract the time-component from the argument</span>
<a name="l00536"></a>00536     simtime_t t = pos.<a class="code" href="a00003.html#dbec5c48c3c1e79057864dd50260d990" title="Returns the time value of this argument.">getTime</a>();
<a name="l00537"></a>00537 
<a name="l00538"></a>00538     assert( !(<a class="code" href="a00121.html#ad2e47c90690500114b0715ac93fdea0">rsam</a>-&gt;<a class="code" href="a00113.html#65205e0c07b6e08e7fa236ebf4f052e4" title="Data structure to track when the Radio is receiving.">radioIsReceiving</a>.empty()) &amp;&amp;
<a name="l00539"></a>00539         !(t &lt; rsam-&gt;radioIsReceiving.front().getTime()) );
<a name="l00540"></a>00540 
<a name="l00541"></a>00541     <span class="comment">// current position is already correct</span>
<a name="l00542"></a>00542     <span class="keywordflow">if</span>( t == <a class="code" href="a00121.html#9039bc33a7d35f7fefa980d1bc48ad5f">position</a>.<a class="code" href="a00003.html#dbec5c48c3c1e79057864dd50260d990" title="Returns the time value of this argument.">getTime</a>() )
<a name="l00543"></a>00543       <span class="keywordflow">return</span>;
<a name="l00544"></a>00544 
<a name="l00545"></a>00545     <span class="comment">// this automatically goes over all zero time switches</span>
<a name="l00546"></a>00546     <a class="code" href="a00121.html#611fd29b7a53da28738c0871132fcc5f">it</a> = upper_bound(<a class="code" href="a00121.html#ad2e47c90690500114b0715ac93fdea0">rsam</a>-&gt;<a class="code" href="a00113.html#65205e0c07b6e08e7fa236ebf4f052e4" title="Data structure to track when the Radio is receiving.">radioIsReceiving</a>.begin(), <a class="code" href="a00121.html#ad2e47c90690500114b0715ac93fdea0">rsam</a>-&gt;<a class="code" href="a00113.html#65205e0c07b6e08e7fa236ebf4f052e4" title="Data structure to track when the Radio is receiving.">radioIsReceiving</a>.end(), t);
<a name="l00547"></a>00547 
<a name="l00548"></a>00548     --<a class="code" href="a00121.html#611fd29b7a53da28738c0871132fcc5f">it</a>;
<a name="l00549"></a>00549     <a class="code" href="a00121.html#9039bc33a7d35f7fefa980d1bc48ad5f">position</a>.<a class="code" href="a00003.html#1aa26affcd0355edb44cd9711ad6fa55" title="Changes the time value of this argument.">setTime</a>(t);
<a name="l00550"></a>00550     <a class="code" href="a00121.html#4964c650666804df3be8fca3fe5a4908">setNextPosition</a>();
<a name="l00551"></a>00551   }
<a name="l00552"></a>00552 
<a name="l00563"></a><a class="code" href="a00121.html#4964c650666804df3be8fca3fe5a4908">00563</a>   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="a00121.html#4964c650666804df3be8fca3fe5a4908">setNextPosition</a>()
<a name="l00564"></a>00564   {
<a name="l00565"></a>00565     <span class="keywordflow">if</span> (<a class="code" href="a00121.html#ecbf3b4f6557ff8fd02d55519827b91e" title="Returns true if the iterator has a next value inside its range.">hasNext</a>()) <span class="comment">// iterator it does not stand on last entry and next entry is before signal end</span>
<a name="l00566"></a>00566     {
<a name="l00567"></a>00567       <span class="keywordflow">if</span>(<a class="code" href="a00121.html#9039bc33a7d35f7fefa980d1bc48ad5f">position</a>.<a class="code" href="a00003.html#dbec5c48c3c1e79057864dd50260d990" title="Returns the time value of this argument.">getTime</a>() &lt; <a class="code" href="a00121.html#44e62faddab1436a85e70e80d00080ab">signalStart</a>) <span class="comment">//signal start is our first key entry</span>
<a name="l00568"></a>00568       {
<a name="l00569"></a>00569         <a class="code" href="a00121.html#926d1e5571f715a515233de3f245dea2">nextPosition</a>.<a class="code" href="a00003.html#1aa26affcd0355edb44cd9711ad6fa55" title="Changes the time value of this argument.">setTime</a>(<a class="code" href="a00121.html#44e62faddab1436a85e70e80d00080ab">signalStart</a>);
<a name="l00570"></a>00570       } <span class="keywordflow">else</span>
<a name="l00571"></a>00571       {
<a name="l00572"></a>00572         CurrList::const_iterator it2 = <a class="code" href="a00121.html#611fd29b7a53da28738c0871132fcc5f">it</a>;
<a name="l00573"></a>00573         it2++;
<a name="l00574"></a>00574 
<a name="l00575"></a>00575         <a class="code" href="a00121.html#926d1e5571f715a515233de3f245dea2">nextPosition</a>.<a class="code" href="a00003.html#1aa26affcd0355edb44cd9711ad6fa55" title="Changes the time value of this argument.">setTime</a>(it2-&gt;getTime());
<a name="l00576"></a>00576       }
<a name="l00577"></a>00577 
<a name="l00578"></a>00578     } <span class="keywordflow">else</span> <span class="comment">// iterator it stands on last entry or next entry whould be behind signal end</span>
<a name="l00579"></a>00579     {
<a name="l00580"></a>00580       <a class="code" href="a00121.html#926d1e5571f715a515233de3f245dea2">nextPosition</a>.<a class="code" href="a00003.html#1aa26affcd0355edb44cd9711ad6fa55" title="Changes the time value of this argument.">setTime</a>(<a class="code" href="a00121.html#9039bc33a7d35f7fefa980d1bc48ad5f">position</a>.<a class="code" href="a00003.html#dbec5c48c3c1e79057864dd50260d990" title="Returns the time value of this argument.">getTime</a>() + 1);
<a name="l00581"></a>00581     }
<a name="l00582"></a>00582 
<a name="l00583"></a>00583   }
<a name="l00584"></a>00584 
<a name="l00590"></a><a class="code" href="a00121.html#3a34a4fb1e22f7e0bbac13e21d08415e">00590</a>   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="a00121.html#3a34a4fb1e22f7e0bbac13e21d08415e" title="Lets the iterator point to the begin of the function.">jumpToBegin</a>()
<a name="l00591"></a>00591   {
<a name="l00592"></a>00592     <a class="code" href="a00121.html#07fd56b95f802e1c510d24b505778d80" title="Lets the iterator point to the passed position.">jumpTo</a>(<a class="code" href="a00121.html#44e62faddab1436a85e70e80d00080ab">signalStart</a>);
<a name="l00593"></a>00593 
<a name="l00594"></a>00594     <span class="comment">/*</span>
<a name="l00595"></a>00595 <span class="comment">    it = rsam-&gt;radioIsReceiving.begin();</span>
<a name="l00596"></a>00596 <span class="comment">    simtime_t t = it-&gt;getTime();</span>
<a name="l00597"></a>00597 <span class="comment"></span>
<a name="l00598"></a>00598 <span class="comment">    assert( !(signalStart &lt; t) );</span>
<a name="l00599"></a>00599 <span class="comment"></span>
<a name="l00600"></a>00600 <span class="comment">    iterateToOverZeroSwitches(signalStart);</span>
<a name="l00601"></a>00601 <span class="comment"></span>
<a name="l00602"></a>00602 <span class="comment">    position.setTime(signalStart);</span>
<a name="l00603"></a>00603 <span class="comment">    setNextPosition();</span>
<a name="l00604"></a>00604 <span class="comment">    */</span>
<a name="l00605"></a>00605   }
<a name="l00606"></a>00606 
<a name="l00611"></a><a class="code" href="a00121.html#ffcdaea232a2f67a59750ec3817e7998">00611</a>   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="a00121.html#ffcdaea232a2f67a59750ec3817e7998" title="Iterates to the specified position. This method should be used if the new position...">iterateTo</a>(<span class="keyword">const</span> <a class="code" href="a00003.html" title="Defines an argument for a mapping.">Argument</a>&amp; pos)
<a name="l00612"></a>00612   {
<a name="l00613"></a>00613     <span class="comment">// extract the time component from the passed Argument</span>
<a name="l00614"></a>00614     simtime_t t = pos.<a class="code" href="a00003.html#dbec5c48c3c1e79057864dd50260d990" title="Returns the time value of this argument.">getTime</a>();
<a name="l00615"></a>00615 
<a name="l00616"></a>00616     <span class="comment">// ERROR CASE: iterating to a position before (time) the beginning of the mapping is forbidden</span>
<a name="l00617"></a>00617     assert( !(<a class="code" href="a00121.html#ad2e47c90690500114b0715ac93fdea0">rsam</a>-&gt;<a class="code" href="a00113.html#65205e0c07b6e08e7fa236ebf4f052e4" title="Data structure to track when the Radio is receiving.">radioIsReceiving</a>.empty()) &amp;&amp;
<a name="l00618"></a>00618         !(t &lt; rsam-&gt;radioIsReceiving.front().getTime()) );
<a name="l00619"></a>00619 
<a name="l00620"></a>00620     assert( !(t &lt; <a class="code" href="a00121.html#9039bc33a7d35f7fefa980d1bc48ad5f">position</a>.<a class="code" href="a00003.html#dbec5c48c3c1e79057864dd50260d990" title="Returns the time value of this argument.">getTime</a>()) );
<a name="l00621"></a>00621 
<a name="l00622"></a>00622     <span class="comment">// REGULAR CASES:</span>
<a name="l00623"></a>00623     <span class="comment">// t &gt;= position.getTime();</span>
<a name="l00624"></a>00624 
<a name="l00625"></a>00625     <span class="comment">// we are already exactly there</span>
<a name="l00626"></a>00626     <span class="keywordflow">if</span>( t == <a class="code" href="a00121.html#9039bc33a7d35f7fefa980d1bc48ad5f">position</a>.<a class="code" href="a00003.html#dbec5c48c3c1e79057864dd50260d990" title="Returns the time value of this argument.">getTime</a>() )
<a name="l00627"></a>00627       <span class="keywordflow">return</span>;
<a name="l00628"></a>00628 
<a name="l00629"></a>00629     <span class="comment">// we iterate there going over all zero time switches</span>
<a name="l00630"></a>00630     <a class="code" href="a00121.html#0ff28e4a2157811db38b7f4fa433fcac" title="Iterates to valid entry for timepoint t over all zero-time switches starting from...">iterateToOverZeroSwitches</a>(t);
<a name="l00631"></a>00631 
<a name="l00632"></a>00632     <span class="comment">// update current position</span>
<a name="l00633"></a>00633     <a class="code" href="a00121.html#9039bc33a7d35f7fefa980d1bc48ad5f">position</a>.<a class="code" href="a00003.html#1aa26affcd0355edb44cd9711ad6fa55" title="Changes the time value of this argument.">setTime</a>(t);
<a name="l00634"></a>00634     <a class="code" href="a00121.html#4964c650666804df3be8fca3fe5a4908">setNextPosition</a>();
<a name="l00635"></a>00635 
<a name="l00636"></a>00636   }
<a name="l00637"></a>00637 
<a name="l00638"></a>00638 
<a name="l00645"></a><a class="code" href="a00121.html#919ae04b93ed239dc2f5566a383f28d4">00645</a>   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="a00121.html#919ae04b93ed239dc2f5566a383f28d4" title="Iterates to the next position of the function.">next</a>()
<a name="l00646"></a>00646   {
<a name="l00647"></a>00647     <a class="code" href="a00121.html#ffcdaea232a2f67a59750ec3817e7998" title="Iterates to the specified position. This method should be used if the new position...">iterateTo</a>(<a class="code" href="a00121.html#926d1e5571f715a515233de3f245dea2">nextPosition</a>);
<a name="l00648"></a>00648   }
<a name="l00649"></a>00649 
<a name="l00657"></a><a class="code" href="a00121.html#3448ebfa3c53442e991978a58206d305">00657</a>   <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="a00121.html#3448ebfa3c53442e991978a58206d305" title="Returns true if the current position of the iterator is in range of the function...">inRange</a>()<span class="keyword"> const</span>
<a name="l00658"></a>00658 <span class="keyword">  </span>{
<a name="l00659"></a>00659     simtime_t t = <a class="code" href="a00121.html#9039bc33a7d35f7fefa980d1bc48ad5f">position</a>.<a class="code" href="a00003.html#dbec5c48c3c1e79057864dd50260d990" title="Returns the time value of this argument.">getTime</a>();
<a name="l00660"></a>00660     simtime_t lastEntryTime = std::max(<a class="code" href="a00121.html#ad2e47c90690500114b0715ac93fdea0">rsam</a>-&gt;<a class="code" href="a00113.html#65205e0c07b6e08e7fa236ebf4f052e4" title="Data structure to track when the Radio is receiving.">radioIsReceiving</a>.back().getTime(), <a class="code" href="a00121.html#44e62faddab1436a85e70e80d00080ab">signalStart</a>);
<a name="l00661"></a>00661 
<a name="l00662"></a>00662     <span class="keywordflow">return</span>  <a class="code" href="a00121.html#44e62faddab1436a85e70e80d00080ab">signalStart</a> &lt;= t
<a name="l00663"></a>00663         &amp;&amp; t &lt;= <a class="code" href="a00121.html#1f51b46c71a890d8331afb993bf1cc54">signalEnd</a>
<a name="l00664"></a>00664         &amp;&amp; t &lt;= lastEntryTime;
<a name="l00665"></a>00665 
<a name="l00666"></a>00666   }
<a name="l00667"></a>00667 
<a name="l00672"></a><a class="code" href="a00121.html#ecbf3b4f6557ff8fd02d55519827b91e">00672</a>   <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="a00121.html#ecbf3b4f6557ff8fd02d55519827b91e" title="Returns true if the iterator has a next value inside its range.">hasNext</a>()<span class="keyword"> const</span>
<a name="l00673"></a>00673 <span class="keyword">  </span>{
<a name="l00674"></a>00674     assert( !(<a class="code" href="a00121.html#ad2e47c90690500114b0715ac93fdea0">rsam</a>-&gt;<a class="code" href="a00113.html#65205e0c07b6e08e7fa236ebf4f052e4" title="Data structure to track when the Radio is receiving.">radioIsReceiving</a>.empty()) );
<a name="l00675"></a>00675 
<a name="l00676"></a>00676     CurrList::const_iterator it2 = <a class="code" href="a00121.html#611fd29b7a53da28738c0871132fcc5f">it</a>;
<a name="l00677"></a>00677     <span class="keywordflow">if</span> (it2 != <a class="code" href="a00121.html#ad2e47c90690500114b0715ac93fdea0">rsam</a>-&gt;<a class="code" href="a00113.html#65205e0c07b6e08e7fa236ebf4f052e4" title="Data structure to track when the Radio is receiving.">radioIsReceiving</a>.end())
<a name="l00678"></a>00678     {
<a name="l00679"></a>00679       it2++;
<a name="l00680"></a>00680     }
<a name="l00681"></a>00681 
<a name="l00682"></a>00682     <span class="keywordflow">return</span>  <a class="code" href="a00121.html#9039bc33a7d35f7fefa980d1bc48ad5f">position</a>.<a class="code" href="a00003.html#dbec5c48c3c1e79057864dd50260d990" title="Returns the time value of this argument.">getTime</a>() &lt; <a class="code" href="a00121.html#44e62faddab1436a85e70e80d00080ab">signalStart</a>
<a name="l00683"></a>00683         || (it2 != <a class="code" href="a00121.html#ad2e47c90690500114b0715ac93fdea0">rsam</a>-&gt;<a class="code" href="a00113.html#65205e0c07b6e08e7fa236ebf4f052e4" title="Data structure to track when the Radio is receiving.">radioIsReceiving</a>.end() &amp;&amp; it2-&gt;getTime() &lt;= <a class="code" href="a00121.html#1f51b46c71a890d8331afb993bf1cc54">signalEnd</a>);
<a name="l00684"></a>00684   }
<a name="l00685"></a>00685 
<a name="l00689"></a><a class="code" href="a00121.html#f465b20a9a50c6640289e7f53f26134d">00689</a>   <span class="keyword">virtual</span> <span class="keyword">const</span> <a class="code" href="a00003.html" title="Defines an argument for a mapping.">Argument</a>&amp; <a class="code" href="a00121.html#f465b20a9a50c6640289e7f53f26134d" title="Returns the current position of the iterator.">getPosition</a>()<span class="keyword"> const</span>
<a name="l00690"></a>00690 <span class="keyword">  </span>{
<a name="l00691"></a>00691     <span class="keywordflow">return</span> <a class="code" href="a00121.html#9039bc33a7d35f7fefa980d1bc48ad5f">position</a>;
<a name="l00692"></a>00692   }
<a name="l00693"></a>00693 
<a name="l00694"></a><a class="code" href="a00121.html#35441df57b5a398c15aefd4696ac9e44">00694</a>   <span class="keyword">virtual</span> <span class="keyword">const</span> <a class="code" href="a00003.html" title="Defines an argument for a mapping.">Argument</a>&amp; <a class="code" href="a00121.html#35441df57b5a398c15aefd4696ac9e44" title="Returns the position the next call to &amp;quot;next()&amp;quot; of this Iterator would iterate...">getNextPosition</a>()<span class="keyword"> const</span>
<a name="l00695"></a>00695 <span class="keyword">  </span>{
<a name="l00696"></a>00696     <span class="keywordflow">return</span> <a class="code" href="a00121.html#926d1e5571f715a515233de3f245dea2">nextPosition</a>;
<a name="l00697"></a>00697   }
<a name="l00698"></a>00698 
<a name="l00703"></a><a class="code" href="a00121.html#d538f1b607d378385fb2bf13bb1daa1b">00703</a>   <span class="keyword">virtual</span> <span class="keywordtype">double</span> <a class="code" href="a00121.html#d538f1b607d378385fb2bf13bb1daa1b" title="Returns the value of the function at the current position.">getValue</a>()<span class="keyword"> const</span>
<a name="l00704"></a>00704 <span class="keyword">  </span>{
<a name="l00705"></a>00705     <span class="keywordflow">return</span> <a class="code" href="a00121.html#611fd29b7a53da28738c0871132fcc5f">it</a>-&gt;getValue();
<a name="l00706"></a>00706   }
<a name="l00707"></a>00707 
<a name="l00708"></a>00708 
<a name="l00714"></a><a class="code" href="a00121.html#0ff28e4a2157811db38b7f4fa433fcac">00714</a>   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="a00121.html#0ff28e4a2157811db38b7f4fa433fcac" title="Iterates to valid entry for timepoint t over all zero-time switches starting from...">iterateToOverZeroSwitches</a>(simtime_t t)
<a name="l00715"></a>00715   {
<a name="l00716"></a>00716     <span class="keywordflow">if</span>( <a class="code" href="a00121.html#611fd29b7a53da28738c0871132fcc5f">it</a> != <a class="code" href="a00121.html#ad2e47c90690500114b0715ac93fdea0">rsam</a>-&gt;<a class="code" href="a00113.html#65205e0c07b6e08e7fa236ebf4f052e4" title="Data structure to track when the Radio is receiving.">radioIsReceiving</a>.end() &amp;&amp; !(t &lt; <a class="code" href="a00121.html#611fd29b7a53da28738c0871132fcc5f">it</a>-&gt;getTime()) )
<a name="l00717"></a>00717     {
<a name="l00718"></a>00718       <span class="comment">// and go over (ignore) all zero-time-switches, to the next greater entry (time)</span>
<a name="l00719"></a>00719       <span class="keywordflow">while</span>( <a class="code" href="a00121.html#611fd29b7a53da28738c0871132fcc5f">it</a> != <a class="code" href="a00121.html#ad2e47c90690500114b0715ac93fdea0">rsam</a>-&gt;<a class="code" href="a00113.html#65205e0c07b6e08e7fa236ebf4f052e4" title="Data structure to track when the Radio is receiving.">radioIsReceiving</a>.end() &amp;&amp; !(t &lt; <a class="code" href="a00121.html#611fd29b7a53da28738c0871132fcc5f">it</a>-&gt;getTime()) )
<a name="l00720"></a>00720         <a class="code" href="a00121.html#611fd29b7a53da28738c0871132fcc5f">it</a>++;
<a name="l00721"></a>00721 
<a name="l00722"></a>00722       <span class="comment">// go back one step, here the iterator 'it' is placed right</span>
<a name="l00723"></a>00723       <a class="code" href="a00121.html#611fd29b7a53da28738c0871132fcc5f">it</a>--;
<a name="l00724"></a>00724     }
<a name="l00725"></a>00725   }
<a name="l00726"></a>00726 
<a name="l00727"></a>00727 }; <span class="comment">// end class RSAMConstMappingIterator</span>
<a name="l00728"></a>00728 
<a name="l00729"></a>00729 
<a name="l00746"></a><a class="code" href="a00122.html">00746</a> <span class="keyword">class </span><a class="code" href="a00122.html" title="This class represents the corresponding mapping to a RadioStateAnalogueModel (RSAM)...">RSAMMapping</a> : <span class="keyword">public</span> <a class="code" href="a00045.html" title="Represents a not changeable mapping (mathematical function) from domain with at least...">ConstMapping</a>
<a name="l00747"></a>00747 {
<a name="l00748"></a>00748 <span class="keyword">protected</span>:
<a name="l00749"></a>00749 
<a name="l00750"></a><a class="code" href="a00122.html#1e968e40c9c6d55ef033aea16dc7cc92">00750</a>   <span class="keyword">const</span> <a class="code" href="a00113.html" title="This special AnalogueModel provides filtering of a Signal according to the actual...">RadioStateAnalogueModel</a>* <a class="code" href="a00122.html#1e968e40c9c6d55ef033aea16dc7cc92">rsam</a>;
<a name="l00751"></a><a class="code" href="a00122.html#83073d619992a38be77157eeaa8de677">00751</a>   simtime_t <a class="code" href="a00122.html#83073d619992a38be77157eeaa8de677">signalStart</a>;
<a name="l00752"></a><a class="code" href="a00122.html#c4a1ed01e6319d66ada6b7bab12ce93f">00752</a>   simtime_t <a class="code" href="a00122.html#c4a1ed01e6319d66ada6b7bab12ce93f">signalEnd</a>;
<a name="l00753"></a>00753 
<a name="l00754"></a>00754 <span class="keyword">public</span>:
<a name="l00759"></a><a class="code" href="a00122.html#d8c545f30b261fea3160f7d9c6df3976">00759</a>   <a class="code" href="a00122.html#d8c545f30b261fea3160f7d9c6df3976" title="Constructor taking a pointer to the corresponding RSAM.">RSAMMapping</a>(<span class="keyword">const</span> <a class="code" href="a00113.html" title="This special AnalogueModel provides filtering of a Signal according to the actual...">RadioStateAnalogueModel</a>* <a class="code" href="a00122.html#1e968e40c9c6d55ef033aea16dc7cc92">rsam</a>,
<a name="l00760"></a>00760         simtime_t <a class="code" href="a00122.html#83073d619992a38be77157eeaa8de677">signalStart</a>,
<a name="l00761"></a>00761         simtime_t <a class="code" href="a00122.html#c4a1ed01e6319d66ada6b7bab12ce93f">signalEnd</a>) :
<a name="l00762"></a>00762     <a class="code" href="a00045.html" title="Represents a not changeable mapping (mathematical function) from domain with at least...">ConstMapping</a>(),
<a name="l00763"></a>00763     rsam(rsam),
<a name="l00764"></a>00764     signalStart(signalStart),
<a name="l00765"></a>00765     signalEnd(signalEnd)
<a name="l00766"></a>00766   {
<a name="l00767"></a>00767     assert(rsam);
<a name="l00768"></a>00768     assert( !(signalStart &lt; rsam-&gt;radioIsReceiving.front().getTime()) );
<a name="l00769"></a>00769   }
<a name="l00770"></a>00770 
<a name="l00771"></a><a class="code" href="a00122.html#91e61fbd18ee4bc68238fc13faa48c82">00771</a>   <span class="keyword">virtual</span> <a class="code" href="a00122.html#91e61fbd18ee4bc68238fc13faa48c82">~RSAMMapping</a>() {}
<a name="l00772"></a>00772 
<a name="l00782"></a><a class="code" href="a00122.html#21dc08f08a33cbd4d97a4b3790a47d10">00782</a>   <span class="keyword">virtual</span> <span class="keywordtype">double</span> <a class="code" href="a00122.html#21dc08f08a33cbd4d97a4b3790a47d10" title="Returns the value of this Function at position specified by the passed Argument....">getValue</a>(<span class="keyword">const</span> <a class="code" href="a00003.html" title="Defines an argument for a mapping.">Argument</a>&amp; pos)<span class="keyword"> const</span>
<a name="l00783"></a>00783 <span class="keyword">  </span>{
<a name="l00784"></a>00784     <span class="comment">// extract the time-component from the argument</span>
<a name="l00785"></a>00785     simtime_t t = pos.<a class="code" href="a00003.html#dbec5c48c3c1e79057864dd50260d990" title="Returns the time value of this argument.">getTime</a>();
<a name="l00786"></a>00786 
<a name="l00787"></a>00787     <span class="comment">// assert that t is not before the first timepoint in the RSAM</span>
<a name="l00788"></a>00788     <span class="comment">// and receiving list is not empty</span>
<a name="l00789"></a>00789     assert( !(<a class="code" href="a00122.html#1e968e40c9c6d55ef033aea16dc7cc92">rsam</a>-&gt;<a class="code" href="a00113.html#65205e0c07b6e08e7fa236ebf4f052e4" title="Data structure to track when the Radio is receiving.">radioIsReceiving</a>.empty()) &amp;&amp;
<a name="l00790"></a>00790         !(t &lt; rsam-&gt;radioIsReceiving.front().getTime()) );
<a name="l00791"></a>00791 
<a name="l00792"></a>00792     <span class="comment">/* receiving list contains at least one entry */</span>
<a name="l00793"></a>00793 
<a name="l00794"></a>00794     <span class="comment">// set an iterator to the first entry with timepoint &gt; t</span>
<a name="l00795"></a>00795     std::list&lt;RadioStateAnalogueModel::ListEntry&gt;::const_iterator it;
<a name="l00796"></a>00796     it = upper_bound(<a class="code" href="a00122.html#1e968e40c9c6d55ef033aea16dc7cc92">rsam</a>-&gt;<a class="code" href="a00113.html#65205e0c07b6e08e7fa236ebf4f052e4" title="Data structure to track when the Radio is receiving.">radioIsReceiving</a>.begin(), <a class="code" href="a00122.html#1e968e40c9c6d55ef033aea16dc7cc92">rsam</a>-&gt;<a class="code" href="a00113.html#65205e0c07b6e08e7fa236ebf4f052e4" title="Data structure to track when the Radio is receiving.">radioIsReceiving</a>.end(), t);
<a name="l00797"></a>00797 
<a name="l00798"></a>00798     <span class="comment">// REGULAR CASE: it points to an element that has a predecessor</span>
<a name="l00799"></a>00799     it--; <span class="comment">// go back one entry, this one is significant!</span>
<a name="l00800"></a>00800 
<a name="l00801"></a>00801     <span class="keywordflow">return</span> it-&gt;getValue();
<a name="l00802"></a>00802   }
<a name="l00803"></a>00803 
<a name="l00808"></a><a class="code" href="a00122.html#1037cdfec2afd5e02fe69487fbf646e6">00808</a>   <span class="keyword">virtual</span> <a class="code" href="a00046.html" title="Defines an const iterator for a ConstMapping which is able to iterate over the Mapping...">ConstMappingIterator</a>* <a class="code" href="a00122.html#1037cdfec2afd5e02fe69487fbf646e6" title="Returns a pointer of a new Iterator which is able to iterate over the function.">createConstIterator</a>()
<a name="l00809"></a>00809   {
<a name="l00810"></a>00810     <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="a00121.html" title="ConstMapingIterator implementation for a RSAM.">RSAMConstMappingIterator</a>(<a class="code" href="a00122.html#1e968e40c9c6d55ef033aea16dc7cc92">rsam</a>, <a class="code" href="a00122.html#83073d619992a38be77157eeaa8de677">signalStart</a>, <a class="code" href="a00122.html#c4a1ed01e6319d66ada6b7bab12ce93f">signalEnd</a>);
<a name="l00811"></a>00811   }
<a name="l00812"></a>00812 
<a name="l00818"></a><a class="code" href="a00122.html#143e1e64ff95e5f03ee39a51b13d0d9c">00818</a>   <span class="keyword">virtual</span> <a class="code" href="a00046.html" title="Defines an const iterator for a ConstMapping which is able to iterate over the Mapping...">ConstMappingIterator</a>* <a class="code" href="a00122.html#1037cdfec2afd5e02fe69487fbf646e6" title="Returns a pointer of a new Iterator which is able to iterate over the function.">createConstIterator</a>(<span class="keyword">const</span> <a class="code" href="a00003.html" title="Defines an argument for a mapping.">Argument</a>&amp; pos)
<a name="l00819"></a>00819   {
<a name="l00820"></a>00820     <a class="code" href="a00121.html" title="ConstMapingIterator implementation for a RSAM.">RSAMConstMappingIterator</a>* rsamCMI
<a name="l00821"></a>00821       = <span class="keyword">new</span> <a class="code" href="a00121.html" title="ConstMapingIterator implementation for a RSAM.">RSAMConstMappingIterator</a>(<a class="code" href="a00122.html#1e968e40c9c6d55ef033aea16dc7cc92">rsam</a>, <a class="code" href="a00122.html#83073d619992a38be77157eeaa8de677">signalStart</a>, <a class="code" href="a00122.html#c4a1ed01e6319d66ada6b7bab12ce93f">signalEnd</a>);
<a name="l00822"></a>00822 
<a name="l00823"></a>00823     rsamCMI-&gt;<a class="code" href="a00121.html#07fd56b95f802e1c510d24b505778d80" title="Lets the iterator point to the passed position.">jumpTo</a>(pos);
<a name="l00824"></a>00824 
<a name="l00825"></a>00825     <span class="keywordflow">return</span> rsamCMI;
<a name="l00826"></a>00826   }
<a name="l00827"></a>00827 
<a name="l00828"></a><a class="code" href="a00122.html#7b47c38b2b2c98e251db268c9fe4ce6d">00828</a>   <span class="keyword">virtual</span> <a class="code" href="a00045.html" title="Represents a not changeable mapping (mathematical function) from domain with at least...">ConstMapping</a>* <a class="code" href="a00122.html#7b47c38b2b2c98e251db268c9fe4ce6d" title="returns a deep copy of this mapping instance.">constClone</a>()<span class="keyword"> const</span>
<a name="l00829"></a>00829 <span class="keyword">  </span>{
<a name="l00830"></a>00830     <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="a00122.html#d8c545f30b261fea3160f7d9c6df3976" title="Constructor taking a pointer to the corresponding RSAM.">RSAMMapping</a>(*<span class="keyword">this</span>);
<a name="l00831"></a>00831   }
<a name="l00832"></a>00832 
<a name="l00833"></a>00833 
<a name="l00834"></a>00834 
<a name="l00835"></a>00835 }; <span class="comment">// end class RSAMMapping</span>
<a name="l00836"></a>00836 
<a name="l00837"></a>00837 
<a name="l00838"></a>00838 
<a name="l00839"></a>00839 
<a name="l00840"></a>00840 
<a name="l00841"></a>00841 <span class="preprocessor">#endif </span><span class="comment">/*PHYUTILS_H_*/</span>
</pre></div></div>
<hr size="1"><address style="text-align: right;"><small>Generated on Mon Sep 28 15:56:35 2009 for MiXiM by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.8 </small></address>
</body>
</html>
