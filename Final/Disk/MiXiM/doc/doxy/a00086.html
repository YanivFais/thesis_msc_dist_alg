<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>MiXiM: Mac80211 Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.8 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="classes.html"><span>Class&nbsp;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>Mac80211 Class Reference<br>
<small>
[<a class="el" href="a00302.html">macLayer - MAC layer modules</a>]</small>
</h1><!-- doxytag: class="Mac80211" --><!-- doxytag: inherits="BaseMacLayer" -->An implementation of the 802.11b MAC.  
<a href="#_details">More...</a>
<p>
<code>#include &lt;<a class="el" href="a00435.html">Mac80211.h</a>&gt;</code>
<p>
Inherits <a class="el" href="a00017.html">BaseMacLayer</a>.
<p>
<div class="dynheader">
Collaboration diagram for Mac80211:</div>
<div class="dynsection">
<p><center><img src="a00949.png" border="0" usemap="#a00950" alt="Collaboration graph"></center>
<map name="a00950">
<area shape="rect" href="a00017.html" title="A very simple MAC module template which provides de&#45; and encapsulation of messages..." alt="" coords="5,5,112,32"><area shape="rect" href="a00005.html" title="A class to convert integer layer addresses." alt="" coords="136,5,208,32"></map>
<center><font size="2">[<a target="top" href="graph_legend.html">legend</a>]</font></center></div>

<p>
<a href="a00951.html">List of all members.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Classes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00087.html">NeighborEntry</a></td></tr>

<tr><td colspan="2"><br><h2>Public Types</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00086.html#e423db101e8431b0cbd67c347076c44a">Mac80211MessageKinds</a> { <br>
&nbsp;&nbsp;<a class="el" href="a00086.html#e423db101e8431b0cbd67c347076c44ae37294c092b58bc2b8b13eed3743bbcb">RTS</a> =  LAST_BASE_MAC_MESSAGE_KIND, 
<a class="el" href="a00086.html#e423db101e8431b0cbd67c347076c44a41f567fa1631dfb9583b3521516896a1">CTS</a>, 
<a class="el" href="a00086.html#e423db101e8431b0cbd67c347076c44a6c9256379fe532383569665e6498c0a5">ACK</a>, 
<a class="el" href="a00086.html#e423db101e8431b0cbd67c347076c44a3e44931a7b0bf9a1f060898544c94467">DATA</a>, 
<br>
&nbsp;&nbsp;<a class="el" href="a00086.html#e423db101e8431b0cbd67c347076c44a9b73e5611a23fbbe50ae68325164a9a9">BROADCAST</a>, 
<a class="el" href="a00086.html#e423db101e8431b0cbd67c347076c44a1f3b6eea4f5d001e12e4c466903a8519">LAST_MAC_80211_MESSAGE_KIND</a>
<br>
 }</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">frame kinds  <a href="a00086.html#e423db101e8431b0cbd67c347076c44a">More...</a><br></td></tr>
<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00086.html#b81dae24d79c2ef010301e2c219966c1">initialize</a> (int)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialization of the module and some variables.  <a href="#b81dae24d79c2ef010301e2c219966c1"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00086.html#2f3c51473a890e1c3e3afb5dc1b75252">finish</a> ()</td></tr>

<tr><td colspan="2"><br><h2>Protected Types</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00086.html#381307739876ed0d015352b95bd93186">timerType</a> { <a class="el" href="a00086.html#381307739876ed0d015352b95bd93186317269d758fc1f055750d43926abbb2f">TIMEOUT</a>, 
<a class="el" href="a00086.html#381307739876ed0d015352b95bd93186d2d7f908db1dc3ed72e451dad336d654">NAV</a>
 }</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00086.html#7ff0b8b49d1a93feae6f808caf5fe447">State</a> { <br>
&nbsp;&nbsp;<a class="el" href="a00086.html#7ff0b8b49d1a93feae6f808caf5fe447be0abc1112335ff66c1eef6bd95371e4">WFDATA</a> =  0, 
<a class="el" href="a00086.html#7ff0b8b49d1a93feae6f808caf5fe4474cfe7a25808b0e110d662483abec7256">QUIET</a> =  1, 
<a class="el" href="a00086.html#7ff0b8b49d1a93feae6f808caf5fe4478904ce43407ca530f7fe83d63c558e28">IDLE</a> =  2, 
<a class="el" href="a00086.html#7ff0b8b49d1a93feae6f808caf5fe447e138f38743ca77f1300a24d4d79786fe">CONTEND</a> =  3, 
<br>
&nbsp;&nbsp;<a class="el" href="a00086.html#7ff0b8b49d1a93feae6f808caf5fe447ccc67a0993941984c4f6b49c633c2ad8">WFCTS</a> =  4, 
<a class="el" href="a00086.html#7ff0b8b49d1a93feae6f808caf5fe44750a717bfadf9a3fdd634d77950607278">WFACK</a> =  5, 
<a class="el" href="a00086.html#7ff0b8b49d1a93feae6f808caf5fe447a1070f3c837e8dc4d7890536f7cfbaf9">BUSY</a> =  6
<br>
 }</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">typedef std::list&lt; Mac80211Pkt * &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00086.html#565ab82077f95d80ec44a4a4fed08ab9">MacPktList</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">typedef std::list&lt; <a class="el" href="a00087.html">NeighborEntry</a> &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00086.html#072f068412a3577d8d11ca98c52a9c48">NeighborList</a></td></tr>

<tr><td colspan="2"><br><h2>Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00086.html#990af33f857669759da0cbeebd1c2431">handleSelfMsg</a> (cMessage *)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Handle self messages such as timer...  <a href="#990af33f857669759da0cbeebd1c2431"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00086.html#f7e230f8713536482417699f2f6bee71">handleUpperMsg</a> (cMessage *msg)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Handle messages from upper layer.  <a href="#f7e230f8713536482417699f2f6bee71"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00086.html#c8bfb04590aab2434bd8d17ee4e213d9">handleLowerMsg</a> (cMessage *)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Handle messages from lower layer.  <a href="#c8bfb04590aab2434bd8d17ee4e213d9"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00086.html#41f1a7b86f420e1f840c14badf2b0890">handleLowerControl</a> (cMessage *)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Handle messages from lower layer.  <a href="#41f1a7b86f420e1f840c14badf2b0890"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00086.html#0a87fa1791117ef1dd1841ba217e4245">handleEndContentionTimer</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Called by the Blackboard whenever a change occurs we're interested in.  <a href="#0a87fa1791117ef1dd1841ba217e4245"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00086.html#0c26c2759b2d08601ef21246e1ca6707">handleMsgNotForMe</a> (cMessage *af, simtime_t duration)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">handle a message that is not for me or errornous  <a href="#0c26c2759b2d08601ef21246e1ca6707"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00086.html#a0b767642d86d3b66f1d3258065fe5ae">handleMsgForMe</a> (Mac80211Pkt *)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">handle a message that was meant for me  <a href="#a0b767642d86d3b66f1d3258065fe5ae"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00086.html#dfcf8b7a5e1db233a1bd717cecaf49bd">handleBroadcastMsg</a> (Mac80211Pkt *)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00086.html#fe4300147d9ea5e4d3e3d8c98ff20436">handleEndTransmission</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">handle the end of a transmission...  <a href="#fe4300147d9ea5e4d3e3d8c98ff20436"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00086.html#7d36a55827a7ea91b2539c86d79349af">handleEndSifsTimer</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">handle end of SIFS  <a href="#7d36a55827a7ea91b2539c86d79349af"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00086.html#b5fcba8c7a3878ac59195a483ba35a12">handleTimeoutTimer</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">handle time out  <a href="#b5fcba8c7a3878ac59195a483ba35a12"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00086.html#23a142d65d7a0dcba4a60c0f509ab5b9">handleNavTimer</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">NAV timer expired, the exchange of messages of other stations is done.  <a href="#23a142d65d7a0dcba4a60c0f509ab5b9"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00086.html#98ad0d3935d620b33302e5230b395685">handleRTSframe</a> (Mac80211Pkt *)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00086.html#b0844f9dbcece750c9a58ca9f0a73fe1">handleDATAframe</a> (Mac80211Pkt *)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00086.html#50cb85360462eb7d256ec8a0b493ca44">handleACKframe</a> (Mac80211Pkt *)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00086.html#e1e17af7dddc261d7947d48a1f4d0e21">handleCTSframe</a> (Mac80211Pkt *)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00086.html#7a4ff22b4b999827a898794923115880">sendDATAframe</a> (Mac80211Pkt *)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">send data frame  <a href="#7a4ff22b4b999827a898794923115880"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00086.html#1c404a5176db493c2fefb71537783607">sendACKframe</a> (Mac80211Pkt *)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">send Acknoledgement  <a href="#1c404a5176db493c2fefb71537783607"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00086.html#1fd59a589e53facb68c13be84521a49e">sendCTSframe</a> (Mac80211Pkt *)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">send CTS frame  <a href="#1fd59a589e53facb68c13be84521a49e"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00086.html#3104750758ab171b20ffcfeae0079a78">sendRTSframe</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">send RTS frame  <a href="#3104750758ab171b20ffcfeae0079a78"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00086.html#26b30d048980b56d79c04e859bfce009">sendBROADCASTframe</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">send broadcast frame  <a href="#26b30d048980b56d79c04e859bfce009"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">Mac80211Pkt *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00086.html#008b57947b7d9287bb34b1e67094ebb8">encapsMsg</a> (cPacket *netw)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">encapsulate packet  <a href="#008b57947b7d9287bb34b1e67094ebb8"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">cMessage *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00086.html#3ef80a5603d99ff49bb7769a333e939a">decapsMsg</a> (Mac80211Pkt *frame)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">decapsulate packet  <a href="#3ef80a5603d99ff49bb7769a333e939a"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00086.html#b3030c86acac78401f877a61cefcdad6">beginNewCycle</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">start a new contention period  <a href="#b3030c86acac78401f877a61cefcdad6"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">simtime_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00086.html#de2c913df312fd4fc46106c1134889b8">backoff</a> (bool rtscts=true)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Compute a backoff value.  <a href="#de2c913df312fd4fc46106c1134889b8"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00086.html#72e78257babff863ca8749b2bb1a97f4">testMaxAttempts</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Test if maximum number of retries to transmit is exceeded.  <a href="#72e78257babff863ca8749b2bb1a97f4"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">simtime_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00086.html#424851e88bb229fcc3c59cfea80a9079">timeOut</a> (<a class="el" href="a00086.html#e423db101e8431b0cbd67c347076c44a">Mac80211MessageKinds</a> type, double br)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">return a timeOut value for a certain type of frame  <a href="#424851e88bb229fcc3c59cfea80a9079"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">simtime_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00086.html#6732e4a776e78432bf5dd9dd26de2f7d">packetDuration</a> (double bits, double br)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">computes the duration of a transmission over the physical channel, given a certain bitrate  <a href="#6732e4a776e78432bf5dd9dd26de2f7d"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00086.html#de8a90e665191333e610b60bad4a32a1">stateName</a> (<a class="el" href="a00086.html#7ff0b8b49d1a93feae6f808caf5fe447">State</a> <a class="el" href="a00086.html#56fa75f3eb056ae29b1a4b8da0035d8c">state</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Produce a readable name of the given state.  <a href="#de8a90e665191333e610b60bad4a32a1"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00086.html#9fc6eb078e53740d354f8ea7b9d94713">setState</a> (<a class="el" href="a00086.html#7ff0b8b49d1a93feae6f808caf5fe447">State</a> <a class="el" href="a00086.html#56fa75f3eb056ae29b1a4b8da0035d8c">state</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Sets the state, and produces a log message in between.  <a href="#9fc6eb078e53740d354f8ea7b9d94713"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00086.html#a316943080d714ffc3c0bf54ea8aeb08">rtsCts</a> (Mac80211Pkt *m)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Check whether the next packet should be send with RTS/CTS.  <a href="#a316943080d714ffc3c0bf54ea8aeb08"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00086.html#9ae0815a0e01c4d4fd13a87393f837a8">suspendContention</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">suspend an ongoing contention, pick it up again when the channel becomes idle  <a href="#9ae0815a0e01c4d4fd13a87393f837a8"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00086.html#386da37d596d50ddae0c2bb3ade102e6">retrieveBitrate</a> (int destAddress)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">figure out at which bitrate to send to this particular destination  <a href="#386da37d596d50ddae0c2bb3ade102e6"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00086.html#8dd543a1a0b89f98af6d39d28dbd9e74">addNeighbor</a> (Mac80211Pkt *af)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">add a new entry to the neighbor list  <a href="#8dd543a1a0b89f98af6d39d28dbd9e74"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">NeighborList::iterator&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00086.html#3d2c968c5117f491281ddd54f83a7ee5">findNeighbor</a> (int id)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">find a neighbor based on his address  <a href="#3d2c968c5117f491281ddd54f83a7ee5"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">NeighborList::iterator&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00086.html#967bb2466f35274cc945db0d9e044eeb">findOldestNeighbor</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">find the oldest neighbor -- usually in order to overwrite this entry  <a href="#967bb2466f35274cc945db0d9e044eeb"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00086.html#be230265b97330ce9946e4c336b4761c">senseChannelWhileIdle</a> (simtime_t duration)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Starts a channel sense request which sense the channel for the passed duration or until the channel is busy.  <a href="#be230265b97330ce9946e4c336b4761c"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="a00124.html">Signal</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00086.html#f3931f437864a565081885eba81b6019">createSignal</a> (simtime_t start, simtime_t length, double power, double <a class="el" href="a00086.html#126c9db5a54bafa6ad74eb3ee24bd936">bitrate</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Creates the signal to be used for a packet to be sent.  <a href="#f3931f437864a565081885eba81b6019"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="a00005.html">BaseArp</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00086.html#93a0c8f9b957d3d4cbf787b0db5438cd">arp</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Pointer to the arp module.  <a href="#93a0c8f9b957d3d4cbf787b0db5438cd"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00086.html#ac2e4050e1e1277556033521e3a296d5">myMacAddr</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">MAC address (obtained from arp module).  <a href="#ac2e4050e1e1277556033521e3a296d5"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">cMessage *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00086.html#2d31f97b0662b8e37f090c3b996cec82">timeout</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><a class="el" href="a00137.html">Timer</a> used for time-outs after the transmission of a RTS, a CTS, or a DATA packet.  <a href="#2d31f97b0662b8e37f090c3b996cec82"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">cMessage *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00086.html#35efb0198d0085a341aba515bec9146f">nav</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><a class="el" href="a00137.html">Timer</a> used for the defer time of a node. Also called NAV : networks allocation vector.  <a href="#35efb0198d0085a341aba515bec9146f"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">ChannelSenseRequest *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00086.html#7bd4f3adc205b150f9fa406fa582f0b6">contention</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Used to sense if the channel is idle for contention periods.  <a href="#7bd4f3adc205b150f9fa406fa582f0b6"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">ChannelSenseRequest *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00086.html#ce80836b6fcb1681f6b2d49466f87fb0">endSifs</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><a class="el" href="a00137.html">Timer</a> used to indicate the end of a SIFS.  <a href="#ce80836b6fcb1681f6b2d49466f87fb0"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">simtime_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00086.html#8104daf3041394b73fe545427cbc02d7">chSenseStart</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Stores the the time a channel sensing started. Used to calculate the quiet-time of the channel if the sensing was aborted.  <a href="#8104daf3041394b73fe545427cbc02d7"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="a00086.html#7ff0b8b49d1a93feae6f808caf5fe447">State</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00086.html#56fa75f3eb056ae29b1a4b8da0035d8c">state</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Current state of the MAC.  <a href="#56fa75f3eb056ae29b1a4b8da0035d8c"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00086.html#226566e4a56cfed2928acc87ff3af90a">defaultBitrate</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Default bitrate.  <a href="#226566e4a56cfed2928acc87ff3af90a"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00086.html#592eee2a24a6fcadd6fdf912a101719f">txPower</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The power at which data is transmitted.  <a href="#592eee2a24a6fcadd6fdf912a101719f"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00086.html#67eba657efe23f5e5c21904f4744261d">centerFreq</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Stores the center frequency the Mac uses.  <a href="#67eba657efe23f5e5c21904f4744261d"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00086.html#126c9db5a54bafa6ad74eb3ee24bd936">bitrate</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Current bit rate at which data is transmitted.  <a href="#126c9db5a54bafa6ad74eb3ee24bd936"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00086.html#4b0f6dec191e5c70ee11e380deaf2f81">catBitrate</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">and category number  <a href="#4b0f6dec191e5c70ee11e380deaf2f81"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00086.html#979883a8da4b308de4a8e79b5bbbe2e6">autoBitrate</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Auto bit rate adaptation -- switch.  <a href="#979883a8da4b308de4a8e79b5bbbe2e6"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">std::vector&lt; double &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00086.html#1cd38454a518f922ba57f68d22e2f31e">snrThresholds</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Hold RSSI thresholds at which to change the bitrates.  <a href="#1cd38454a518f922ba57f68d22e2f31e"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">unsigned&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00086.html#e8892c105c3f0fb2b6f28634bb099f31">queueLength</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Maximal number of packets in the queue; should be set in the omnetpp.ini.  <a href="#e8892c105c3f0fb2b6f28634bb099f31"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00086.html#5d8e9b53c8d6cb0116feed506d843e18">nextIsBroadcast</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Boolean used to know if the next packet is a broadcast packet.  <a href="#5d8e9b53c8d6cb0116feed506d843e18"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="a00086.html#565ab82077f95d80ec44a4a4fed08ab9">MacPktList</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00086.html#969e8e3a592dffccea28596c61b2af50">fromUpperLayer</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Buffering of messages from upper layer.  <a href="#969e8e3a592dffccea28596c61b2af50"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">unsigned&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00086.html#11fb608b3564e2d2cd41b463b1a8cc90">longRetryCounter</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Number of frame transmission attempt.  <a href="#11fb608b3564e2d2cd41b463b1a8cc90"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">unsigned&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00086.html#9bbc3d71eddb62c4e12dcd500a58b0bb">shortRetryCounter</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Number of frame transmission attempt.  <a href="#9bbc3d71eddb62c4e12dcd500a58b0bb"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">simtime_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00086.html#58484d1a6f2031548d433d18438042e9">remainingBackoff</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">remaining backoff time. If the backoff timer is interrupted, this variable holds the remaining backoff time.  <a href="#58484d1a6f2031548d433d18438042e9"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">simtime_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00086.html#4a9d1c8d45c46f18afa0f07f5b6572f4">currentIFS</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">current IFS value (DIFS or EIFS) If an error has been detected, the next backoff requires EIFS, once a valid frame has been received, resets to DIFS.  <a href="#4a9d1c8d45c46f18afa0f07f5b6572f4"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00086.html#6ad4dd93415c98c969df05f53d739cfd">rtsCtsThreshold</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Number of bits in a packet before RTS/CTS is used.  <a href="#6ad4dd93415c98c969df05f53d739cfd"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">simtime_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00086.html#b9f0ea820748af6d640569fc76f39659">delta</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Very small value used in timer scheduling in order to avoid multiple changements of state in the same simulation time.  <a href="#b9f0ea820748af6d640569fc76f39659"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">unsigned&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00086.html#e62ff2c9617e5782f6f7231e36d1574d">neighborhoodCacheSize</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Keep information for this many neighbors.  <a href="#e62ff2c9617e5782f6f7231e36d1574d"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">simtime_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00086.html#ede2e9e4e32ef871e3a59c51564123de">neighborhoodCacheMaxAge</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Consider information in cache outdate if it is older than this.  <a href="#ede2e9e4e32ef871e3a59c51564123de"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="a00086.html#072f068412a3577d8d11ca98c52a9c48">NeighborList</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00086.html#4caf1f3c2c004851555c9c691b82edf9">neighbors</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00086.html#9f9f566e85a76f63e63b5907bf9ad48a">switching</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00086.html#026837b7167d230bbe79a1e0630c7578">fsc</a></td></tr>

</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
An implementation of the 802.11b MAC. 
<p>
For more info, see the NED file.<p>
<dl class="author" compact><dt><b>Author:</b></dt><dd>David Raguin, Karl Wessel (port for MiXiM) </dd></dl>

<p>Definition at line <a class="el" href="a00435.html#l00039">39</a> of file <a class="el" href="a00435.html">Mac80211.h</a>.</p>
<hr><h2>Member Typedef Documentation</h2>
<a class="anchor" name="565ab82077f95d80ec44a4a4fed08ab9"></a><!-- doxytag: member="Mac80211::MacPktList" ref="565ab82077f95d80ec44a4a4fed08ab9" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef std::list&lt;Mac80211Pkt*&gt; <a class="el" href="a00086.html#565ab82077f95d80ec44a4a4fed08ab9">Mac80211::MacPktList</a><code> [protected]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="a00435.html#l00054">54</a> of file <a class="el" href="a00435.html">Mac80211.h</a>.</p>

</div>
</div><p>
<a class="anchor" name="072f068412a3577d8d11ca98c52a9c48"></a><!-- doxytag: member="Mac80211::NeighborList" ref="072f068412a3577d8d11ca98c52a9c48" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef std::list&lt;<a class="el" href="a00087.html">NeighborEntry</a>&gt; <a class="el" href="a00086.html#072f068412a3577d8d11ca98c52a9c48">Mac80211::NeighborList</a><code> [protected]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="a00435.html#l00082">82</a> of file <a class="el" href="a00435.html">Mac80211.h</a>.</p>

</div>
</div><p>
<hr><h2>Member Enumeration Documentation</h2>
<a class="anchor" name="e423db101e8431b0cbd67c347076c44a"></a><!-- doxytag: member="Mac80211::Mac80211MessageKinds" ref="e423db101e8431b0cbd67c347076c44a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="a00086.html#e423db101e8431b0cbd67c347076c44a">Mac80211::Mac80211MessageKinds</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
frame kinds 
<p>
<dl compact><dt><b>Enumerator: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" name="e423db101e8431b0cbd67c347076c44ae37294c092b58bc2b8b13eed3743bbcb"></a><!-- doxytag: member="RTS" ref="e423db101e8431b0cbd67c347076c44ae37294c092b58bc2b8b13eed3743bbcb" args="" -->RTS</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" name="e423db101e8431b0cbd67c347076c44a41f567fa1631dfb9583b3521516896a1"></a><!-- doxytag: member="CTS" ref="e423db101e8431b0cbd67c347076c44a41f567fa1631dfb9583b3521516896a1" args="" -->CTS</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" name="e423db101e8431b0cbd67c347076c44a6c9256379fe532383569665e6498c0a5"></a><!-- doxytag: member="ACK" ref="e423db101e8431b0cbd67c347076c44a6c9256379fe532383569665e6498c0a5" args="" -->ACK</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" name="e423db101e8431b0cbd67c347076c44a3e44931a7b0bf9a1f060898544c94467"></a><!-- doxytag: member="DATA" ref="e423db101e8431b0cbd67c347076c44a3e44931a7b0bf9a1f060898544c94467" args="" -->DATA</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" name="e423db101e8431b0cbd67c347076c44a9b73e5611a23fbbe50ae68325164a9a9"></a><!-- doxytag: member="BROADCAST" ref="e423db101e8431b0cbd67c347076c44a9b73e5611a23fbbe50ae68325164a9a9" args="" -->BROADCAST</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" name="e423db101e8431b0cbd67c347076c44a1f3b6eea4f5d001e12e4c466903a8519"></a><!-- doxytag: member="LAST_MAC_80211_MESSAGE_KIND" ref="e423db101e8431b0cbd67c347076c44a1f3b6eea4f5d001e12e4c466903a8519" args="" -->LAST_MAC_80211_MESSAGE_KIND</em>&nbsp;</td><td>
</td></tr>
</table>
</dl>

<p>Definition at line <a class="el" href="a00435.html#l00044">44</a> of file <a class="el" href="a00435.html">Mac80211.h</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00044"></a>00044                             {
<a name="l00045"></a>00045     <span class="comment">//between MAC layers of two nodes</span>
<a name="l00046"></a>00046     <a class="code" href="a00086.html#e423db101e8431b0cbd67c347076c44ae37294c092b58bc2b8b13eed3743bbcb">RTS</a> = <a class="code" href="a00017.html#8f1f4f485d6548964c1f1cbd75d1d9c70e31be8e59c319e75d7a9858ff984a2f">LAST_BASE_MAC_MESSAGE_KIND</a>, <span class="comment">// request to send</span>
<a name="l00047"></a>00047     <a class="code" href="a00086.html#e423db101e8431b0cbd67c347076c44a41f567fa1631dfb9583b3521516896a1">CTS</a>,                 <span class="comment">// clear to send</span>
<a name="l00048"></a>00048     <a class="code" href="a00086.html#e423db101e8431b0cbd67c347076c44a6c9256379fe532383569665e6498c0a5">ACK</a>,                 <span class="comment">// acknowledgement</span>
<a name="l00049"></a>00049     <a class="code" href="a00086.html#e423db101e8431b0cbd67c347076c44a3e44931a7b0bf9a1f060898544c94467">DATA</a>,
<a name="l00050"></a>00050     <a class="code" href="a00086.html#e423db101e8431b0cbd67c347076c44a9b73e5611a23fbbe50ae68325164a9a9">BROADCAST</a>,
<a name="l00051"></a>00051     <a class="code" href="a00086.html#e423db101e8431b0cbd67c347076c44a1f3b6eea4f5d001e12e4c466903a8519">LAST_MAC_80211_MESSAGE_KIND</a>
<a name="l00052"></a>00052   };
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="7ff0b8b49d1a93feae6f808caf5fe447"></a><!-- doxytag: member="Mac80211::State" ref="7ff0b8b49d1a93feae6f808caf5fe447" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="a00086.html#7ff0b8b49d1a93feae6f808caf5fe447">Mac80211::State</a><code> [protected]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Definition of the states <dl compact><dt><b>Enumerator: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" name="7ff0b8b49d1a93feae6f808caf5fe447be0abc1112335ff66c1eef6bd95371e4"></a><!-- doxytag: member="WFDATA" ref="7ff0b8b49d1a93feae6f808caf5fe447be0abc1112335ff66c1eef6bd95371e4" args="" -->WFDATA</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" name="7ff0b8b49d1a93feae6f808caf5fe4474cfe7a25808b0e110d662483abec7256"></a><!-- doxytag: member="QUIET" ref="7ff0b8b49d1a93feae6f808caf5fe4474cfe7a25808b0e110d662483abec7256" args="" -->QUIET</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" name="7ff0b8b49d1a93feae6f808caf5fe4478904ce43407ca530f7fe83d63c558e28"></a><!-- doxytag: member="IDLE" ref="7ff0b8b49d1a93feae6f808caf5fe4478904ce43407ca530f7fe83d63c558e28" args="" -->IDLE</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" name="7ff0b8b49d1a93feae6f808caf5fe447e138f38743ca77f1300a24d4d79786fe"></a><!-- doxytag: member="CONTEND" ref="7ff0b8b49d1a93feae6f808caf5fe447e138f38743ca77f1300a24d4d79786fe" args="" -->CONTEND</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" name="7ff0b8b49d1a93feae6f808caf5fe447ccc67a0993941984c4f6b49c633c2ad8"></a><!-- doxytag: member="WFCTS" ref="7ff0b8b49d1a93feae6f808caf5fe447ccc67a0993941984c4f6b49c633c2ad8" args="" -->WFCTS</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" name="7ff0b8b49d1a93feae6f808caf5fe44750a717bfadf9a3fdd634d77950607278"></a><!-- doxytag: member="WFACK" ref="7ff0b8b49d1a93feae6f808caf5fe44750a717bfadf9a3fdd634d77950607278" args="" -->WFACK</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" name="7ff0b8b49d1a93feae6f808caf5fe447a1070f3c837e8dc4d7890536f7cfbaf9"></a><!-- doxytag: member="BUSY" ref="7ff0b8b49d1a93feae6f808caf5fe447a1070f3c837e8dc4d7890536f7cfbaf9" args="" -->BUSY</em>&nbsp;</td><td>
</td></tr>
</table>
</dl>

<p>Definition at line <a class="el" href="a00435.html#l00063">63</a> of file <a class="el" href="a00435.html">Mac80211.h</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00063"></a>00063                {
<a name="l00064"></a>00064       <a class="code" href="a00086.html#7ff0b8b49d1a93feae6f808caf5fe447be0abc1112335ff66c1eef6bd95371e4">WFDATA</a> = 0, <span class="comment">// waiting for data packet</span>
<a name="l00065"></a>00065       <a class="code" href="a00086.html#7ff0b8b49d1a93feae6f808caf5fe4474cfe7a25808b0e110d662483abec7256">QUIET</a> = 1,  <span class="comment">// waiting for the communication between two other nodes to end</span>
<a name="l00066"></a>00066       <a class="code" href="a00086.html#7ff0b8b49d1a93feae6f808caf5fe4478904ce43407ca530f7fe83d63c558e28">IDLE</a> = 2,   <span class="comment">// no packet to send, no packet receiving</span>
<a name="l00067"></a>00067       <a class="code" href="a00086.html#7ff0b8b49d1a93feae6f808caf5fe447e138f38743ca77f1300a24d4d79786fe">CONTEND</a> = 3,<span class="comment">// contention state (battle for the channel)</span>
<a name="l00068"></a>00068       <a class="code" href="a00086.html#7ff0b8b49d1a93feae6f808caf5fe447ccc67a0993941984c4f6b49c633c2ad8">WFCTS</a> = 4,  <span class="comment">// RTS sent, waiting for CTS</span>
<a name="l00069"></a>00069       <a class="code" href="a00086.html#7ff0b8b49d1a93feae6f808caf5fe44750a717bfadf9a3fdd634d77950607278">WFACK</a> = 5,  <span class="comment">// DATA packet sent, waiting for ACK</span>
<a name="l00070"></a>00070       <a class="code" href="a00086.html#7ff0b8b49d1a93feae6f808caf5fe447a1070f3c837e8dc4d7890536f7cfbaf9">BUSY</a> = 6    <span class="comment">// during transmission of an ACK or a BROADCAST packet</span>
<a name="l00071"></a>00071     };
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="381307739876ed0d015352b95bd93186"></a><!-- doxytag: member="Mac80211::timerType" ref="381307739876ed0d015352b95bd93186" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="a00086.html#381307739876ed0d015352b95bd93186">Mac80211::timerType</a><code> [protected]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Definition of the timer types <dl compact><dt><b>Enumerator: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" name="381307739876ed0d015352b95bd93186317269d758fc1f055750d43926abbb2f"></a><!-- doxytag: member="TIMEOUT" ref="381307739876ed0d015352b95bd93186317269d758fc1f055750d43926abbb2f" args="" -->TIMEOUT</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" name="381307739876ed0d015352b95bd93186d2d7f908db1dc3ed72e451dad336d654"></a><!-- doxytag: member="NAV" ref="381307739876ed0d015352b95bd93186d2d7f908db1dc3ed72e451dad336d654" args="" -->NAV</em>&nbsp;</td><td>
</td></tr>
</table>
</dl>

<p>Definition at line <a class="el" href="a00435.html#l00057">57</a> of file <a class="el" href="a00435.html">Mac80211.h</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00057"></a>00057                    {
<a name="l00058"></a>00058       <a class="code" href="a00086.html#381307739876ed0d015352b95bd93186317269d758fc1f055750d43926abbb2f">TIMEOUT</a>,
<a name="l00059"></a>00059       <a class="code" href="a00086.html#381307739876ed0d015352b95bd93186d2d7f908db1dc3ed72e451dad336d654">NAV</a>
<a name="l00060"></a>00060     };
</pre></div>
<p>

</div>
</div><p>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="8dd543a1a0b89f98af6d39d28dbd9e74"></a><!-- doxytag: member="Mac80211::addNeighbor" ref="8dd543a1a0b89f98af6d39d28dbd9e74" args="(Mac80211Pkt *af)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Mac80211::addNeighbor           </td>
          <td>(</td>
          <td class="paramtype">Mac80211Pkt *&nbsp;</td>
          <td class="paramname"> <em>af</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
add a new entry to the neighbor list 
<p>

<p>Definition at line <a class="el" href="a00434.html#l01191">1191</a> of file <a class="el" href="a00434.html">Mac80211.cc</a>.</p>

<p>References <a class="el" href="a00435.html#l00076">Mac80211::Mac80211::NeighborEntry::address</a>, <a class="el" href="a00435.html#l00078">Mac80211::Mac80211::NeighborEntry::age</a>, <a class="el" href="a00435.html#l00079">Mac80211::Mac80211::NeighborEntry::bitrate</a>, <a class="el" href="a00435.html#l00277">bitrate</a>, <a class="el" href="a00475.html#l00006">BITRATES_80211</a>, <a class="el" href="a00435.html#l00193">findNeighbor()</a>, <a class="el" href="a00435.html#l00202">findOldestNeighbor()</a>, <a class="el" href="a00435.html#l00077">Mac80211::Mac80211::NeighborEntry::fsc</a>, <a class="el" href="a00462.html#l00044">DeciderResult80211::getSnr()</a>, <a class="el" href="a00435.html#l00323">neighborhoodCacheSize</a>, <a class="el" href="a00435.html#l00327">neighbors</a>, and <a class="el" href="a00435.html#l00283">snrThresholds</a>.</p>

<p>Referenced by <a class="el" href="a00434.html#l00216">handleLowerMsg()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l01191"></a>01191                                           {
<a name="l01192"></a>01192     <span class="keywordtype">int</span> srcAddress = af-&gt;getSrcAddr();
<a name="l01193"></a>01193     NeighborList::iterator it = <a class="code" href="a00086.html#3d2c968c5117f491281ddd54f83a7ee5" title="find a neighbor based on his address">findNeighbor</a>(srcAddress);
<a name="l01194"></a>01194     <span class="keyword">const</span> <a class="code" href="a00056.html" title="Defines an extended DeciderResult for the 80211 protocol which stores the bit-rate...">DeciderResult80211</a>* result = <span class="keyword">static_cast&lt;</span><span class="keyword">const </span><a class="code" href="a00056.html" title="Defines an extended DeciderResult for the 80211 protocol which stores the bit-rate...">DeciderResult80211</a>*<span class="keyword">&gt;</span>(
<a name="l01195"></a>01195                       <span class="keyword">static_cast&lt;</span><a class="code" href="a00111.html" title="Controlinfo for packets which are send from Physical layer to the MAC layer.">PhyToMacControlInfo</a> *<span class="keyword">&gt;</span>(
<a name="l01196"></a>01196                         af-&gt;getControlInfo())-&gt;getDeciderResult());
<a name="l01197"></a>01197     <span class="keywordtype">double</span> snr = result-&gt;<a class="code" href="a00056.html#2a5d1c65094164e0fad38927a14a4fb2" title="Returns the signal to noise ratio of the transmission.">getSnr</a>();
<a name="l01198"></a>01198 
<a name="l01199"></a>01199     <span class="keywordtype">double</span> <a class="code" href="a00086.html#126c9db5a54bafa6ad74eb3ee24bd936" title="Current bit rate at which data is transmitted.">bitrate</a> = <a class="code" href="a00297.html#3e678fe3edd6e7ddf05112025f0362dd" title="Bit rates for 802.11b.">BITRATES_80211</a>[0];
<a name="l01200"></a>01200     NeighborEntry entry;
<a name="l01201"></a>01201 
<a name="l01202"></a>01202     <span class="keywordflow">if</span>(snr &gt; <a class="code" href="a00086.html#1cd38454a518f922ba57f68d22e2f31e" title="Hold RSSI thresholds at which to change the bitrates.">snrThresholds</a>[0]) bitrate = <a class="code" href="a00297.html#3e678fe3edd6e7ddf05112025f0362dd" title="Bit rates for 802.11b.">BITRATES_80211</a>[1];
<a name="l01203"></a>01203     <span class="keywordflow">if</span>(snr &gt; <a class="code" href="a00086.html#1cd38454a518f922ba57f68d22e2f31e" title="Hold RSSI thresholds at which to change the bitrates.">snrThresholds</a>[1]) bitrate = <a class="code" href="a00297.html#3e678fe3edd6e7ddf05112025f0362dd" title="Bit rates for 802.11b.">BITRATES_80211</a>[2];
<a name="l01204"></a>01204     <span class="keywordflow">if</span>(snr &gt; <a class="code" href="a00086.html#1cd38454a518f922ba57f68d22e2f31e" title="Hold RSSI thresholds at which to change the bitrates.">snrThresholds</a>[2]) bitrate = <a class="code" href="a00297.html#3e678fe3edd6e7ddf05112025f0362dd" title="Bit rates for 802.11b.">BITRATES_80211</a>[3];
<a name="l01205"></a>01205 
<a name="l01206"></a>01206     <span class="keywordflow">if</span>(it != <a class="code" href="a00086.html#4caf1f3c2c004851555c9c691b82edf9">neighbors</a>.end()) {
<a name="l01207"></a>01207         it-&gt;age = simTime();
<a name="l01208"></a>01208         it-&gt;bitrate = bitrate;
<a name="l01209"></a>01209     }
<a name="l01210"></a>01210     <span class="keywordflow">else</span> {
<a name="l01211"></a>01211         <span class="keywordflow">if</span>(<a class="code" href="a00086.html#4caf1f3c2c004851555c9c691b82edf9">neighbors</a>.size() &lt; <a class="code" href="a00086.html#e62ff2c9617e5782f6f7231e36d1574d" title="Keep information for this many neighbors.">neighborhoodCacheSize</a>) {
<a name="l01212"></a>01212             entry.address = srcAddress;
<a name="l01213"></a>01213             entry.age = simTime();
<a name="l01214"></a>01214             entry.bitrate = bitrate;
<a name="l01215"></a>01215             entry.fsc = 0;
<a name="l01216"></a>01216             <a class="code" href="a00086.html#4caf1f3c2c004851555c9c691b82edf9">neighbors</a>.push_back(entry);
<a name="l01217"></a>01217         }
<a name="l01218"></a>01218         <span class="keywordflow">else</span> {
<a name="l01219"></a>01219             it = <a class="code" href="a00086.html#967bb2466f35274cc945db0d9e044eeb" title="find the oldest neighbor -- usually in order to overwrite this entry">findOldestNeighbor</a>();
<a name="l01220"></a>01220             <span class="keywordflow">if</span>(it != <a class="code" href="a00086.html#4caf1f3c2c004851555c9c691b82edf9">neighbors</a>.end()) {
<a name="l01221"></a>01221                 it-&gt;age = simTime();
<a name="l01222"></a>01222                 it-&gt;bitrate = bitrate;
<a name="l01223"></a>01223                 it-&gt;address = srcAddress;
<a name="l01224"></a>01224                 it-&gt;fsc = 0;
<a name="l01225"></a>01225             }
<a name="l01226"></a>01226         }
<a name="l01227"></a>01227     }
<a name="l01228"></a>01228     EV &lt;&lt; <span class="stringliteral">"updated information for neighbor: "</span> &lt;&lt; srcAddress
<a name="l01229"></a>01229        &lt;&lt; <span class="stringliteral">" snr: "</span> &lt;&lt; snr &lt;&lt; <span class="stringliteral">" bitrate: "</span> &lt;&lt; bitrate &lt;&lt; endl;
<a name="l01230"></a>01230 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="de2c913df312fd4fc46106c1134889b8"></a><!-- doxytag: member="Mac80211::backoff" ref="de2c913df312fd4fc46106c1134889b8" args="(bool rtscts=true)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">simtime_t Mac80211::backoff           </td>
          <td>(</td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>rtscts</em> = <code>true</code>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Compute a backoff value. 
<p>
Compute the backoff value. 
<p>Definition at line <a class="el" href="a00434.html#l00973">973</a> of file <a class="el" href="a00434.html">Mac80211.cc</a>.</p>

<p>References <a class="el" href="a00475.html#l00079">CW_MAX</a>, <a class="el" href="a00475.html#l00076">CW_MIN</a>, <a class="el" href="a00435.html#l00300">longRetryCounter</a>, <a class="el" href="a00435.html#l00303">shortRetryCounter</a>, and <a class="el" href="a00475.html#l00047">ST</a>.</p>

<p>Referenced by <a class="el" href="a00434.html#l00520">handleACKframe()</a>, <a class="el" href="a00434.html#l00725">handleEndTransmission()</a>, <a class="el" href="a00434.html#l00652">handleTimeoutTimer()</a>, and <a class="el" href="a00434.html#l00033">initialize()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00973"></a>00973                                        {
<a name="l00974"></a>00974     <span class="keywordtype">unsigned</span> rc = (rtscts) ?  <a class="code" href="a00086.html#11fb608b3564e2d2cd41b463b1a8cc90" title="Number of frame transmission attempt.">longRetryCounter</a> : <a class="code" href="a00086.html#9bbc3d71eddb62c4e12dcd500a58b0bb" title="Number of frame transmission attempt.">shortRetryCounter</a>;
<a name="l00975"></a>00975     <span class="keywordtype">unsigned</span> cw = ((<a class="code" href="a00297.html#59e6ff62126f031cb0c32b81338309c3">CW_MIN</a> + 1) &lt;&lt; rc) - 1;
<a name="l00976"></a>00976     <span class="keywordflow">if</span>(cw &gt; <a class="code" href="a00297.html#c6a8118f130ef76bd103d0d6e288099d">CW_MAX</a>) cw = <a class="code" href="a00297.html#c6a8118f130ef76bd103d0d6e288099d">CW_MAX</a>;
<a name="l00977"></a>00977 
<a name="l00978"></a>00978     simtime_t value = ((double) intrand(cw + 1)) * <a class="code" href="a00297.html#ec0071eea60aae281dd371d97a3cc4cd" title="Standard time values.">ST</a>;
<a name="l00979"></a>00979     EV &lt;&lt; simTime() &lt;&lt; <span class="stringliteral">" random backoff = "</span> &lt;&lt; value &lt;&lt; endl;
<a name="l00980"></a>00980 
<a name="l00981"></a>00981     <span class="keywordflow">return</span> value;
<a name="l00982"></a>00982 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="b3030c86acac78401f877a61cefcdad6"></a><!-- doxytag: member="Mac80211::beginNewCycle" ref="b3030c86acac78401f877a61cefcdad6" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Mac80211::beginNewCycle           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
start a new contention period 
<p>
Start a new contention period if the channel is free and if there's a packet to send. Called at the end of a deferring period, a busy period, or after a failure. Called by the HandleMsgForMe(), HandleTimer() HandleUpperMsg(), and, without RTS/CTS, by <a class="el" href="a00086.html#0c26c2759b2d08601ef21246e1ca6707" title="handle a message that is not for me or errornous">handleMsgNotForMe()</a>. 
<p>Definition at line <a class="el" href="a00434.html#l00924">924</a> of file <a class="el" href="a00434.html">Mac80211.cc</a>.</p>

<p>References <a class="el" href="a00435.html#l00067">CONTEND</a>, <a class="el" href="a00435.html#l00250">contention</a>, <a class="el" href="a00435.html#l00313">currentIFS</a>, <a class="el" href="a00435.html#l00293">fromUpperLayer</a>, <a class="el" href="a00090.html#24e146616912b4a59df91a12b81a38cf">MacToPhyInterface::getChannelState()</a>, <a class="el" href="a00435.html#l00066">IDLE</a>, <a class="el" href="a00362.html#l00045">ChannelState::info()</a>, <a class="el" href="a00361.html#l00003">ChannelState::isIdle()</a>, <a class="el" href="a00404.html#l00032">L2BROADCAST</a>, <a class="el" href="a00435.html#l00247">nav</a>, <a class="el" href="a00435.html#l00290">nextIsBroadcast</a>, <a class="el" href="a00339.html#l00061">BaseMacLayer::phy</a>, <a class="el" href="a00435.html#l00308">remainingBackoff</a>, <a class="el" href="a00434.html#l00120">senseChannelWhileIdle()</a>, <a class="el" href="a00434.html#l01118">setState()</a>, and <a class="el" href="a00434.html#l00988">testMaxAttempts()</a>.</p>

<p>Referenced by <a class="el" href="a00434.html#l00520">handleACKframe()</a>, <a class="el" href="a00434.html#l00562">handleBroadcastMsg()</a>, <a class="el" href="a00434.html#l00725">handleEndTransmission()</a>, <a class="el" href="a00434.html#l00327">handleMsgNotForMe()</a>, <a class="el" href="a00434.html#l00629">handleNavTimer()</a>, <a class="el" href="a00434.html#l00652">handleTimeoutTimer()</a>, and <a class="el" href="a00434.html#l00135">handleUpperMsg()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00925"></a>00925 {
<a name="l00926"></a>00926     <span class="comment">// before trying to send one more time a packet, test if the</span>
<a name="l00927"></a>00927     <span class="comment">// maximum retry limit is reached. If it is the case, then</span>
<a name="l00928"></a>00928     <span class="comment">// delete the packet and send the next packet.</span>
<a name="l00929"></a>00929     <a class="code" href="a00086.html#72e78257babff863ca8749b2bb1a97f4" title="Test if maximum number of retries to transmit is exceeded.">testMaxAttempts</a>();
<a name="l00930"></a>00930 
<a name="l00931"></a>00931     <span class="keywordflow">if</span> (<a class="code" href="a00086.html#35efb0198d0085a341aba515bec9146f" title="Timer used for the defer time of a node. Also called NAV : networks allocation vector...">nav</a>-&gt;isScheduled()) {
<a name="l00932"></a>00932         EV &lt;&lt; <span class="stringliteral">"cannot beginNewCycle until NAV expires at t "</span> &lt;&lt; <a class="code" href="a00086.html#35efb0198d0085a341aba515bec9146f" title="Timer used for the defer time of a node. Also called NAV : networks allocation vector...">nav</a>-&gt;getArrivalTime() &lt;&lt; endl;
<a name="l00933"></a>00933         <span class="keywordflow">return</span>;
<a name="l00934"></a>00934     }
<a name="l00935"></a>00935 
<a name="l00936"></a>00936     <span class="keywordflow">if</span> (!<a class="code" href="a00086.html#969e8e3a592dffccea28596c61b2af50" title="Buffering of messages from upper layer.">fromUpperLayer</a>.empty()) {
<a name="l00937"></a>00937 
<a name="l00938"></a>00938         <span class="comment">// look if the next packet is unicast or broadcast</span>
<a name="l00939"></a>00939         <a class="code" href="a00086.html#5d8e9b53c8d6cb0116feed506d843e18" title="Boolean used to know if the next packet is a broadcast packet.">nextIsBroadcast</a> = (<a class="code" href="a00086.html#969e8e3a592dffccea28596c61b2af50" title="Buffering of messages from upper layer.">fromUpperLayer</a>.front()-&gt;getDestAddr() == <a class="code" href="a00307.html#gg06fc87d81c62e9abb8790b6e5713c55b7f19df32f2804a6a4898283c48208a80">L2BROADCAST</a>);
<a name="l00940"></a>00940 
<a name="l00941"></a>00941         <a class="code" href="a00086.html#9fc6eb078e53740d354f8ea7b9d94713" title="Sets the state, and produces a log message in between.">setState</a>(<a class="code" href="a00086.html#7ff0b8b49d1a93feae6f808caf5fe447e138f38743ca77f1300a24d4d79786fe">CONTEND</a>);
<a name="l00942"></a>00942         <span class="keywordflow">if</span>(!<a class="code" href="a00086.html#7bd4f3adc205b150f9fa406fa582f0b6" title="Used to sense if the channel is idle for contention periods.">contention</a>-&gt;isScheduled()) {
<a name="l00943"></a>00943           <a class="code" href="a00037.html" title="Provides information about the current state of the channel:.">ChannelState</a> channel = <a class="code" href="a00017.html#a7b1e6bdb734765a9f4eff7d486dfbea" title="Handler to the physical layer.">phy</a>-&gt;<a class="code" href="a00090.html#24e146616912b4a59df91a12b81a38cf" title="Returns the current state of the channel. See ChannelState for details.">getChannelState</a>();
<a name="l00944"></a>00944             EV &lt;&lt; simTime() &lt;&lt; <span class="stringliteral">" do contention: medium = "</span> &lt;&lt; channel.<a class="code" href="a00037.html#a7125a711299c62119c5fe5bc3f43f1f">info</a>() &lt;&lt; <span class="stringliteral">", backoff = "</span>
<a name="l00945"></a>00945                &lt;&lt;  <a class="code" href="a00086.html#58484d1a6f2031548d433d18438042e9" title="remaining backoff time. If the backoff timer is interrupted, this variable holds...">remainingBackoff</a> &lt;&lt; endl;
<a name="l00946"></a>00946             <span class="comment">//OLD:if(medium == MediumIndication::IDLE) {</span>
<a name="l00947"></a>00947             <span class="keywordflow">if</span>(channel.<a class="code" href="a00037.html#c171088d0d716316bc523511d4e53771" title="Returns true if the channel is considered idle, meaning depends on the used decider...">isIdle</a>()) {
<a name="l00948"></a>00948               <a class="code" href="a00086.html#be230265b97330ce9946e4c336b4761c" title="Starts a channel sense request which sense the channel for the passed duration or...">senseChannelWhileIdle</a>(<a class="code" href="a00086.html#4a9d1c8d45c46f18afa0f07f5b6572f4" title="current IFS value (DIFS or EIFS) If an error has been detected, the next backoff...">currentIFS</a> + <a class="code" href="a00086.html#58484d1a6f2031548d433d18438042e9" title="remaining backoff time. If the backoff timer is interrupted, this variable holds...">remainingBackoff</a>);
<a name="l00949"></a>00949                 <span class="comment">//scheduleAt(simTime() + currentIFS + remainingBackoff, contention);</span>
<a name="l00950"></a>00950             }
<a name="l00951"></a>00951         }
<a name="l00952"></a>00952     }
<a name="l00953"></a>00953     <span class="keywordflow">else</span> {
<a name="l00954"></a>00954         <span class="comment">// post-xmit backoff (minor nit: if random backoff=0, we punt)</span>
<a name="l00955"></a>00955 
<a name="l00956"></a>00956         <span class="keywordflow">if</span>(<a class="code" href="a00086.html#58484d1a6f2031548d433d18438042e9" title="remaining backoff time. If the backoff timer is interrupted, this variable holds...">remainingBackoff</a> &gt; 0 &amp;&amp; !<a class="code" href="a00086.html#7bd4f3adc205b150f9fa406fa582f0b6" title="Used to sense if the channel is idle for contention periods.">contention</a>-&gt;isScheduled()) {
<a name="l00957"></a>00957           <a class="code" href="a00037.html" title="Provides information about the current state of the channel:.">ChannelState</a> channel = <a class="code" href="a00017.html#a7b1e6bdb734765a9f4eff7d486dfbea" title="Handler to the physical layer.">phy</a>-&gt;<a class="code" href="a00090.html#24e146616912b4a59df91a12b81a38cf" title="Returns the current state of the channel. See ChannelState for details.">getChannelState</a>();
<a name="l00958"></a>00958             EV &lt;&lt; simTime() &lt;&lt; <span class="stringliteral">" do contention: medium = "</span> &lt;&lt; channel.<a class="code" href="a00037.html#a7125a711299c62119c5fe5bc3f43f1f">info</a>() &lt;&lt; <span class="stringliteral">", backoff = "</span>
<a name="l00959"></a>00959                &lt;&lt;  <a class="code" href="a00086.html#58484d1a6f2031548d433d18438042e9" title="remaining backoff time. If the backoff timer is interrupted, this variable holds...">remainingBackoff</a> &lt;&lt; endl;
<a name="l00960"></a>00960             <span class="comment">//OLD:if(medium == MediumIndication::IDLE) {</span>
<a name="l00961"></a>00961             <span class="keywordflow">if</span>(channel.<a class="code" href="a00037.html#c171088d0d716316bc523511d4e53771" title="Returns true if the channel is considered idle, meaning depends on the used decider...">isIdle</a>()) {
<a name="l00962"></a>00962               <a class="code" href="a00086.html#be230265b97330ce9946e4c336b4761c" title="Starts a channel sense request which sense the channel for the passed duration or...">senseChannelWhileIdle</a>(<a class="code" href="a00086.html#4a9d1c8d45c46f18afa0f07f5b6572f4" title="current IFS value (DIFS or EIFS) If an error has been detected, the next backoff...">currentIFS</a> + <a class="code" href="a00086.html#58484d1a6f2031548d433d18438042e9" title="remaining backoff time. If the backoff timer is interrupted, this variable holds...">remainingBackoff</a>);
<a name="l00963"></a>00963                 <span class="comment">//scheduleAt(simTime() + currentIFS + remainingBackoff, contention);</span>
<a name="l00964"></a>00964             }
<a name="l00965"></a>00965         }
<a name="l00966"></a>00966         <a class="code" href="a00086.html#9fc6eb078e53740d354f8ea7b9d94713" title="Sets the state, and produces a log message in between.">setState</a>(<a class="code" href="a00086.html#7ff0b8b49d1a93feae6f808caf5fe4478904ce43407ca530f7fe83d63c558e28">IDLE</a>);
<a name="l00967"></a>00967     }
<a name="l00968"></a>00968 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="f3931f437864a565081885eba81b6019"></a><!-- doxytag: member="Mac80211::createSignal" ref="f3931f437864a565081885eba81b6019" args="(simtime_t start, simtime_t length, double power, double bitrate)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="a00124.html">Signal</a> * Mac80211::createSignal           </td>
          <td>(</td>
          <td class="paramtype">simtime_t&nbsp;</td>
          <td class="paramname"> <em>start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">simtime_t&nbsp;</td>
          <td class="paramname"> <em>length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>power</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>bitrate</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Creates the signal to be used for a packet to be sent. 
<p>

<p>Reimplemented from <a class="el" href="a00017.html#8815bb8f7fdd9e341819fb62d8141bad">BaseMacLayer</a>.</p>

<p>Definition at line <a class="el" href="a00434.html#l01004">1004</a> of file <a class="el" href="a00434.html">Mac80211.cc</a>.</p>

<p>References <a class="el" href="a00475.html#l00028">BITRATE_HEADER</a>, <a class="el" href="a00435.html#l00274">centerFreq</a>, <a class="el" href="a00372.html#l00091">MappingUtils::createMapping()</a>, <a class="el" href="a00338.html#l00189">BaseMacLayer::createSingleFrequencyMapping()</a>, <a class="el" href="a00475.html#l00024">PHY_HEADER_LENGTH</a>, <a class="el" href="a00378.html#l00147">Signal::setBitrate()</a>, <a class="el" href="a00370.html#l00106">Argument::setTime()</a>, <a class="el" href="a00378.html#l00137">Signal::setTransmissionPower()</a>, <a class="el" href="a00092.html#97d55ce9d61cc11abc5a16b4a594e29d">Mapping::setValue()</a>, <a class="el" href="a00371.html#l00839">Mapping::STEPS</a>, and <a class="el" href="a00371.html#l00162">DimensionSet::timeDomain</a>.</p>

<p>Referenced by <a class="el" href="a00434.html#l00782">sendACKframe()</a>, <a class="el" href="a00434.html#l00897">sendBROADCASTframe()</a>, <a class="el" href="a00434.html#l00860">sendCTSframe()</a>, <a class="el" href="a00434.html#l00742">sendDATAframe()</a>, and <a class="el" href="a00434.html#l00818">sendRTSframe()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l01005"></a>01005 {
<a name="l01006"></a>01006   simtime_t end = start + length;
<a name="l01007"></a>01007   <span class="comment">//create signal with start at current simtime and passed length</span>
<a name="l01008"></a>01008   <a class="code" href="a00124.html" title="The signal class stores the physical representation of the signal of an AirFrame...">Signal</a>* s = <span class="keyword">new</span> <a class="code" href="a00124.html" title="The signal class stores the physical representation of the signal of an AirFrame...">Signal</a>(start, length);
<a name="l01009"></a>01009 
<a name="l01010"></a>01010   <span class="comment">//create and set tx power mapping</span>
<a name="l01011"></a>01011   <a class="code" href="a00045.html" title="Represents a not changeable mapping (mathematical function) from domain with at least...">ConstMapping</a>* txPowerMapping = <a class="code" href="a00017.html#c534461d74773d51a9507b2a2809f4d9" title="Creates a Mapping defined over time and frequency with constant power in a certain...">createSingleFrequencyMapping</a>(start, end, <a class="code" href="a00086.html#67eba657efe23f5e5c21904f4744261d" title="Stores the center frequency the Mac uses.">centerFreq</a>, 11.0e6, power);
<a name="l01012"></a>01012   s-&gt;<a class="code" href="a00124.html#d8c5494d0f7bd564bf14dc0c90f9a361" title="Sets the function representing the transmission power of the signal.">setTransmissionPower</a>(txPowerMapping);
<a name="l01013"></a>01013 
<a name="l01014"></a>01014   <span class="comment">//create and set bitrate mapping</span>
<a name="l01015"></a>01015 
<a name="l01016"></a>01016   <span class="comment">//create mapping over time</span>
<a name="l01017"></a>01017   <a class="code" href="a00092.html" title="Represents a changeable mapping (mathematical function) from at least time to double...">Mapping</a>* bitrateMapping = <a class="code" href="a00094.html#df03a87cc02707bf9136b305fd795a6f" title="Returns an appropriate changeable Mapping with the specified domain and the specified...">MappingUtils::createMapping</a>(<a class="code" href="a00061.html#bf3b99a319deca6efc123ec52d77d867" title="Shortcut to a DimensionSet which only contains time.">DimensionSet::timeDomain</a>, <a class="code" href="a00092.html#a713c0cd84f74727888bef5b9e8b064314b1d21bd98ca6e7e77dca120dd5eb0f" title="interpolates with next lower entry">Mapping::STEPS</a>);
<a name="l01018"></a>01018 
<a name="l01019"></a>01019   <a class="code" href="a00003.html" title="Defines an argument for a mapping.">Argument</a> pos(start);
<a name="l01020"></a>01020   bitrateMapping-&gt;<a class="code" href="a00092.html#97d55ce9d61cc11abc5a16b4a594e29d" title="Changes the value of the Mapping at the specified position.">setValue</a>(pos, <a class="code" href="a00297.html#0454abde1a622bc79c2528d728e466ef" title="Bitrate with which the header is send.">BITRATE_HEADER</a>);
<a name="l01021"></a>01021 
<a name="l01022"></a>01022   pos.setTime(<a class="code" href="a00297.html#1be276497de806411e2c5cc3b8d5d08b" title="Length of PLCP header and Preamble.">PHY_HEADER_LENGTH</a> / <a class="code" href="a00297.html#0454abde1a622bc79c2528d728e466ef" title="Bitrate with which the header is send.">BITRATE_HEADER</a>);
<a name="l01023"></a>01023   bitrateMapping-&gt;<a class="code" href="a00092.html#97d55ce9d61cc11abc5a16b4a594e29d" title="Changes the value of the Mapping at the specified position.">setValue</a>(pos, <a class="code" href="a00086.html#126c9db5a54bafa6ad74eb3ee24bd936" title="Current bit rate at which data is transmitted.">bitrate</a>);
<a name="l01024"></a>01024 
<a name="l01025"></a>01025   s-&gt;<a class="code" href="a00124.html#86e4ecdabd5ca03ede5e2c81c6b76002" title="Sets the function representing the bitrate of the signal.">setBitrate</a>(bitrateMapping);
<a name="l01026"></a>01026 
<a name="l01027"></a>01027   <span class="keywordflow">return</span> s;
<a name="l01028"></a>01028 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="3ef80a5603d99ff49bb7769a333e939a"></a><!-- doxytag: member="Mac80211::decapsMsg" ref="3ef80a5603d99ff49bb7769a333e939a" args="(Mac80211Pkt *frame)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">cMessage * Mac80211::decapsMsg           </td>
          <td>(</td>
          <td class="paramtype">Mac80211Pkt *&nbsp;</td>
          <td class="paramname"> <em>frame</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
decapsulate packet 
<p>

<p>Definition at line <a class="el" href="a00434.html#l00203">203</a> of file <a class="el" href="a00434.html">Mac80211.cc</a>.</p>

<p>Referenced by <a class="el" href="a00434.html#l00562">handleBroadcastMsg()</a>, and <a class="el" href="a00434.html#l00493">handleDATAframe()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00203"></a>00203                                                 {
<a name="l00204"></a>00204     cMessage *m = frame-&gt;decapsulate();
<a name="l00205"></a>00205     m-&gt;setControlInfo(<span class="keyword">new</span> <a class="code" href="a00088.html" title="Control info to pass next hop L2 addr from netw to MAC layer.">MacControlInfo</a>(frame-&gt;getSrcAddr()));
<a name="l00206"></a>00206     EV &lt;&lt; <span class="stringliteral">" message decapsulated "</span> &lt;&lt; endl;
<a name="l00207"></a>00207     <span class="keywordflow">return</span> m;
<a name="l00208"></a>00208 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="008b57947b7d9287bb34b1e67094ebb8"></a><!-- doxytag: member="Mac80211::encapsMsg" ref="008b57947b7d9287bb34b1e67094ebb8" args="(cPacket *netw)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Mac80211Pkt * Mac80211::encapsMsg           </td>
          <td>(</td>
          <td class="paramtype">cPacket *&nbsp;</td>
          <td class="paramname"> <em>netw</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
encapsulate packet 
<p>
Encapsulates the received network-layer packet into a MacPkt and set all needed header fields. 
<p>Reimplemented from <a class="el" href="a00017.html#32d47cbd6940c09071e0f0e777cf6716">BaseMacLayer</a>.</p>

<p>Definition at line <a class="el" href="a00434.html#l00172">172</a> of file <a class="el" href="a00434.html">Mac80211.cc</a>.</p>

<p>References <a class="el" href="a00435.html#l00333">fsc</a>, <a class="el" href="a00400.html#l00054">MacControlInfo::getNextHopMac()</a>, <a class="el" href="a00475.html#l00040">MAC80211_HEADER_LENGTH</a>, and <a class="el" href="a00435.html#l00237">myMacAddr</a>.</p>

<p>Referenced by <a class="el" href="a00434.html#l00135">handleUpperMsg()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00173"></a>00173 {
<a name="l00174"></a>00174 
<a name="l00175"></a>00175     Mac80211Pkt *pkt = <span class="keyword">new</span> Mac80211Pkt(netw-&gt;getName());
<a name="l00176"></a>00176     <span class="comment">// headerLength, including final CRC-field AND the phy header length!</span>
<a name="l00177"></a>00177     pkt-&gt;setBitLength(<a class="code" href="a00297.html#7e14c9f344489ba48f9f6ad1ee865e19">MAC80211_HEADER_LENGTH</a>);
<a name="l00178"></a>00178     pkt-&gt;setRetry(<span class="keyword">false</span>);                 <span class="comment">// this is not a retry</span>
<a name="l00179"></a>00179     pkt-&gt;setSequenceControl(<a class="code" href="a00086.html#026837b7167d230bbe79a1e0630c7578">fsc</a>++);       <span class="comment">// add a unique fsc to it</span>
<a name="l00180"></a>00180     <span class="keywordflow">if</span>(<a class="code" href="a00086.html#026837b7167d230bbe79a1e0630c7578">fsc</a> &lt;= 0) <a class="code" href="a00086.html#026837b7167d230bbe79a1e0630c7578">fsc</a> = 1;
<a name="l00181"></a>00181 
<a name="l00182"></a>00182     <span class="comment">// copy dest address from the Control Info attached to the network</span>
<a name="l00183"></a>00183     <span class="comment">// mesage by the network layer</span>
<a name="l00184"></a>00184     <a class="code" href="a00088.html" title="Control info to pass next hop L2 addr from netw to MAC layer.">MacControlInfo</a>* cInfo = <span class="keyword">static_cast&lt;</span><a class="code" href="a00088.html" title="Control info to pass next hop L2 addr from netw to MAC layer.">MacControlInfo</a>*<span class="keyword">&gt;</span>(netw-&gt;removeControlInfo());
<a name="l00185"></a>00185 
<a name="l00186"></a>00186     EV &lt;&lt;<span class="stringliteral">"CInfo removed, mac addr="</span>&lt;&lt; cInfo-&gt;<a class="code" href="a00088.html#2baa654bb07a52e191efc6885e273d35" title="Getter method.">getNextHopMac</a>()&lt;&lt;endl;
<a name="l00187"></a>00187     pkt-&gt;setDestAddr(cInfo-&gt;<a class="code" href="a00088.html#2baa654bb07a52e191efc6885e273d35" title="Getter method.">getNextHopMac</a>());
<a name="l00188"></a>00188 
<a name="l00189"></a>00189     <span class="comment">//delete the control info</span>
<a name="l00190"></a>00190     <span class="keyword">delete</span> cInfo;
<a name="l00191"></a>00191 
<a name="l00192"></a>00192     <span class="comment">//set the src address to own mac address (nic module id())</span>
<a name="l00193"></a>00193     pkt-&gt;setSrcAddr(<a class="code" href="a00086.html#ac2e4050e1e1277556033521e3a296d5" title="MAC address (obtained from arp module).">myMacAddr</a>);
<a name="l00194"></a>00194 
<a name="l00195"></a>00195     <span class="comment">//encapsulate the network packet</span>
<a name="l00196"></a>00196     pkt-&gt;encapsulate(netw);
<a name="l00197"></a>00197     EV &lt;&lt;<span class="stringliteral">"pkt encapsulated, length: "</span> &lt;&lt; pkt-&gt;getBitLength() &lt;&lt; <span class="stringliteral">"\n"</span>;
<a name="l00198"></a>00198 
<a name="l00199"></a>00199     <span class="keywordflow">return</span> pkt;
<a name="l00200"></a>00200 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="3d2c968c5117f491281ddd54f83a7ee5"></a><!-- doxytag: member="Mac80211::findNeighbor" ref="3d2c968c5117f491281ddd54f83a7ee5" args="(int id)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">NeighborList::iterator Mac80211::findNeighbor           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>id</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
find a neighbor based on his address 
<p>

<p>Definition at line <a class="el" href="a00435.html#l00193">193</a> of file <a class="el" href="a00435.html">Mac80211.h</a>.</p>

<p>References <a class="el" href="a00435.html#l00327">neighbors</a>.</p>

<p>Referenced by <a class="el" href="a00434.html#l01191">addNeighbor()</a>, <a class="el" href="a00434.html#l00493">handleDATAframe()</a>, and <a class="el" href="a00434.html#l01178">retrieveBitrate()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00193"></a>00193                                                {
<a name="l00194"></a>00194         NeighborList::iterator it;
<a name="l00195"></a>00195         <span class="keywordflow">for</span>(it = <a class="code" href="a00086.html#4caf1f3c2c004851555c9c691b82edf9">neighbors</a>.begin(); it != <a class="code" href="a00086.html#4caf1f3c2c004851555c9c691b82edf9">neighbors</a>.end(); ++it) {
<a name="l00196"></a>00196             <span class="keywordflow">if</span>(it-&gt;address == <span class="keywordtype">id</span>) <span class="keywordflow">break</span>;
<a name="l00197"></a>00197         }
<a name="l00198"></a>00198         <span class="keywordflow">return</span> it;
<a name="l00199"></a>00199     }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="967bb2466f35274cc945db0d9e044eeb"></a><!-- doxytag: member="Mac80211::findOldestNeighbor" ref="967bb2466f35274cc945db0d9e044eeb" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">NeighborList::iterator Mac80211::findOldestNeighbor           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
find the oldest neighbor -- usually in order to overwrite this entry 
<p>

<p>Definition at line <a class="el" href="a00435.html#l00202">202</a> of file <a class="el" href="a00435.html">Mac80211.h</a>.</p>

<p>References <a class="el" href="a00435.html#l00327">neighbors</a>.</p>

<p>Referenced by <a class="el" href="a00434.html#l01191">addNeighbor()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00202"></a>00202                                               {
<a name="l00203"></a>00203         NeighborList::iterator it = <a class="code" href="a00086.html#4caf1f3c2c004851555c9c691b82edf9">neighbors</a>.begin();
<a name="l00204"></a>00204         NeighborList::iterator oldIt = <a class="code" href="a00086.html#4caf1f3c2c004851555c9c691b82edf9">neighbors</a>.begin();
<a name="l00205"></a>00205         simtime_t age = it-&gt;age;
<a name="l00206"></a>00206         <span class="keywordflow">for</span>(; it != <a class="code" href="a00086.html#4caf1f3c2c004851555c9c691b82edf9">neighbors</a>.end(); ++it) {
<a name="l00207"></a>00207             <span class="keywordflow">if</span>(it-&gt;age &lt; age) {
<a name="l00208"></a>00208                 age = it-&gt;age;
<a name="l00209"></a>00209                 oldIt = it;
<a name="l00210"></a>00210             }
<a name="l00211"></a>00211         }
<a name="l00212"></a>00212         <span class="keywordflow">return</span> oldIt;
<a name="l00213"></a>00213     }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="2f3c51473a890e1c3e3afb5dc1b75252"></a><!-- doxytag: member="Mac80211::finish" ref="2f3c51473a890e1c3e3afb5dc1b75252" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Mac80211::finish           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Reimplemented from <a class="el" href="a00016.html#5ab11502dbeeea89693d29841376a2f7">BaseLayer</a>.</p>

<p>Definition at line <a class="el" href="a00434.html#l01232">1232</a> of file <a class="el" href="a00434.html">Mac80211.cc</a>.</p>

<p>References <a class="el" href="a00435.html#l00250">contention</a>, <a class="el" href="a00435.html#l00253">endSifs</a>, <a class="el" href="a00435.html#l00293">fromUpperLayer</a>, <a class="el" href="a00435.html#l00247">nav</a>, and <a class="el" href="a00435.html#l00243">timeout</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l01232"></a>01232                       {
<a name="l01233"></a>01233     <a class="code" href="a00086.html#2f3c51473a890e1c3e3afb5dc1b75252">BaseMacLayer::finish</a>();
<a name="l01234"></a>01234     MacPktList::iterator it;
<a name="l01235"></a>01235 
<a name="l01236"></a>01236     <span class="keywordflow">if</span>(!<a class="code" href="a00086.html#2d31f97b0662b8e37f090c3b996cec82" title="Timer used for time-outs after the transmission of a RTS, a CTS, or a DATA packet...">timeout</a>-&gt;isScheduled()) <span class="keyword">delete</span> <a class="code" href="a00086.html#2d31f97b0662b8e37f090c3b996cec82" title="Timer used for time-outs after the transmission of a RTS, a CTS, or a DATA packet...">timeout</a>;
<a name="l01237"></a>01237     <span class="keywordflow">if</span>(!<a class="code" href="a00086.html#35efb0198d0085a341aba515bec9146f" title="Timer used for the defer time of a node. Also called NAV : networks allocation vector...">nav</a>-&gt;isScheduled()) <span class="keyword">delete</span> <a class="code" href="a00086.html#35efb0198d0085a341aba515bec9146f" title="Timer used for the defer time of a node. Also called NAV : networks allocation vector...">nav</a>;
<a name="l01238"></a>01238     <span class="keywordflow">if</span>(!<a class="code" href="a00086.html#7bd4f3adc205b150f9fa406fa582f0b6" title="Used to sense if the channel is idle for contention periods.">contention</a>-&gt;isScheduled()) <span class="keyword">delete</span> <a class="code" href="a00086.html#7bd4f3adc205b150f9fa406fa582f0b6" title="Used to sense if the channel is idle for contention periods.">contention</a>;
<a name="l01239"></a>01239     <span class="keywordflow">if</span>(!<a class="code" href="a00086.html#ce80836b6fcb1681f6b2d49466f87fb0" title="Timer used to indicate the end of a SIFS.">endSifs</a>-&gt;isScheduled()) <span class="keyword">delete</span> <a class="code" href="a00086.html#ce80836b6fcb1681f6b2d49466f87fb0" title="Timer used to indicate the end of a SIFS.">endSifs</a>;
<a name="l01240"></a>01240 
<a name="l01241"></a>01241     <span class="keywordflow">for</span>(it = <a class="code" href="a00086.html#969e8e3a592dffccea28596c61b2af50" title="Buffering of messages from upper layer.">fromUpperLayer</a>.begin(); it != <a class="code" href="a00086.html#969e8e3a592dffccea28596c61b2af50" title="Buffering of messages from upper layer.">fromUpperLayer</a>.end(); ++it) {
<a name="l01242"></a>01242         <span class="keyword">delete</span> (*it);
<a name="l01243"></a>01243     }
<a name="l01244"></a>01244     <a class="code" href="a00086.html#969e8e3a592dffccea28596c61b2af50" title="Buffering of messages from upper layer.">fromUpperLayer</a>.clear();
<a name="l01245"></a>01245 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="50cb85360462eb7d256ec8a0b493ca44"></a><!-- doxytag: member="Mac80211::handleACKframe" ref="50cb85360462eb7d256ec8a0b493ca44" args="(Mac80211Pkt *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Mac80211::handleACKframe           </td>
          <td>(</td>
          <td class="paramtype">Mac80211Pkt *&nbsp;</td>
          <td class="paramname"> <em>af</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Handle ACK and delete corresponding packet from queue 
<p>Definition at line <a class="el" href="a00434.html#l00520">520</a> of file <a class="el" href="a00434.html">Mac80211.cc</a>.</p>

<p>References <a class="el" href="a00434.html#l00973">backoff()</a>, <a class="el" href="a00434.html#l00924">beginNewCycle()</a>, <a class="el" href="a00435.html#l00293">fromUpperLayer</a>, <a class="el" href="a00435.html#l00300">longRetryCounter</a>, <a class="el" href="a00435.html#l00308">remainingBackoff</a>, <a class="el" href="a00435.html#l00303">shortRetryCounter</a>, and <a class="el" href="a00435.html#l00243">timeout</a>.</p>

<p>Referenced by <a class="el" href="a00434.html#l00397">handleMsgForMe()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00521"></a>00521 {
<a name="l00522"></a>00522     <span class="comment">// cancel time-out event</span>
<a name="l00523"></a>00523     cancelEvent(<a class="code" href="a00086.html#2d31f97b0662b8e37f090c3b996cec82" title="Timer used for time-outs after the transmission of a RTS, a CTS, or a DATA packet...">timeout</a>);
<a name="l00524"></a>00524 
<a name="l00525"></a>00525     <span class="comment">// the transmission is acknowledged : initialize long_retry_counter</span>
<a name="l00526"></a>00526     <a class="code" href="a00086.html#11fb608b3564e2d2cd41b463b1a8cc90" title="Number of frame transmission attempt.">longRetryCounter</a> = 0;
<a name="l00527"></a>00527     <a class="code" href="a00086.html#9bbc3d71eddb62c4e12dcd500a58b0bb" title="Number of frame transmission attempt.">shortRetryCounter</a> = 0;
<a name="l00528"></a>00528     <span class="comment">// post transmit backoff</span>
<a name="l00529"></a>00529     <a class="code" href="a00086.html#58484d1a6f2031548d433d18438042e9" title="remaining backoff time. If the backoff timer is interrupted, this variable holds...">remainingBackoff</a> = <a class="code" href="a00086.html#de2c913df312fd4fc46106c1134889b8" title="Compute a backoff value.">backoff</a>();
<a name="l00530"></a>00530     <span class="comment">// removes the acknowledged packet from the queue</span>
<a name="l00531"></a>00531     Mac80211Pkt *temp = <a class="code" href="a00086.html#969e8e3a592dffccea28596c61b2af50" title="Buffering of messages from upper layer.">fromUpperLayer</a>.front();
<a name="l00532"></a>00532     <a class="code" href="a00086.html#969e8e3a592dffccea28596c61b2af50" title="Buffering of messages from upper layer.">fromUpperLayer</a>.pop_front();
<a name="l00533"></a>00533     <span class="keyword">delete</span> temp;
<a name="l00534"></a>00534 
<a name="l00535"></a>00535     <span class="comment">// if thre's a packet to send and if the channel is free then start a new contention period</span>
<a name="l00536"></a>00536     <a class="code" href="a00086.html#b3030c86acac78401f877a61cefcdad6" title="start a new contention period">beginNewCycle</a>();
<a name="l00537"></a>00537 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="dfcf8b7a5e1db233a1bd717cecaf49bd"></a><!-- doxytag: member="Mac80211::handleBroadcastMsg" ref="dfcf8b7a5e1db233a1bd717cecaf49bd" args="(Mac80211Pkt *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Mac80211::handleBroadcastMsg           </td>
          <td>(</td>
          <td class="paramtype">Mac80211Pkt *&nbsp;</td>
          <td class="paramname"> <em>af</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Handle a broadcast packet. This packet is simply passed to the upper layer. No acknowledgement is needed. Called by handleLowerMsg(Mac80211Pkt *af) 
<p>Definition at line <a class="el" href="a00434.html#l00562">562</a> of file <a class="el" href="a00434.html">Mac80211.cc</a>.</p>

<p>References <a class="el" href="a00434.html#l00924">beginNewCycle()</a>, <a class="el" href="a00435.html#l00070">BUSY</a>, <a class="el" href="a00435.html#l00067">CONTEND</a>, <a class="el" href="a00435.html#l00250">contention</a>, <a class="el" href="a00434.html#l00203">decapsMsg()</a>, <a class="el" href="a00336.html#l00113">BaseLayer::sendUp()</a>, <a class="el" href="a00435.html#l00261">state</a>, and <a class="el" href="a00435.html#l00330">switching</a>.</p>

<p>Referenced by <a class="el" href="a00434.html#l00216">handleLowerMsg()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00563"></a>00563 {
<a name="l00564"></a>00564     EV &lt;&lt; <span class="stringliteral">"handle broadcast\n"</span>;
<a name="l00565"></a>00565     <span class="keywordflow">if</span>((<a class="code" href="a00086.html#56fa75f3eb056ae29b1a4b8da0035d8c" title="Current state of the MAC.">state</a> == <a class="code" href="a00086.html#7ff0b8b49d1a93feae6f808caf5fe447a1070f3c837e8dc4d7890536f7cfbaf9">BUSY</a>) &amp;&amp; (!<a class="code" href="a00086.html#9f9f566e85a76f63e63b5907bf9ad48a">switching</a>)) {
<a name="l00566"></a>00566         error(<span class="stringliteral">"logic error: node is currently transmitting, can not receive "</span>
<a name="l00567"></a>00567               <span class="stringliteral">"(does the physical layer do its job correctly?)"</span>);
<a name="l00568"></a>00568     }
<a name="l00569"></a>00569     <a class="code" href="a00016.html#dbf061566606041db811b519f0400ed5" title="Sends a message to the upper layer.">sendUp</a>(<a class="code" href="a00086.html#3ef80a5603d99ff49bb7769a333e939a" title="decapsulate packet">decapsMsg</a>(af));
<a name="l00570"></a>00570     <span class="keyword">delete</span> af;
<a name="l00571"></a>00571     <span class="keywordflow">if</span> (<a class="code" href="a00086.html#56fa75f3eb056ae29b1a4b8da0035d8c" title="Current state of the MAC.">state</a> == <a class="code" href="a00086.html#7ff0b8b49d1a93feae6f808caf5fe447e138f38743ca77f1300a24d4d79786fe">CONTEND</a>) {
<a name="l00572"></a>00572       assert(!<a class="code" href="a00086.html#7bd4f3adc205b150f9fa406fa582f0b6" title="Used to sense if the channel is idle for contention periods.">contention</a>-&gt;isScheduled());
<a name="l00573"></a>00573     <span class="comment">//suspendContention();</span>
<a name="l00574"></a>00574 
<a name="l00575"></a>00575         <a class="code" href="a00086.html#b3030c86acac78401f877a61cefcdad6" title="start a new contention period">beginNewCycle</a>();
<a name="l00576"></a>00576     }
<a name="l00577"></a>00577 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="e1e17af7dddc261d7947d48a1f4d0e21"></a><!-- doxytag: member="Mac80211::handleCTSframe" ref="e1e17af7dddc261d7947d48a1f4d0e21" args="(Mac80211Pkt *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Mac80211::handleCTSframe           </td>
          <td>(</td>
          <td class="paramtype">Mac80211Pkt *&nbsp;</td>
          <td class="paramname"> <em>af</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Handle a CTS frame. Called by HandleMsgForMe(Mac80211Pkt* af) 
<p>Definition at line <a class="el" href="a00434.html#l00543">543</a> of file <a class="el" href="a00434.html">Mac80211.cc</a>.</p>

<p>References <a class="el" href="a00435.html#l00253">endSifs</a>, <a class="el" href="a00336.html#l00123">BaseLayer::sendControlDown()</a>, <a class="el" href="a00435.html#l00303">shortRetryCounter</a>, and <a class="el" href="a00435.html#l00243">timeout</a>.</p>

<p>Referenced by <a class="el" href="a00434.html#l00397">handleMsgForMe()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00544"></a>00544 {
<a name="l00545"></a>00545     <span class="comment">// cancel time-out event</span>
<a name="l00546"></a>00546     cancelEvent(<a class="code" href="a00086.html#2d31f97b0662b8e37f090c3b996cec82" title="Timer used for time-outs after the transmission of a RTS, a CTS, or a DATA packet...">timeout</a>);
<a name="l00547"></a>00547     <a class="code" href="a00086.html#9bbc3d71eddb62c4e12dcd500a58b0bb" title="Number of frame transmission attempt.">shortRetryCounter</a> = 0;
<a name="l00548"></a>00548     <span class="comment">// wait a short interframe space</span>
<a name="l00549"></a>00549     <span class="keywordflow">if</span>(<a class="code" href="a00086.html#ce80836b6fcb1681f6b2d49466f87fb0" title="Timer used to indicate the end of a SIFS.">endSifs</a>-&gt;isScheduled()) error(<span class="stringliteral">"Mac80211::handleCTSframe when SIFS scheduled"</span>);
<a name="l00550"></a>00550     <a class="code" href="a00086.html#ce80836b6fcb1681f6b2d49466f87fb0" title="Timer used to indicate the end of a SIFS.">endSifs</a>-&gt;setContextPointer(af);
<a name="l00551"></a>00551 
<a name="l00552"></a>00552     <a class="code" href="a00016.html#6d01a0f56978740d7617c2e338858cc3" title="Sends a control message to a lower layer.">sendControlDown</a>(<a class="code" href="a00086.html#ce80836b6fcb1681f6b2d49466f87fb0" title="Timer used to indicate the end of a SIFS.">endSifs</a>);
<a name="l00553"></a>00553     <span class="comment">//scheduleAt(simTime() + SIFS, endSifs);</span>
<a name="l00554"></a>00554 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="b0844f9dbcece750c9a58ca9f0a73fe1"></a><!-- doxytag: member="Mac80211::handleDATAframe" ref="b0844f9dbcece750c9a58ca9f0a73fe1" args="(Mac80211Pkt *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Mac80211::handleDATAframe           </td>
          <td>(</td>
          <td class="paramtype">Mac80211Pkt *&nbsp;</td>
          <td class="paramname"> <em>af</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Handle a frame which expected to be a DATA frame. Called by HandleMsgForMe() 
<p>Definition at line <a class="el" href="a00434.html#l00493">493</a> of file <a class="el" href="a00434.html">Mac80211.cc</a>.</p>

<p>References <a class="el" href="a00434.html#l00203">decapsMsg()</a>, <a class="el" href="a00435.html#l00253">endSifs</a>, <a class="el" href="a00435.html#l00193">findNeighbor()</a>, <a class="el" href="a00435.html#l00327">neighbors</a>, <a class="el" href="a00435.html#l00179">rtsCts()</a>, <a class="el" href="a00336.html#l00123">BaseLayer::sendControlDown()</a>, <a class="el" href="a00336.html#l00113">BaseLayer::sendUp()</a>, and <a class="el" href="a00435.html#l00243">timeout</a>.</p>

<p>Referenced by <a class="el" href="a00434.html#l00397">handleMsgForMe()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00494"></a>00494 {
<a name="l00495"></a>00495     NeighborList::iterator it;
<a name="l00496"></a>00496     <span class="keywordflow">if</span> (<a class="code" href="a00086.html#a316943080d714ffc3c0bf54ea8aeb08" title="Check whether the next packet should be send with RTS/CTS.">rtsCts</a>(af)) cancelEvent(<a class="code" href="a00086.html#2d31f97b0662b8e37f090c3b996cec82" title="Timer used for time-outs after the transmission of a RTS, a CTS, or a DATA packet...">timeout</a>);  <span class="comment">// cancel time-out event</span>
<a name="l00497"></a>00497     it = <a class="code" href="a00086.html#3d2c968c5117f491281ddd54f83a7ee5" title="find a neighbor based on his address">findNeighbor</a>(af-&gt;getSrcAddr());
<a name="l00498"></a>00498     <span class="keywordflow">if</span>(it == <a class="code" href="a00086.html#4caf1f3c2c004851555c9c691b82edf9">neighbors</a>.end()) error(<span class="stringliteral">"Mac80211::handleDATAframe: neighbor not registered"</span>);
<a name="l00499"></a>00499     <span class="keywordflow">if</span>(af-&gt;getRetry() &amp;&amp; (it-&gt;fsc == af-&gt;getSequenceControl())) {
<a name="l00500"></a>00500         EV &lt;&lt; <span class="stringliteral">"Mac80211::handleDATAframe suppressed duplicate message "</span> &lt;&lt; af
<a name="l00501"></a>00501            &lt;&lt; <span class="stringliteral">" fsc: "</span> &lt;&lt; it-&gt;fsc &lt;&lt; <span class="stringliteral">"\n"</span>;
<a name="l00502"></a>00502     }
<a name="l00503"></a>00503     <span class="keywordflow">else</span> {
<a name="l00504"></a>00504         it-&gt;fsc = af-&gt;getSequenceControl();
<a name="l00505"></a>00505         <span class="comment">// pass the packet to the upper layer</span>
<a name="l00506"></a>00506         <a class="code" href="a00016.html#dbf061566606041db811b519f0400ed5" title="Sends a message to the upper layer.">sendUp</a>(<a class="code" href="a00086.html#3ef80a5603d99ff49bb7769a333e939a" title="decapsulate packet">decapsMsg</a>(af));
<a name="l00507"></a>00507     }
<a name="l00508"></a>00508     <span class="comment">// wait a short interframe space</span>
<a name="l00509"></a>00509     <span class="keywordflow">if</span>(<a class="code" href="a00086.html#ce80836b6fcb1681f6b2d49466f87fb0" title="Timer used to indicate the end of a SIFS.">endSifs</a>-&gt;isScheduled()) error(<span class="stringliteral">"Mac80211::handleDATAframe when SIFS scheduled"</span>);
<a name="l00510"></a>00510     <a class="code" href="a00086.html#ce80836b6fcb1681f6b2d49466f87fb0" title="Timer used to indicate the end of a SIFS.">endSifs</a>-&gt;setContextPointer(af);
<a name="l00511"></a>00511 
<a name="l00512"></a>00512     <a class="code" href="a00016.html#6d01a0f56978740d7617c2e338858cc3" title="Sends a control message to a lower layer.">sendControlDown</a>(<a class="code" href="a00086.html#ce80836b6fcb1681f6b2d49466f87fb0" title="Timer used to indicate the end of a SIFS.">endSifs</a>);
<a name="l00513"></a>00513     <span class="comment">//scheduleAt(simTime() + SIFS, endSifs);</span>
<a name="l00514"></a>00514 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="0a87fa1791117ef1dd1841ba217e4245"></a><!-- doxytag: member="Mac80211::handleEndContentionTimer" ref="0a87fa1791117ef1dd1841ba217e4245" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Mac80211::handleEndContentionTimer           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Called by the Blackboard whenever a change occurs we're interested in. 
<p>
handle end of contention<p>
The node has won the contention, and is now allowed to send an RTS/DATA or Broadcast packet. The backoff value is deleted and will be newly computed in the next contention period 
<p>Definition at line <a class="el" href="a00434.html#l00585">585</a> of file <a class="el" href="a00434.html">Mac80211.cc</a>.</p>

<p>References <a class="el" href="a00435.html#l00067">CONTEND</a>, <a class="el" href="a00435.html#l00250">contention</a>, <a class="el" href="a00435.html#l00293">fromUpperLayer</a>, <a class="el" href="a00435.html#l00066">IDLE</a>, <a class="el" href="a00435.html#l00290">nextIsBroadcast</a>, <a class="el" href="a00339.html#l00061">BaseMacLayer::phy</a>, <a class="el" href="a00435.html#l00308">remainingBackoff</a>, <a class="el" href="a00435.html#l00179">rtsCts()</a>, <a class="el" href="a00434.html#l00897">sendBROADCASTframe()</a>, <a class="el" href="a00434.html#l00742">sendDATAframe()</a>, <a class="el" href="a00434.html#l00818">sendRTSframe()</a>, <a class="el" href="a00090.html#d25abbad9aa16bdbf24bf1dd582b1c6f">MacToPhyInterface::setRadioState()</a>, <a class="el" href="a00435.html#l00261">state</a>, <a class="el" href="a00434.html#l01127">suspendContention()</a>, and <a class="el" href="a00377.html#l00247">Radio::TX</a>.</p>

<p>Referenced by <a class="el" href="a00434.html#l00244">handleLowerControl()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00586"></a>00586 {
<a name="l00587"></a>00587   <span class="keywordflow">if</span>(!<a class="code" href="a00086.html#7bd4f3adc205b150f9fa406fa582f0b6" title="Used to sense if the channel is idle for contention periods.">contention</a>-&gt;getResult().isIdle()) {
<a name="l00588"></a>00588     <a class="code" href="a00086.html#9ae0815a0e01c4d4fd13a87393f837a8" title="suspend an ongoing contention, pick it up again when the channel becomes idle">suspendContention</a>();
<a name="l00589"></a>00589     <span class="keywordflow">return</span>;
<a name="l00590"></a>00590   }
<a name="l00591"></a>00591 
<a name="l00592"></a>00592     <span class="keywordflow">if</span>(<a class="code" href="a00086.html#56fa75f3eb056ae29b1a4b8da0035d8c" title="Current state of the MAC.">state</a> == <a class="code" href="a00086.html#7ff0b8b49d1a93feae6f808caf5fe4478904ce43407ca530f7fe83d63c558e28">IDLE</a>) {
<a name="l00593"></a>00593         <a class="code" href="a00086.html#58484d1a6f2031548d433d18438042e9" title="remaining backoff time. If the backoff timer is interrupted, this variable holds...">remainingBackoff</a> = 0;
<a name="l00594"></a>00594     }
<a name="l00595"></a>00595     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="a00086.html#56fa75f3eb056ae29b1a4b8da0035d8c" title="Current state of the MAC.">state</a> == <a class="code" href="a00086.html#7ff0b8b49d1a93feae6f808caf5fe447e138f38743ca77f1300a24d4d79786fe">CONTEND</a>) {
<a name="l00596"></a>00596         <span class="comment">// the node has won the channel, the backoff window is deleted and</span>
<a name="l00597"></a>00597         <span class="comment">// will be new calculated in the next contention period</span>
<a name="l00598"></a>00598         <a class="code" href="a00086.html#58484d1a6f2031548d433d18438042e9" title="remaining backoff time. If the backoff timer is interrupted, this variable holds...">remainingBackoff</a> = 0;
<a name="l00599"></a>00599         <span class="comment">// unicast packet</span>
<a name="l00600"></a>00600         <a class="code" href="a00017.html#a7b1e6bdb734765a9f4eff7d486dfbea" title="Handler to the physical layer.">phy</a>-&gt;<a class="code" href="a00090.html#d25abbad9aa16bdbf24bf1dd582b1c6f" title="Tells the BasePhyLayer to switch to the specified radio state.">setRadioState</a>(<a class="code" href="a00112.html#7314de88eaecfa054e682ccc84ef0ffa55eab2480eb0876c6b76dc0df92882f7">Radio::TX</a>);
<a name="l00601"></a>00601         <span class="comment">//OLD: radio-&gt;switchToSend();</span>
<a name="l00602"></a>00602         <span class="keywordflow">if</span> (!<a class="code" href="a00086.html#5d8e9b53c8d6cb0116feed506d843e18" title="Boolean used to know if the next packet is a broadcast packet.">nextIsBroadcast</a>)
<a name="l00603"></a>00603         {
<a name="l00604"></a>00604             <span class="keywordflow">if</span>(<a class="code" href="a00086.html#a316943080d714ffc3c0bf54ea8aeb08" title="Check whether the next packet should be send with RTS/CTS.">rtsCts</a>(<a class="code" href="a00086.html#969e8e3a592dffccea28596c61b2af50" title="Buffering of messages from upper layer.">fromUpperLayer</a>.front())) {
<a name="l00605"></a>00605                 <span class="comment">// send a RTS</span>
<a name="l00606"></a>00606                 <a class="code" href="a00086.html#3104750758ab171b20ffcfeae0079a78" title="send RTS frame">sendRTSframe</a>();
<a name="l00607"></a>00607             }
<a name="l00608"></a>00608             <span class="keywordflow">else</span> {
<a name="l00609"></a>00609                 <a class="code" href="a00086.html#7a4ff22b4b999827a898794923115880" title="send data frame">sendDATAframe</a>(0);
<a name="l00610"></a>00610             }
<a name="l00611"></a>00611         }<span class="comment">// broadcast packet</span>
<a name="l00612"></a>00612         <span class="keywordflow">else</span> {
<a name="l00613"></a>00613             <a class="code" href="a00086.html#26b30d048980b56d79c04e859bfce009" title="send broadcast frame">sendBROADCASTframe</a>();
<a name="l00614"></a>00614             <span class="comment">// removes the packet from the queue without waiting for an acknowledgement</span>
<a name="l00615"></a>00615             Mac80211Pkt *temp = <a class="code" href="a00086.html#969e8e3a592dffccea28596c61b2af50" title="Buffering of messages from upper layer.">fromUpperLayer</a>.front();
<a name="l00616"></a>00616             <a class="code" href="a00086.html#969e8e3a592dffccea28596c61b2af50" title="Buffering of messages from upper layer.">fromUpperLayer</a>.pop_front();
<a name="l00617"></a>00617             <span class="keyword">delete</span>(temp);
<a name="l00618"></a>00618         }
<a name="l00619"></a>00619     }
<a name="l00620"></a>00620     <span class="keywordflow">else</span> {
<a name="l00621"></a>00621         error(<span class="stringliteral">"logic error: expiration of the contention timer outside of CONTEND/IDLE state, should not happen"</span>);
<a name="l00622"></a>00622     }
<a name="l00623"></a>00623 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="7d36a55827a7ea91b2539c86d79349af"></a><!-- doxytag: member="Mac80211::handleEndSifsTimer" ref="7d36a55827a7ea91b2539c86d79349af" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Mac80211::handleEndSifsTimer           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
handle end of SIFS 
<p>
Handle the end sifs timer. Then sends a CTS, a DATA, or an ACK frame 
<p>Definition at line <a class="el" href="a00434.html#l00683">683</a> of file <a class="el" href="a00434.html">Mac80211.cc</a>.</p>

<p>References <a class="el" href="a00435.html#l00067">CONTEND</a>, <a class="el" href="a00435.html#l00047">CTS</a>, <a class="el" href="a00435.html#l00049">DATA</a>, <a class="el" href="a00435.html#l00253">endSifs</a>, <a class="el" href="a00435.html#l00293">fromUpperLayer</a>, <a class="el" href="a00435.html#l00066">IDLE</a>, <a class="el" href="a00339.html#l00061">BaseMacLayer::phy</a>, <a class="el" href="a00435.html#l00046">RTS</a>, <a class="el" href="a00434.html#l00782">sendACKframe()</a>, <a class="el" href="a00434.html#l00860">sendCTSframe()</a>, <a class="el" href="a00434.html#l00742">sendDATAframe()</a>, <a class="el" href="a00090.html#d25abbad9aa16bdbf24bf1dd582b1c6f">MacToPhyInterface::setRadioState()</a>, <a class="el" href="a00434.html#l01118">setState()</a>, and <a class="el" href="a00377.html#l00247">Radio::TX</a>.</p>

<p>Referenced by <a class="el" href="a00434.html#l00244">handleLowerControl()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00684"></a>00684 {
<a name="l00685"></a>00685   <span class="keywordflow">if</span>(!<a class="code" href="a00086.html#ce80836b6fcb1681f6b2d49466f87fb0" title="Timer used to indicate the end of a SIFS.">endSifs</a>-&gt;getResult().isIdle()){
<a name="l00686"></a>00686     <span class="comment">// delete the previously received frame</span>
<a name="l00687"></a>00687     <span class="keyword">delete</span> <span class="keyword">static_cast&lt;</span>Mac80211Pkt *<span class="keyword">&gt;</span>(<a class="code" href="a00086.html#ce80836b6fcb1681f6b2d49466f87fb0" title="Timer used to indicate the end of a SIFS.">endSifs</a>-&gt;getContextPointer());
<a name="l00688"></a>00688 
<a name="l00689"></a>00689     <span class="comment">// state in now IDLE or CONTEND</span>
<a name="l00690"></a>00690     <span class="keywordflow">if</span> (<a class="code" href="a00086.html#969e8e3a592dffccea28596c61b2af50" title="Buffering of messages from upper layer.">fromUpperLayer</a>.empty())
<a name="l00691"></a>00691       <a class="code" href="a00086.html#9fc6eb078e53740d354f8ea7b9d94713" title="Sets the state, and produces a log message in between.">setState</a>(<a class="code" href="a00086.html#7ff0b8b49d1a93feae6f808caf5fe4478904ce43407ca530f7fe83d63c558e28">IDLE</a>);
<a name="l00692"></a>00692     <span class="keywordflow">else</span>
<a name="l00693"></a>00693       <a class="code" href="a00086.html#9fc6eb078e53740d354f8ea7b9d94713" title="Sets the state, and produces a log message in between.">setState</a>(<a class="code" href="a00086.html#7ff0b8b49d1a93feae6f808caf5fe447e138f38743ca77f1300a24d4d79786fe">CONTEND</a>);
<a name="l00694"></a>00694 
<a name="l00695"></a>00695     <span class="keywordflow">return</span>;
<a name="l00696"></a>00696   }
<a name="l00697"></a>00697 
<a name="l00698"></a>00698     Mac80211Pkt *frame = <span class="keyword">static_cast&lt;</span>Mac80211Pkt *<span class="keyword">&gt;</span>(<a class="code" href="a00086.html#ce80836b6fcb1681f6b2d49466f87fb0" title="Timer used to indicate the end of a SIFS.">endSifs</a>-&gt;getContextPointer());
<a name="l00699"></a>00699     <a class="code" href="a00017.html#a7b1e6bdb734765a9f4eff7d486dfbea" title="Handler to the physical layer.">phy</a>-&gt;<a class="code" href="a00090.html#d25abbad9aa16bdbf24bf1dd582b1c6f" title="Tells the BasePhyLayer to switch to the specified radio state.">setRadioState</a>(<a class="code" href="a00112.html#7314de88eaecfa054e682ccc84ef0ffa55eab2480eb0876c6b76dc0df92882f7">Radio::TX</a>);
<a name="l00700"></a>00700     <span class="comment">//OLD: radio-&gt;switchToSend();</span>
<a name="l00701"></a>00701     <span class="keywordflow">switch</span> (frame-&gt;getKind())
<a name="l00702"></a>00702     {
<a name="l00703"></a>00703     <span class="keywordflow">case</span> <a class="code" href="a00086.html#e423db101e8431b0cbd67c347076c44ae37294c092b58bc2b8b13eed3743bbcb">RTS</a>:
<a name="l00704"></a>00704         <a class="code" href="a00086.html#1fd59a589e53facb68c13be84521a49e" title="send CTS frame">sendCTSframe</a>(frame);
<a name="l00705"></a>00705         <span class="keywordflow">break</span>;
<a name="l00706"></a>00706     <span class="keywordflow">case</span> <a class="code" href="a00086.html#e423db101e8431b0cbd67c347076c44a41f567fa1631dfb9583b3521516896a1">CTS</a>:
<a name="l00707"></a>00707         <a class="code" href="a00086.html#7a4ff22b4b999827a898794923115880" title="send data frame">sendDATAframe</a>(frame);
<a name="l00708"></a>00708         <span class="keywordflow">break</span>;
<a name="l00709"></a>00709     <span class="keywordflow">case</span> <a class="code" href="a00086.html#e423db101e8431b0cbd67c347076c44a3e44931a7b0bf9a1f060898544c94467">DATA</a>:
<a name="l00710"></a>00710         <a class="code" href="a00086.html#1c404a5176db493c2fefb71537783607" title="send Acknoledgement">sendACKframe</a>(frame);
<a name="l00711"></a>00711         <span class="keywordflow">break</span>;
<a name="l00712"></a>00712     <span class="keywordflow">default</span>:
<a name="l00713"></a>00713         error(<span class="stringliteral">"logic error: end sifs timer when previously received packet is not RTS/CTS/DATA"</span>);
<a name="l00714"></a>00714     }
<a name="l00715"></a>00715 
<a name="l00716"></a>00716     <span class="comment">// don't need previous frame any more</span>
<a name="l00717"></a>00717     <span class="keyword">delete</span> frame;
<a name="l00718"></a>00718 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="fe4300147d9ea5e4d3e3d8c98ff20436"></a><!-- doxytag: member="Mac80211::handleEndTransmission" ref="fe4300147d9ea5e4d3e3d8c98ff20436" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Mac80211::handleEndTransmission           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
handle the end of a transmission... 
<p>
Handle the end of transmission timer (end of the transmission of an ACK or a broadcast packet). Called by HandleTimer(cMessage* msg) 
<p>Definition at line <a class="el" href="a00434.html#l00725">725</a> of file <a class="el" href="a00434.html">Mac80211.cc</a>.</p>

<p>References <a class="el" href="a00434.html#l00973">backoff()</a>, <a class="el" href="a00434.html#l00924">beginNewCycle()</a>, <a class="el" href="a00435.html#l00070">BUSY</a>, <a class="el" href="a00435.html#l00300">longRetryCounter</a>, <a class="el" href="a00435.html#l00290">nextIsBroadcast</a>, <a class="el" href="a00435.html#l00308">remainingBackoff</a>, <a class="el" href="a00435.html#l00303">shortRetryCounter</a>, and <a class="el" href="a00435.html#l00261">state</a>.</p>

<p>Referenced by <a class="el" href="a00434.html#l00244">handleLowerControl()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00726"></a>00726 {
<a name="l00727"></a>00727     EV &lt;&lt; <span class="stringliteral">"transmission of packet is over\n"</span>;
<a name="l00728"></a>00728     <span class="keywordflow">if</span>(<a class="code" href="a00086.html#56fa75f3eb056ae29b1a4b8da0035d8c" title="Current state of the MAC.">state</a> == <a class="code" href="a00086.html#7ff0b8b49d1a93feae6f808caf5fe447a1070f3c837e8dc4d7890536f7cfbaf9">BUSY</a>) {
<a name="l00729"></a>00729         <span class="keywordflow">if</span>(<a class="code" href="a00086.html#5d8e9b53c8d6cb0116feed506d843e18" title="Boolean used to know if the next packet is a broadcast packet.">nextIsBroadcast</a>) {
<a name="l00730"></a>00730             <a class="code" href="a00086.html#9bbc3d71eddb62c4e12dcd500a58b0bb" title="Number of frame transmission attempt.">shortRetryCounter</a> = 0;
<a name="l00731"></a>00731             <a class="code" href="a00086.html#11fb608b3564e2d2cd41b463b1a8cc90" title="Number of frame transmission attempt.">longRetryCounter</a> = 0;
<a name="l00732"></a>00732             <a class="code" href="a00086.html#58484d1a6f2031548d433d18438042e9" title="remaining backoff time. If the backoff timer is interrupted, this variable holds...">remainingBackoff</a> = <a class="code" href="a00086.html#de2c913df312fd4fc46106c1134889b8" title="Compute a backoff value.">backoff</a>();
<a name="l00733"></a>00733         }
<a name="l00734"></a>00734         <a class="code" href="a00086.html#b3030c86acac78401f877a61cefcdad6" title="start a new contention period">beginNewCycle</a>();
<a name="l00735"></a>00735     }
<a name="l00736"></a>00736 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="41f1a7b86f420e1f840c14badf2b0890"></a><!-- doxytag: member="Mac80211::handleLowerControl" ref="41f1a7b86f420e1f840c14badf2b0890" args="(cMessage *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Mac80211::handleLowerControl           </td>
          <td>(</td>
          <td class="paramtype">cMessage *&nbsp;</td>
          <td class="paramname"> <em>msg</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Handle messages from lower layer. 
<p>

<p>Reimplemented from <a class="el" href="a00017.html#796d456d593dfab3188b37e506dd76a8">BaseMacLayer</a>.</p>

<p>Definition at line <a class="el" href="a00434.html#l00244">244</a> of file <a class="el" href="a00434.html">Mac80211.cc</a>.</p>

<p>References <a class="el" href="a00459.html#l00032">Decider80211::BITERROR</a>, <a class="el" href="a00368.html#l00026">MacToPhyInterface::CHANNEL_SENSE_REQUEST</a>, <a class="el" href="a00459.html#l00033">Decider80211::COLLISION</a>, <a class="el" href="a00435.html#l00250">contention</a>, <a class="el" href="a00435.html#l00313">currentIFS</a>, <a class="el" href="a00475.html#l00059">EIFS</a>, <a class="el" href="a00435.html#l00253">endSifs</a>, <a class="el" href="a00090.html#8447e9cc66ba633aa11a59387cce477c">MacToPhyInterface::getRadioState()</a>, <a class="el" href="a00434.html#l00585">handleEndContentionTimer()</a>, <a class="el" href="a00434.html#l00683">handleEndSifsTimer()</a>, <a class="el" href="a00434.html#l00725">handleEndTransmission()</a>, <a class="el" href="a00434.html#l00327">handleMsgNotForMe()</a>, <a class="el" href="a00339.html#l00061">BaseMacLayer::phy</a>, <a class="el" href="a00368.html#l00024">MacToPhyInterface::RADIO_SWITCHING_OVER</a>, <a class="el" href="a00377.html#l00245">Radio::RX</a>, <a class="el" href="a00090.html#d25abbad9aa16bdbf24bf1dd582b1c6f">MacToPhyInterface::setRadioState()</a>, and <a class="el" href="a00368.html#l00022">MacToPhyInterface::TX_OVER</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00245"></a>00245 {
<a name="l00246"></a>00246     EV &lt;&lt; simTime() &lt;&lt; <span class="stringliteral">" handleLowerControl "</span> &lt;&lt; msg-&gt;getName() &lt;&lt; <span class="stringliteral">"\n"</span>;
<a name="l00247"></a>00247     <span class="keywordflow">switch</span>(msg-&gt;getKind()) {
<a name="l00248"></a>00248     <span class="keywordflow">case</span> <a class="code" href="a00090.html#36bc50a86bf1cc0f9efd374613d61a52a6ff58f5815b155504d37339ee5c7222">MacToPhyInterface::CHANNEL_SENSE_REQUEST</a>:
<a name="l00249"></a>00249       <span class="keywordflow">if</span>(msg == <a class="code" href="a00086.html#7bd4f3adc205b150f9fa406fa582f0b6" title="Used to sense if the channel is idle for contention periods.">contention</a>) {
<a name="l00250"></a>00250         <a class="code" href="a00086.html#0a87fa1791117ef1dd1841ba217e4245" title="Called by the Blackboard whenever a change occurs we&amp;#39;re interested in.">handleEndContentionTimer</a>();
<a name="l00251"></a>00251       } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(msg == <a class="code" href="a00086.html#ce80836b6fcb1681f6b2d49466f87fb0" title="Timer used to indicate the end of a SIFS.">endSifs</a>) {
<a name="l00252"></a>00252         <a class="code" href="a00086.html#7d36a55827a7ea91b2539c86d79349af" title="handle end of SIFS">handleEndSifsTimer</a>();   <span class="comment">// noch zu betrachten</span>
<a name="l00253"></a>00253       } <span class="keywordflow">else</span> {
<a name="l00254"></a>00254         error(<span class="stringliteral">"Unknown ChannelSenseRequest returned!"</span>);
<a name="l00255"></a>00255       }
<a name="l00256"></a>00256         <span class="keywordflow">break</span>;
<a name="l00257"></a>00257 
<a name="l00258"></a>00258     <span class="keywordflow">case</span> <a class="code" href="a00053.html#adf94ce46e3edca3fa4d93150f72f4aee5c2edad30720b7e527373b28bd4e1ab">Decider80211::COLLISION</a>:
<a name="l00259"></a>00259     <span class="keywordflow">case</span> <a class="code" href="a00053.html#adf94ce46e3edca3fa4d93150f72f4aee12bbafd7ed8d0978ac925c1a493aabb">Decider80211::BITERROR</a>:
<a name="l00260"></a>00260     {
<a name="l00261"></a>00261       <span class="keywordtype">int</span> radioState = <a class="code" href="a00017.html#a7b1e6bdb734765a9f4eff7d486dfbea" title="Handler to the physical layer.">phy</a>-&gt;<a class="code" href="a00090.html#8447e9cc66ba633aa11a59387cce477c" title="Returns the current state the radio is in. See RadioState for possible values.">getRadioState</a>();
<a name="l00262"></a>00262         <span class="keywordflow">if</span>(radioState == <a class="code" href="a00112.html#7314de88eaecfa054e682ccc84ef0ffa0a9f9ba2fd83cf0f5f4eaf4f32d6a9c1">Radio::RX</a>) {
<a name="l00263"></a>00263             <span class="keywordflow">if</span> (<a class="code" href="a00086.html#7bd4f3adc205b150f9fa406fa582f0b6" title="Used to sense if the channel is idle for contention periods.">contention</a>-&gt;isScheduled()) {
<a name="l00264"></a>00264                 error(<span class="stringliteral">"Gaack! I am changing the IFS on an ongoing contention"</span>);
<a name="l00265"></a>00265             }
<a name="l00266"></a>00266             <a class="code" href="a00086.html#4a9d1c8d45c46f18afa0f07f5b6572f4" title="current IFS value (DIFS or EIFS) If an error has been detected, the next backoff...">currentIFS</a> = <a class="code" href="a00297.html#55ea8f073a309c4bf3bb331b6a00a28d" title="extended interframe space whenever a corrupted frame is received, defer actions for...">EIFS</a>;
<a name="l00267"></a>00267             <a class="code" href="a00086.html#0c26c2759b2d08601ef21246e1ca6707" title="handle a message that is not for me or errornous">handleMsgNotForMe</a>(msg, 0);
<a name="l00268"></a>00268         }
<a name="l00269"></a>00269         <span class="keywordflow">else</span> {
<a name="l00270"></a>00270             EV &lt;&lt; <span class="stringliteral">" frame "</span> &lt;&lt; msg-&gt;getName() &lt;&lt; <span class="stringliteral">" deleted, strange race condition\n"</span>;
<a name="l00271"></a>00271             <span class="keyword">delete</span> msg;
<a name="l00272"></a>00272         }
<a name="l00273"></a>00273         <span class="keywordflow">break</span>;
<a name="l00274"></a>00274     }
<a name="l00275"></a>00275     <span class="keywordflow">case</span> <a class="code" href="a00090.html#36bc50a86bf1cc0f9efd374613d61a52b00e54021af4a33a84ac61a7543c7528">MacToPhyInterface::TX_OVER</a>:
<a name="l00276"></a>00276         EV &lt;&lt; <span class="stringliteral">"PHY indicated transmission over"</span> &lt;&lt; endl;
<a name="l00277"></a>00277         <a class="code" href="a00017.html#a7b1e6bdb734765a9f4eff7d486dfbea" title="Handler to the physical layer.">phy</a>-&gt;<a class="code" href="a00090.html#d25abbad9aa16bdbf24bf1dd582b1c6f" title="Tells the BasePhyLayer to switch to the specified radio state.">setRadioState</a>(<a class="code" href="a00112.html#7314de88eaecfa054e682ccc84ef0ffa0a9f9ba2fd83cf0f5f4eaf4f32d6a9c1">Radio::RX</a>);
<a name="l00278"></a>00278         <a class="code" href="a00086.html#fe4300147d9ea5e4d3e3d8c98ff20436" title="handle the end of a transmission...">handleEndTransmission</a>();
<a name="l00279"></a>00279         <span class="keyword">delete</span> msg;
<a name="l00280"></a>00280         <span class="keywordflow">break</span>;
<a name="l00281"></a>00281 
<a name="l00282"></a>00282     <span class="keywordflow">case</span> <a class="code" href="a00090.html#36bc50a86bf1cc0f9efd374613d61a52876c7366bd2bcb675b41e60007831d06">MacToPhyInterface::RADIO_SWITCHING_OVER</a>:
<a name="l00283"></a>00283       <span class="comment">//TODO: handle this correctly (by now we assume switch times are zero)</span>
<a name="l00284"></a>00284       <span class="keyword">delete</span> msg;
<a name="l00285"></a>00285       <span class="keywordflow">break</span>;
<a name="l00286"></a>00286 
<a name="l00287"></a>00287     <span class="keywordflow">default</span>:
<a name="l00288"></a>00288       ev &lt;&lt; <span class="stringliteral">"Unhandled control message from physical layer: "</span> &lt;&lt; msg &lt;&lt; endl;
<a name="l00289"></a>00289       <span class="keyword">delete</span> msg;
<a name="l00290"></a>00290     }
<a name="l00291"></a>00291 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="c8bfb04590aab2434bd8d17ee4e213d9"></a><!-- doxytag: member="Mac80211::handleLowerMsg" ref="c8bfb04590aab2434bd8d17ee4e213d9" args="(cMessage *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Mac80211::handleLowerMsg           </td>
          <td>(</td>
          <td class="paramtype">cMessage *&nbsp;</td>
          <td class="paramname"> <em>msg</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Handle messages from lower layer. 
<p>
Handle all messages from lower layer. Checks the destination MAC adress of the packet. Then calls one of the three functions : <a class="el" href="a00086.html#0c26c2759b2d08601ef21246e1ca6707" title="handle a message that is not for me or errornous">handleMsgNotForMe()</a>, <a class="el" href="a00086.html#dfcf8b7a5e1db233a1bd717cecaf49bd">handleBroadcastMsg()</a>, or <a class="el" href="a00086.html#a0b767642d86d3b66f1d3258065fe5ae" title="handle a message that was meant for me">handleMsgForMe()</a>. Called by <a class="el" href="a00016.html#8039dac8d02052c97c1fcc209910fdde" title="Called every time a message arrives.">handleMessage()</a>. 
<p>Reimplemented from <a class="el" href="a00017.html#413375cec02b990a521b62086a02264c">BaseMacLayer</a>.</p>

<p>Definition at line <a class="el" href="a00434.html#l00216">216</a> of file <a class="el" href="a00434.html">Mac80211.cc</a>.</p>

<p>References <a class="el" href="a00434.html#l01191">addNeighbor()</a>, <a class="el" href="a00435.html#l00250">contention</a>, <a class="el" href="a00435.html#l00313">currentIFS</a>, <a class="el" href="a00475.html#l00055">DIFS</a>, <a class="el" href="a00090.html#8447e9cc66ba633aa11a59387cce477c">MacToPhyInterface::getRadioState()</a>, <a class="el" href="a00434.html#l00562">handleBroadcastMsg()</a>, <a class="el" href="a00434.html#l00397">handleMsgForMe()</a>, <a class="el" href="a00434.html#l00327">handleMsgNotForMe()</a>, <a class="el" href="a00404.html#l00032">L2BROADCAST</a>, <a class="el" href="a00435.html#l00237">myMacAddr</a>, <a class="el" href="a00339.html#l00061">BaseMacLayer::phy</a>, and <a class="el" href="a00377.html#l00245">Radio::RX</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00217"></a>00217 {
<a name="l00218"></a>00218     Mac80211Pkt *af = <span class="keyword">static_cast&lt;</span>Mac80211Pkt *<span class="keyword">&gt;</span>(msg);
<a name="l00219"></a>00219     <span class="keywordtype">int</span> radioState = <a class="code" href="a00017.html#a7b1e6bdb734765a9f4eff7d486dfbea" title="Handler to the physical layer.">phy</a>-&gt;<a class="code" href="a00090.html#8447e9cc66ba633aa11a59387cce477c" title="Returns the current state the radio is in. See RadioState for possible values.">getRadioState</a>();
<a name="l00220"></a>00220     <span class="keywordflow">if</span>(radioState == <a class="code" href="a00112.html#7314de88eaecfa054e682ccc84ef0ffa0a9f9ba2fd83cf0f5f4eaf4f32d6a9c1">Radio::RX</a>) {
<a name="l00221"></a>00221         <span class="comment">// end of the reception</span>
<a name="l00222"></a>00222         EV &lt;&lt; <span class="stringliteral">" handleLowerMsg frame "</span> &lt;&lt; af &lt;&lt; <span class="stringliteral">" received\n"</span>;
<a name="l00223"></a>00223         <a class="code" href="a00086.html#8dd543a1a0b89f98af6d39d28dbd9e74" title="add a new entry to the neighbor list">addNeighbor</a>(af);
<a name="l00224"></a>00224         <span class="keywordflow">if</span> (<a class="code" href="a00086.html#7bd4f3adc205b150f9fa406fa582f0b6" title="Used to sense if the channel is idle for contention periods.">contention</a>-&gt;isScheduled()) {
<a name="l00225"></a>00225             error(<span class="stringliteral">"Gaack! I am changing the IFS on an ongoing contention"</span>);
<a name="l00226"></a>00226         }
<a name="l00227"></a>00227         <a class="code" href="a00086.html#4a9d1c8d45c46f18afa0f07f5b6572f4" title="current IFS value (DIFS or EIFS) If an error has been detected, the next backoff...">currentIFS</a> = <a class="code" href="a00297.html#cd77955cde6b5418987a7d26f7f49b9b" title="Distributed interframe space medium must be clear for this time in DCF.">DIFS</a>;
<a name="l00228"></a>00228         <span class="keywordflow">if</span>(af-&gt;getDestAddr() == <a class="code" href="a00086.html#ac2e4050e1e1277556033521e3a296d5" title="MAC address (obtained from arp module).">myMacAddr</a>) {
<a name="l00229"></a>00229             <a class="code" href="a00086.html#a0b767642d86d3b66f1d3258065fe5ae" title="handle a message that was meant for me">handleMsgForMe</a>(af);
<a name="l00230"></a>00230         }
<a name="l00231"></a>00231         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(af-&gt;getDestAddr() == <a class="code" href="a00307.html#gg06fc87d81c62e9abb8790b6e5713c55b7f19df32f2804a6a4898283c48208a80">L2BROADCAST</a>) {
<a name="l00232"></a>00232             <a class="code" href="a00086.html#dfcf8b7a5e1db233a1bd717cecaf49bd">handleBroadcastMsg</a>(af);
<a name="l00233"></a>00233         }
<a name="l00234"></a>00234         <span class="keywordflow">else</span> {
<a name="l00235"></a>00235             <a class="code" href="a00086.html#0c26c2759b2d08601ef21246e1ca6707" title="handle a message that is not for me or errornous">handleMsgNotForMe</a>(af, af-&gt;getDuration());
<a name="l00236"></a>00236         }
<a name="l00237"></a>00237     }
<a name="l00238"></a>00238     <span class="keywordflow">else</span> {
<a name="l00239"></a>00239         EV &lt;&lt; <span class="stringliteral">" handleLowerMsg frame "</span> &lt;&lt; af &lt;&lt; <span class="stringliteral">" deleted, strange race condition\n"</span>;
<a name="l00240"></a>00240         <span class="keyword">delete</span> af;
<a name="l00241"></a>00241     }
<a name="l00242"></a>00242 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="a0b767642d86d3b66f1d3258065fe5ae"></a><!-- doxytag: member="Mac80211::handleMsgForMe" ref="a0b767642d86d3b66f1d3258065fe5ae" args="(Mac80211Pkt *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Mac80211::handleMsgForMe           </td>
          <td>(</td>
          <td class="paramtype">Mac80211Pkt *&nbsp;</td>
          <td class="paramname"> <em>af</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
handle a message that was meant for me 
<p>
Handle a packet for the node. The result of this reception is a function of the type of the received message (RTS,CTS,DATA, or ACK), and of the current state of the MAC (WFDATA, CONTEND, IDLE, WFCTS, or WFACK). Called by <a class="el" href="a00086.html#c8bfb04590aab2434bd8d17ee4e213d9" title="Handle messages from lower layer.">handleLowerMsg()</a> 
<p>Definition at line <a class="el" href="a00434.html#l00397">397</a> of file <a class="el" href="a00434.html">Mac80211.cc</a>.</p>

<p>References <a class="el" href="a00435.html#l00048">ACK</a>, <a class="el" href="a00435.html#l00070">BUSY</a>, <a class="el" href="a00435.html#l00067">CONTEND</a>, <a class="el" href="a00435.html#l00250">contention</a>, <a class="el" href="a00435.html#l00047">CTS</a>, <a class="el" href="a00435.html#l00049">DATA</a>, <a class="el" href="a00434.html#l00520">handleACKframe()</a>, <a class="el" href="a00434.html#l00543">handleCTSframe()</a>, <a class="el" href="a00434.html#l00493">handleDATAframe()</a>, <a class="el" href="a00434.html#l00478">handleRTSframe()</a>, <a class="el" href="a00435.html#l00066">IDLE</a>, <a class="el" href="a00435.html#l00065">QUIET</a>, <a class="el" href="a00435.html#l00046">RTS</a>, <a class="el" href="a00435.html#l00261">state</a>, <a class="el" href="a00434.html#l01100">stateName()</a>, <a class="el" href="a00435.html#l00330">switching</a>, <a class="el" href="a00435.html#l00069">WFACK</a>, <a class="el" href="a00435.html#l00068">WFCTS</a>, and <a class="el" href="a00435.html#l00064">WFDATA</a>.</p>

<p>Referenced by <a class="el" href="a00434.html#l00216">handleLowerMsg()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00398"></a>00398 {
<a name="l00399"></a>00399     EV &lt;&lt; <span class="stringliteral">"handle msg for me "</span> &lt;&lt; af-&gt;getName() &lt;&lt; <span class="stringliteral">" in "</span> &lt;&lt;  <a class="code" href="a00086.html#de8a90e665191333e610b60bad4a32a1" title="Produce a readable name of the given state.">stateName</a>(<a class="code" href="a00086.html#56fa75f3eb056ae29b1a4b8da0035d8c" title="Current state of the MAC.">state</a>) &lt;&lt; <span class="stringliteral">"\n"</span>;
<a name="l00400"></a>00400 
<a name="l00401"></a>00401     <span class="keywordflow">switch</span> (<a class="code" href="a00086.html#56fa75f3eb056ae29b1a4b8da0035d8c" title="Current state of the MAC.">state</a>)
<a name="l00402"></a>00402     {
<a name="l00403"></a>00403     <span class="keywordflow">case</span> <a class="code" href="a00086.html#7ff0b8b49d1a93feae6f808caf5fe4478904ce43407ca530f7fe83d63c558e28">IDLE</a>:     <span class="comment">// waiting for the end of the contention period</span>
<a name="l00404"></a>00404     <span class="keywordflow">case</span> <a class="code" href="a00086.html#7ff0b8b49d1a93feae6f808caf5fe447e138f38743ca77f1300a24d4d79786fe">CONTEND</a>:  <span class="comment">// or waiting for RTS</span>
<a name="l00405"></a>00405 
<a name="l00406"></a>00406         <span class="comment">// RTS or DATA accepted</span>
<a name="l00407"></a>00407         <span class="keywordflow">if</span> (af-&gt;getKind() == <a class="code" href="a00086.html#e423db101e8431b0cbd67c347076c44ae37294c092b58bc2b8b13eed3743bbcb">RTS</a>) {
<a name="l00408"></a>00408           assert(!<a class="code" href="a00086.html#7bd4f3adc205b150f9fa406fa582f0b6" title="Used to sense if the channel is idle for contention periods.">contention</a>-&gt;isScheduled());
<a name="l00409"></a>00409       <span class="comment">//suspendContention();</span>
<a name="l00410"></a>00410 
<a name="l00411"></a>00411             <a class="code" href="a00086.html#98ad0d3935d620b33302e5230b395685">handleRTSframe</a>(af);
<a name="l00412"></a>00412         }
<a name="l00413"></a>00413         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (af-&gt;getKind() == <a class="code" href="a00086.html#e423db101e8431b0cbd67c347076c44a3e44931a7b0bf9a1f060898544c94467">DATA</a>) {
<a name="l00414"></a>00414           assert(!<a class="code" href="a00086.html#7bd4f3adc205b150f9fa406fa582f0b6" title="Used to sense if the channel is idle for contention periods.">contention</a>-&gt;isScheduled());
<a name="l00415"></a>00415           <span class="comment">//suspendContention();</span>
<a name="l00416"></a>00416 
<a name="l00417"></a>00417             <a class="code" href="a00086.html#b0844f9dbcece750c9a58ca9f0a73fe1">handleDATAframe</a>(af);
<a name="l00418"></a>00418         }
<a name="l00419"></a>00419         <span class="keywordflow">else</span> {
<a name="l00420"></a>00420             error(<span class="stringliteral">"in handleMsgForMe() IDLE/CONTEND, strange message %s"</span>, af-&gt;getName());
<a name="l00421"></a>00421         }
<a name="l00422"></a>00422         <span class="keywordflow">break</span>;
<a name="l00423"></a>00423 
<a name="l00424"></a>00424     <span class="keywordflow">case</span> <a class="code" href="a00086.html#7ff0b8b49d1a93feae6f808caf5fe447be0abc1112335ff66c1eef6bd95371e4">WFDATA</a>:  <span class="comment">// waiting for DATA</span>
<a name="l00425"></a>00425         <span class="keywordflow">if</span> (af-&gt;getKind() == <a class="code" href="a00086.html#e423db101e8431b0cbd67c347076c44a3e44931a7b0bf9a1f060898544c94467">DATA</a>) {
<a name="l00426"></a>00426             <a class="code" href="a00086.html#b0844f9dbcece750c9a58ca9f0a73fe1">handleDATAframe</a>(af);
<a name="l00427"></a>00427         }
<a name="l00428"></a>00428         <span class="keywordflow">else</span> {
<a name="l00429"></a>00429             EV &lt;&lt; <span class="stringliteral">"unexpected message -- probably a collision of RTSs\n"</span>;
<a name="l00430"></a>00430             <span class="keyword">delete</span> af;
<a name="l00431"></a>00431         }
<a name="l00432"></a>00432         <span class="keywordflow">break</span>;
<a name="l00433"></a>00433 
<a name="l00434"></a>00434     <span class="keywordflow">case</span> <a class="code" href="a00086.html#7ff0b8b49d1a93feae6f808caf5fe44750a717bfadf9a3fdd634d77950607278">WFACK</a>:  <span class="comment">// waiting for ACK</span>
<a name="l00435"></a>00435         <span class="keywordflow">if</span> (af-&gt;getKind() == <a class="code" href="a00086.html#e423db101e8431b0cbd67c347076c44a6c9256379fe532383569665e6498c0a5">ACK</a>) {
<a name="l00436"></a>00436             <a class="code" href="a00086.html#50cb85360462eb7d256ec8a0b493ca44">handleACKframe</a>(af);
<a name="l00437"></a>00437         }
<a name="l00438"></a>00438         <span class="keywordflow">else</span> {
<a name="l00439"></a>00439             error(<span class="stringliteral">"in handleMsgForMe() WFACK, strange message %s"</span>, af-&gt;getName());
<a name="l00440"></a>00440         }
<a name="l00441"></a>00441         <span class="keyword">delete</span> af;
<a name="l00442"></a>00442         <span class="keywordflow">break</span>;
<a name="l00443"></a>00443 
<a name="l00444"></a>00444     <span class="keywordflow">case</span> <a class="code" href="a00086.html#7ff0b8b49d1a93feae6f808caf5fe447ccc67a0993941984c4f6b49c633c2ad8">WFCTS</a>:  <span class="comment">// The MAC is waiting for CTS</span>
<a name="l00445"></a>00445         <span class="keywordflow">if</span> (af-&gt;getKind() == <a class="code" href="a00086.html#e423db101e8431b0cbd67c347076c44a41f567fa1631dfb9583b3521516896a1">CTS</a>) {
<a name="l00446"></a>00446             <a class="code" href="a00086.html#e1e17af7dddc261d7947d48a1f4d0e21">handleCTSframe</a>(af);
<a name="l00447"></a>00447         }
<a name="l00448"></a>00448         <span class="keywordflow">else</span> {
<a name="l00449"></a>00449             EV &lt;&lt; <span class="stringliteral">"unexpected msg -- deleted \n"</span>;
<a name="l00450"></a>00450             <span class="keyword">delete</span> af;
<a name="l00451"></a>00451         }
<a name="l00452"></a>00452         <span class="keywordflow">break</span>;
<a name="l00453"></a>00453     <span class="keywordflow">case</span> <a class="code" href="a00086.html#7ff0b8b49d1a93feae6f808caf5fe4474cfe7a25808b0e110d662483abec7256">QUIET</a>: <span class="comment">// the node is currently deferring.</span>
<a name="l00454"></a>00454 
<a name="l00455"></a>00455         <span class="comment">// cannot handle any packet with its MAC adress</span>
<a name="l00456"></a>00456         <span class="keyword">delete</span> af;
<a name="l00457"></a>00457         <span class="keywordflow">break</span>;
<a name="l00458"></a>00458 
<a name="l00459"></a>00459     <span class="keywordflow">case</span> <a class="code" href="a00086.html#7ff0b8b49d1a93feae6f808caf5fe447a1070f3c837e8dc4d7890536f7cfbaf9">BUSY</a>: <span class="comment">// currently transmitting an ACK or a BROADCAST packet</span>
<a name="l00460"></a>00460         <span class="keywordflow">if</span>(<a class="code" href="a00086.html#9f9f566e85a76f63e63b5907bf9ad48a">switching</a>) {
<a name="l00461"></a>00461             EV &lt;&lt; <span class="stringliteral">"message received during radio state switchover\n"</span>;
<a name="l00462"></a>00462             <span class="keyword">delete</span> af;
<a name="l00463"></a>00463         }
<a name="l00464"></a>00464         <span class="keywordflow">else</span> {
<a name="l00465"></a>00465             error(<span class="stringliteral">"logic error: node is currently transmitting, can not receive "</span>
<a name="l00466"></a>00466                   <span class="stringliteral">"(does the physical layer do its job correctly?)"</span>);
<a name="l00467"></a>00467         }
<a name="l00468"></a>00468         <span class="keywordflow">break</span>;
<a name="l00469"></a>00469     <span class="keywordflow">default</span>:
<a name="l00470"></a>00470         error(<span class="stringliteral">"unknown state %d"</span>, <a class="code" href="a00086.html#56fa75f3eb056ae29b1a4b8da0035d8c" title="Current state of the MAC.">state</a>);
<a name="l00471"></a>00471     }
<a name="l00472"></a>00472 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="0c26c2759b2d08601ef21246e1ca6707"></a><!-- doxytag: member="Mac80211::handleMsgNotForMe" ref="0c26c2759b2d08601ef21246e1ca6707" args="(cMessage *af, simtime_t duration)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Mac80211::handleMsgNotForMe           </td>
          <td>(</td>
          <td class="paramtype">cMessage *&nbsp;</td>
          <td class="paramname"> <em>af</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">simtime_t&nbsp;</td>
          <td class="paramname"> <em>duration</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
handle a message that is not for me or errornous 
<p>
Handle all ACKs,RTS, CTS, or DATA not for the node. If RTS/CTS is used the node must stay quiet until the current handshake between the two communicating nodes is over. This is done by scheduling the timer message nav (Network Allocation Vector). Without RTS/CTS a new contention is started. If an error occured the node must defer for EIFS. Called by <a class="el" href="a00086.html#c8bfb04590aab2434bd8d17ee4e213d9" title="Handle messages from lower layer.">handleLowerMsg()</a> 
<p>Definition at line <a class="el" href="a00434.html#l00327">327</a> of file <a class="el" href="a00434.html">Mac80211.cc</a>.</p>

<p>References <a class="el" href="a00434.html#l00924">beginNewCycle()</a>, <a class="el" href="a00459.html#l00032">Decider80211::BITERROR</a>, <a class="el" href="a00459.html#l00033">Decider80211::COLLISION</a>, <a class="el" href="a00435.html#l00250">contention</a>, <a class="el" href="a00435.html#l00313">currentIFS</a>, <a class="el" href="a00475.html#l00059">EIFS</a>, <a class="el" href="a00435.html#l00293">fromUpperLayer</a>, <a class="el" href="a00435.html#l00300">longRetryCounter</a>, <a class="el" href="a00435.html#l00247">nav</a>, <a class="el" href="a00435.html#l00065">QUIET</a>, <a class="el" href="a00435.html#l00179">rtsCts()</a>, <a class="el" href="a00434.html#l01118">setState()</a>, <a class="el" href="a00435.html#l00303">shortRetryCounter</a>, <a class="el" href="a00435.html#l00261">state</a>, <a class="el" href="a00435.html#l00243">timeout</a>, <a class="el" href="a00435.html#l00069">WFACK</a>, and <a class="el" href="a00435.html#l00068">WFCTS</a>.</p>

<p>Referenced by <a class="el" href="a00434.html#l00244">handleLowerControl()</a>, and <a class="el" href="a00434.html#l00216">handleLowerMsg()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00328"></a>00328 {
<a name="l00329"></a>00329     EV &lt;&lt; <span class="stringliteral">"handle msg not for me "</span> &lt;&lt; af-&gt;getName() &lt;&lt; <span class="stringliteral">"\n"</span>;
<a name="l00330"></a>00330 
<a name="l00331"></a>00331     <span class="comment">// if the duration of the packet is null, then do nothing (to avoid</span>
<a name="l00332"></a>00332     <span class="comment">// the unuseful scheduling of a self message)</span>
<a name="l00333"></a>00333     <span class="keywordflow">if</span>(duration != 0) {
<a name="l00334"></a>00334         <span class="comment">// the node is already deferring</span>
<a name="l00335"></a>00335         <span class="keywordflow">if</span> (<a class="code" href="a00086.html#56fa75f3eb056ae29b1a4b8da0035d8c" title="Current state of the MAC.">state</a> == <a class="code" href="a00086.html#7ff0b8b49d1a93feae6f808caf5fe4474cfe7a25808b0e110d662483abec7256">QUIET</a>)
<a name="l00336"></a>00336         {
<a name="l00337"></a>00337             <span class="comment">// the current value of the NAV is not sufficient</span>
<a name="l00338"></a>00338             <span class="keywordflow">if</span> (<a class="code" href="a00086.html#35efb0198d0085a341aba515bec9146f" title="Timer used for the defer time of a node. Also called NAV : networks allocation vector...">nav</a>-&gt;getArrivalTime() &lt; simTime() + duration)
<a name="l00339"></a>00339             {
<a name="l00340"></a>00340                 cancelEvent(<a class="code" href="a00086.html#35efb0198d0085a341aba515bec9146f" title="Timer used for the defer time of a node. Also called NAV : networks allocation vector...">nav</a>);
<a name="l00341"></a>00341                 scheduleAt(simTime() + duration, <a class="code" href="a00086.html#35efb0198d0085a341aba515bec9146f" title="Timer used for the defer time of a node. Also called NAV : networks allocation vector...">nav</a>);
<a name="l00342"></a>00342                 EV &lt;&lt; <span class="stringliteral">"NAV timer started for: "</span> &lt;&lt; duration &lt;&lt; <span class="stringliteral">" State QUIET\n"</span>;
<a name="l00343"></a>00343             }
<a name="l00344"></a>00344         }
<a name="l00345"></a>00345         <span class="comment">// other states</span>
<a name="l00346"></a>00346         <span class="keywordflow">else</span>
<a name="l00347"></a>00347         {
<a name="l00348"></a>00348             <span class="comment">// if the MAC wait for another frame, it can delete its time out</span>
<a name="l00349"></a>00349             <span class="comment">// (exchange is aborted)</span>
<a name="l00350"></a>00350             <span class="keywordflow">if</span> (<a class="code" href="a00086.html#2d31f97b0662b8e37f090c3b996cec82" title="Timer used for time-outs after the transmission of a RTS, a CTS, or a DATA packet...">timeout</a>-&gt;isScheduled()) {
<a name="l00351"></a>00351                 cancelEvent(<a class="code" href="a00086.html#2d31f97b0662b8e37f090c3b996cec82" title="Timer used for time-outs after the transmission of a RTS, a CTS, or a DATA packet...">timeout</a>);
<a name="l00352"></a>00352                 <span class="keywordflow">if</span>(<a class="code" href="a00086.html#56fa75f3eb056ae29b1a4b8da0035d8c" title="Current state of the MAC.">state</a> == <a class="code" href="a00086.html#7ff0b8b49d1a93feae6f808caf5fe44750a717bfadf9a3fdd634d77950607278">WFACK</a>) {
<a name="l00353"></a>00353                     <a class="code" href="a00086.html#969e8e3a592dffccea28596c61b2af50" title="Buffering of messages from upper layer.">fromUpperLayer</a>.front()-&gt;setRetry(<span class="keyword">true</span>);
<a name="l00354"></a>00354                 }
<a name="l00355"></a>00355                 <span class="keywordflow">if</span>((<a class="code" href="a00086.html#56fa75f3eb056ae29b1a4b8da0035d8c" title="Current state of the MAC.">state</a> == <a class="code" href="a00086.html#7ff0b8b49d1a93feae6f808caf5fe44750a717bfadf9a3fdd634d77950607278">WFACK</a>) || (<a class="code" href="a00086.html#56fa75f3eb056ae29b1a4b8da0035d8c" title="Current state of the MAC.">state</a> == <a class="code" href="a00086.html#7ff0b8b49d1a93feae6f808caf5fe447ccc67a0993941984c4f6b49c633c2ad8">WFCTS</a>)) {
<a name="l00356"></a>00356                     <span class="keywordflow">if</span>(<a class="code" href="a00086.html#a316943080d714ffc3c0bf54ea8aeb08" title="Check whether the next packet should be send with RTS/CTS.">rtsCts</a>(<a class="code" href="a00086.html#969e8e3a592dffccea28596c61b2af50" title="Buffering of messages from upper layer.">fromUpperLayer</a>.front())) {
<a name="l00357"></a>00357                         <a class="code" href="a00086.html#11fb608b3564e2d2cd41b463b1a8cc90" title="Number of frame transmission attempt.">longRetryCounter</a>++;
<a name="l00358"></a>00358                     }
<a name="l00359"></a>00359                     <span class="keywordflow">else</span> {
<a name="l00360"></a>00360                         <a class="code" href="a00086.html#9bbc3d71eddb62c4e12dcd500a58b0bb" title="Number of frame transmission attempt.">shortRetryCounter</a>++;
<a name="l00361"></a>00361                     }
<a name="l00362"></a>00362                 }
<a name="l00363"></a>00363             }
<a name="l00364"></a>00364             <span class="comment">// the node must defer for the time of the transmission</span>
<a name="l00365"></a>00365             scheduleAt(simTime() + duration, <a class="code" href="a00086.html#35efb0198d0085a341aba515bec9146f" title="Timer used for the defer time of a node. Also called NAV : networks allocation vector...">nav</a>);
<a name="l00366"></a>00366             EV &lt;&lt; <span class="stringliteral">"NAV timer started, not QUIET: "</span> &lt;&lt; duration &lt;&lt; endl;
<a name="l00367"></a>00367 
<a name="l00368"></a>00368             assert(!<a class="code" href="a00086.html#7bd4f3adc205b150f9fa406fa582f0b6" title="Used to sense if the channel is idle for contention periods.">contention</a>-&gt;isScheduled());
<a name="l00369"></a>00369             <span class="comment">//suspendContention();</span>
<a name="l00370"></a>00370 
<a name="l00371"></a>00371             <a class="code" href="a00086.html#9fc6eb078e53740d354f8ea7b9d94713" title="Sets the state, and produces a log message in between.">setState</a>(<a class="code" href="a00086.html#7ff0b8b49d1a93feae6f808caf5fe4474cfe7a25808b0e110d662483abec7256">QUIET</a>);
<a name="l00372"></a>00372         }
<a name="l00373"></a>00373     }
<a name="l00374"></a>00374 
<a name="l00375"></a>00375     <span class="keywordflow">if</span>((af-&gt;getKind() == <a class="code" href="a00053.html#adf94ce46e3edca3fa4d93150f72f4aee12bbafd7ed8d0978ac925c1a493aabb">Decider80211::BITERROR</a>) || (af-&gt;getKind() == <a class="code" href="a00053.html#adf94ce46e3edca3fa4d93150f72f4aee5c2edad30720b7e527373b28bd4e1ab">Decider80211::COLLISION</a>)) {
<a name="l00376"></a>00376 
<a name="l00377"></a>00377       assert(!<a class="code" href="a00086.html#7bd4f3adc205b150f9fa406fa582f0b6" title="Used to sense if the channel is idle for contention periods.">contention</a>-&gt;isScheduled());
<a name="l00378"></a>00378         <span class="comment">//suspendContention();</span>
<a name="l00379"></a>00379         <span class="comment">//if (contention-&gt;isScheduled()) {</span>
<a name="l00380"></a>00380         <span class="comment">//    error("Gaack! I am changing the IFS on an ongoing contention");</span>
<a name="l00381"></a>00381         <span class="comment">//}</span>
<a name="l00382"></a>00382 
<a name="l00383"></a>00383         <a class="code" href="a00086.html#4a9d1c8d45c46f18afa0f07f5b6572f4" title="current IFS value (DIFS or EIFS) If an error has been detected, the next backoff...">currentIFS</a> = <a class="code" href="a00297.html#55ea8f073a309c4bf3bb331b6a00a28d" title="extended interframe space whenever a corrupted frame is received, defer actions for...">EIFS</a>;
<a name="l00384"></a>00384     }
<a name="l00385"></a>00385 
<a name="l00386"></a>00386     <a class="code" href="a00086.html#b3030c86acac78401f877a61cefcdad6" title="start a new contention period">beginNewCycle</a>();
<a name="l00387"></a>00387     <span class="keyword">delete</span> af;
<a name="l00388"></a>00388 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="23a142d65d7a0dcba4a60c0f509ab5b9"></a><!-- doxytag: member="Mac80211::handleNavTimer" ref="23a142d65d7a0dcba4a60c0f509ab5b9" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Mac80211::handleNavTimer           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
NAV timer expired, the exchange of messages of other stations is done. 
<p>
Handle the NAV timer (end of a defering period). Called by HandleTimer(cMessage* msg) 
<p>Definition at line <a class="el" href="a00434.html#l00629">629</a> of file <a class="el" href="a00434.html">Mac80211.cc</a>.</p>

<p>References <a class="el" href="a00434.html#l00924">beginNewCycle()</a>, <a class="el" href="a00435.html#l00065">QUIET</a>, and <a class="el" href="a00435.html#l00261">state</a>.</p>

<p>Referenced by <a class="el" href="a00434.html#l00297">handleSelfMsg()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00630"></a>00630 {
<a name="l00631"></a>00631     <span class="keywordflow">if</span> (<a class="code" href="a00086.html#56fa75f3eb056ae29b1a4b8da0035d8c" title="Current state of the MAC.">state</a> != <a class="code" href="a00086.html#7ff0b8b49d1a93feae6f808caf5fe4474cfe7a25808b0e110d662483abec7256">QUIET</a>)
<a name="l00632"></a>00632         error(<span class="stringliteral">"logic error: expiration of the NAV timer outside of the state QUIET, should not happen"</span>);
<a name="l00633"></a>00633 
<a name="l00634"></a>00634     <span class="comment">// if there's a packet to send and if the channel is free, then start a new contention period</span>
<a name="l00635"></a>00635 
<a name="l00636"></a>00636     <span class="comment">// lmf - Potential race condition: If nav expires at same time</span>
<a name="l00637"></a>00637     <span class="comment">// medium becomes IDLE (usual case), but the navTimeout comes</span>
<a name="l00638"></a>00638     <span class="comment">// before the mediumIndication, then the medium is still BUSY when</span>
<a name="l00639"></a>00639     <span class="comment">// beginNewCycle() is called, so the backoff doesn't resume.</span>
<a name="l00640"></a>00640     <span class="comment">// Usually it doesn't matter, since there is also an arriving</span>
<a name="l00641"></a>00641     <span class="comment">// frame and so beginNewCycle() will be called again by the</span>
<a name="l00642"></a>00642     <span class="comment">// handleMsgXXX.  But if there is no frame (mobility, exposed</span>
<a name="l00643"></a>00643     <span class="comment">// terminal, etc) there's a potential problem.</span>
<a name="l00644"></a>00644 
<a name="l00645"></a>00645     <a class="code" href="a00086.html#b3030c86acac78401f877a61cefcdad6" title="start a new contention period">beginNewCycle</a>();
<a name="l00646"></a>00646 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="98ad0d3935d620b33302e5230b395685"></a><!-- doxytag: member="Mac80211::handleRTSframe" ref="98ad0d3935d620b33302e5230b395685" args="(Mac80211Pkt *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Mac80211::handleRTSframe           </td>
          <td>(</td>
          <td class="paramtype">Mac80211Pkt *&nbsp;</td>
          <td class="paramname"> <em>af</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Handle aframe wich is expected to be an RTS. Called by HandleMsgForMe() 
<p>Definition at line <a class="el" href="a00434.html#l00478">478</a> of file <a class="el" href="a00434.html">Mac80211.cc</a>.</p>

<p>References <a class="el" href="a00435.html#l00253">endSifs</a>, and <a class="el" href="a00336.html#l00123">BaseLayer::sendControlDown()</a>.</p>

<p>Referenced by <a class="el" href="a00434.html#l00397">handleMsgForMe()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00479"></a>00479 {
<a name="l00480"></a>00480     <span class="keywordflow">if</span>(<a class="code" href="a00086.html#ce80836b6fcb1681f6b2d49466f87fb0" title="Timer used to indicate the end of a SIFS.">endSifs</a>-&gt;isScheduled()) error(<span class="stringliteral">"Mac80211::handleRTSframe when SIFS scheduled"</span>);
<a name="l00481"></a>00481     <span class="comment">// wait a short interframe space</span>
<a name="l00482"></a>00482     <a class="code" href="a00086.html#ce80836b6fcb1681f6b2d49466f87fb0" title="Timer used to indicate the end of a SIFS.">endSifs</a>-&gt;setContextPointer(af);
<a name="l00483"></a>00483 
<a name="l00484"></a>00484     <a class="code" href="a00016.html#6d01a0f56978740d7617c2e338858cc3" title="Sends a control message to a lower layer.">sendControlDown</a>(<a class="code" href="a00086.html#ce80836b6fcb1681f6b2d49466f87fb0" title="Timer used to indicate the end of a SIFS.">endSifs</a>);
<a name="l00485"></a>00485     <span class="comment">//scheduleAt(simTime() + SIFS, endSifs);</span>
<a name="l00486"></a>00486 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="990af33f857669759da0cbeebd1c2431"></a><!-- doxytag: member="Mac80211::handleSelfMsg" ref="990af33f857669759da0cbeebd1c2431" args="(cMessage *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Mac80211::handleSelfMsg           </td>
          <td>(</td>
          <td class="paramtype">cMessage *&nbsp;</td>
          <td class="paramname"> <em>msg</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Handle self messages such as timer... 
<p>
handle timers 
<p>Reimplemented from <a class="el" href="a00017.html#95ce03241a7dd66baa693607a74eca07">BaseMacLayer</a>.</p>

<p>Definition at line <a class="el" href="a00434.html#l00297">297</a> of file <a class="el" href="a00434.html">Mac80211.cc</a>.</p>

<p>References <a class="el" href="a00434.html#l00629">handleNavTimer()</a>, <a class="el" href="a00434.html#l00652">handleTimeoutTimer()</a>, <a class="el" href="a00435.html#l00059">NAV</a>, and <a class="el" href="a00435.html#l00058">TIMEOUT</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00298"></a>00298 {
<a name="l00299"></a>00299     EV &lt;&lt; simTime() &lt;&lt; <span class="stringliteral">" handleSelfMsg "</span> &lt;&lt; msg-&gt;getName() &lt;&lt; <span class="stringliteral">"\n"</span>;
<a name="l00300"></a>00300     <span class="keywordflow">switch</span> (msg-&gt;getKind())
<a name="l00301"></a>00301     {
<a name="l00302"></a>00302         <span class="comment">// the MAC was waiting for a CTS, a DATA, or an ACK packet but the timer has expired.</span>
<a name="l00303"></a>00303     <span class="keywordflow">case</span> <a class="code" href="a00086.html#381307739876ed0d015352b95bd93186317269d758fc1f055750d43926abbb2f">TIMEOUT</a>:
<a name="l00304"></a>00304         <a class="code" href="a00086.html#b5fcba8c7a3878ac59195a483ba35a12" title="handle time out">handleTimeoutTimer</a>();   <span class="comment">// noch zu betrachten..</span>
<a name="l00305"></a>00305         <span class="keywordflow">break</span>;
<a name="l00306"></a>00306 
<a name="l00307"></a>00307         <span class="comment">// the MAC was waiting because an other communication had won the channel. This communication is now over</span>
<a name="l00308"></a>00308     <span class="keywordflow">case</span> <a class="code" href="a00086.html#381307739876ed0d015352b95bd93186d2d7f908db1dc3ed72e451dad336d654">NAV</a>:
<a name="l00309"></a>00309         <a class="code" href="a00086.html#23a142d65d7a0dcba4a60c0f509ab5b9" title="NAV timer expired, the exchange of messages of other stations is done.">handleNavTimer</a>();       <span class="comment">// noch zu betrachten...</span>
<a name="l00310"></a>00310         <span class="keywordflow">break</span>;
<a name="l00311"></a>00311 
<a name="l00312"></a>00312     <span class="keywordflow">default</span>:
<a name="l00313"></a>00313         error(<span class="stringliteral">"unknown timer type"</span>);
<a name="l00314"></a>00314     }
<a name="l00315"></a>00315 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="b5fcba8c7a3878ac59195a483ba35a12"></a><!-- doxytag: member="Mac80211::handleTimeoutTimer" ref="b5fcba8c7a3878ac59195a483ba35a12" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Mac80211::handleTimeoutTimer           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
handle time out 
<p>
Handle the time out timer. Called by handleTimer(cMessage* msg) 
<p>Definition at line <a class="el" href="a00434.html#l00652">652</a> of file <a class="el" href="a00434.html">Mac80211.cc</a>.</p>

<p>References <a class="el" href="a00434.html#l00973">backoff()</a>, <a class="el" href="a00434.html#l00924">beginNewCycle()</a>, <a class="el" href="a00435.html#l00293">fromUpperLayer</a>, <a class="el" href="a00435.html#l00300">longRetryCounter</a>, <a class="el" href="a00435.html#l00065">QUIET</a>, <a class="el" href="a00435.html#l00308">remainingBackoff</a>, <a class="el" href="a00435.html#l00179">rtsCts()</a>, <a class="el" href="a00435.html#l00303">shortRetryCounter</a>, <a class="el" href="a00435.html#l00261">state</a>, <a class="el" href="a00434.html#l01100">stateName()</a>, <a class="el" href="a00435.html#l00069">WFACK</a>, and <a class="el" href="a00435.html#l00068">WFCTS</a>.</p>

<p>Referenced by <a class="el" href="a00434.html#l00297">handleSelfMsg()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00653"></a>00653 {
<a name="l00654"></a>00654     <span class="keywordtype">bool</span> rtscts = <span class="keyword">true</span>;
<a name="l00655"></a>00655     EV &lt;&lt; simTime() &lt;&lt; <span class="stringliteral">" handleTimeoutTimer "</span> &lt;&lt; <a class="code" href="a00086.html#de8a90e665191333e610b60bad4a32a1" title="Produce a readable name of the given state.">stateName</a>(<a class="code" href="a00086.html#56fa75f3eb056ae29b1a4b8da0035d8c" title="Current state of the MAC.">state</a>) &lt;&lt; <span class="stringliteral">"\n"</span>;
<a name="l00656"></a>00656     <span class="keywordflow">if</span>(<a class="code" href="a00086.html#56fa75f3eb056ae29b1a4b8da0035d8c" title="Current state of the MAC.">state</a> == <a class="code" href="a00086.html#7ff0b8b49d1a93feae6f808caf5fe447ccc67a0993941984c4f6b49c633c2ad8">WFCTS</a>) {
<a name="l00657"></a>00657         <a class="code" href="a00086.html#11fb608b3564e2d2cd41b463b1a8cc90" title="Number of frame transmission attempt.">longRetryCounter</a>++;
<a name="l00658"></a>00658         <a class="code" href="a00086.html#58484d1a6f2031548d433d18438042e9" title="remaining backoff time. If the backoff timer is interrupted, this variable holds...">remainingBackoff</a> = <a class="code" href="a00086.html#de2c913df312fd4fc46106c1134889b8" title="Compute a backoff value.">backoff</a>();
<a name="l00659"></a>00659     }
<a name="l00660"></a>00660     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="a00086.html#56fa75f3eb056ae29b1a4b8da0035d8c" title="Current state of the MAC.">state</a> == <a class="code" href="a00086.html#7ff0b8b49d1a93feae6f808caf5fe44750a717bfadf9a3fdd634d77950607278">WFACK</a>) {
<a name="l00661"></a>00661         <span class="keywordflow">if</span>(<a class="code" href="a00086.html#a316943080d714ffc3c0bf54ea8aeb08" title="Check whether the next packet should be send with RTS/CTS.">rtsCts</a>(<a class="code" href="a00086.html#969e8e3a592dffccea28596c61b2af50" title="Buffering of messages from upper layer.">fromUpperLayer</a>.front())) {
<a name="l00662"></a>00662             <a class="code" href="a00086.html#11fb608b3564e2d2cd41b463b1a8cc90" title="Number of frame transmission attempt.">longRetryCounter</a>++;
<a name="l00663"></a>00663             <a class="code" href="a00086.html#969e8e3a592dffccea28596c61b2af50" title="Buffering of messages from upper layer.">fromUpperLayer</a>.front()-&gt;setRetry(<span class="keyword">true</span>);
<a name="l00664"></a>00664         }
<a name="l00665"></a>00665         <span class="keywordflow">else</span> {
<a name="l00666"></a>00666             rtscts = <span class="keyword">false</span>;
<a name="l00667"></a>00667             <a class="code" href="a00086.html#9bbc3d71eddb62c4e12dcd500a58b0bb" title="Number of frame transmission attempt.">shortRetryCounter</a>++;
<a name="l00668"></a>00668             <a class="code" href="a00086.html#969e8e3a592dffccea28596c61b2af50" title="Buffering of messages from upper layer.">fromUpperLayer</a>.front()-&gt;setRetry(<span class="keyword">true</span>);
<a name="l00669"></a>00669         }
<a name="l00670"></a>00670         <a class="code" href="a00086.html#58484d1a6f2031548d433d18438042e9" title="remaining backoff time. If the backoff timer is interrupted, this variable holds...">remainingBackoff</a> = <a class="code" href="a00086.html#de2c913df312fd4fc46106c1134889b8" title="Compute a backoff value.">backoff</a>(rtscts);
<a name="l00671"></a>00671     }
<a name="l00672"></a>00672     <span class="comment">// if there's a packet to send and if the channel is free then</span>
<a name="l00673"></a>00673     <span class="comment">// start a new contention period</span>
<a name="l00674"></a>00674     <span class="keywordflow">if</span> (<a class="code" href="a00086.html#56fa75f3eb056ae29b1a4b8da0035d8c" title="Current state of the MAC.">state</a> != <a class="code" href="a00086.html#7ff0b8b49d1a93feae6f808caf5fe4474cfe7a25808b0e110d662483abec7256">QUIET</a>)
<a name="l00675"></a>00675         <a class="code" href="a00086.html#b3030c86acac78401f877a61cefcdad6" title="start a new contention period">beginNewCycle</a>();
<a name="l00676"></a>00676 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="f7e230f8713536482417699f2f6bee71"></a><!-- doxytag: member="Mac80211::handleUpperMsg" ref="f7e230f8713536482417699f2f6bee71" args="(cMessage *msg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Mac80211::handleUpperMsg           </td>
          <td>(</td>
          <td class="paramtype">cMessage *&nbsp;</td>
          <td class="paramname"> <em>msg</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Handle messages from upper layer. 
<p>
This implementation does not support fragmentation, so it is tested if the maximum length of the MPDU is exceeded. 
<p>Reimplemented from <a class="el" href="a00017.html#6de2ca07018de313a7147a03e6d77bff">BaseMacLayer</a>.</p>

<p>Definition at line <a class="el" href="a00434.html#l00135">135</a> of file <a class="el" href="a00434.html">Mac80211.cc</a>.</p>

<p>References <a class="el" href="a00434.html#l00924">beginNewCycle()</a>, <a class="el" href="a00434.html#l00172">encapsMsg()</a>, <a class="el" href="a00435.html#l00253">endSifs</a>, <a class="el" href="a00435.html#l00293">fromUpperLayer</a>, <a class="el" href="a00435.html#l00066">IDLE</a>, <a class="el" href="a00339.html#l00053">BaseMacLayer::PACKET_DROPPED</a>, <a class="el" href="a00435.html#l00287">queueLength</a>, <a class="el" href="a00336.html#l00118">BaseLayer::sendControlUp()</a>, and <a class="el" href="a00435.html#l00261">state</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00136"></a>00136 {
<a name="l00137"></a>00137   cPacket* pkt = <span class="keyword">static_cast&lt;</span>cPacket*<span class="keyword">&gt;</span>(msg);
<a name="l00138"></a>00138 
<a name="l00139"></a>00139     EV &lt;&lt; <span class="stringliteral">"Mac80211::handleUpperMsg "</span> &lt;&lt; msg-&gt;getName() &lt;&lt; <span class="stringliteral">"\n"</span>;
<a name="l00140"></a>00140     <span class="keywordflow">if</span> (pkt-&gt;getBitLength() &gt; 18496){
<a name="l00141"></a>00141         error(<span class="stringliteral">"packet from higher layer (%s)%s is too long for 802.11b, %d bytes (fragmentation is not supported yet)"</span>,
<a name="l00142"></a>00142               pkt-&gt;getClassName(), pkt-&gt;getName(), pkt-&gt;getByteLength());
<a name="l00143"></a>00143     }
<a name="l00144"></a>00144 
<a name="l00145"></a>00145     <span class="keywordflow">if</span>(<a class="code" href="a00086.html#969e8e3a592dffccea28596c61b2af50" title="Buffering of messages from upper layer.">fromUpperLayer</a>.size() == <a class="code" href="a00086.html#e8892c105c3f0fb2b6f28634bb099f31" title="Maximal number of packets in the queue; should be set in the omnetpp.ini.">queueLength</a>) {
<a name="l00146"></a>00146     <span class="comment">//TODO: CSMAMacLayer does create a new mac packet and sends it up. Maybe settle on a consistent solution here</span>
<a name="l00147"></a>00147         msg-&gt;setName(<span class="stringliteral">"MAC ERROR"</span>);
<a name="l00148"></a>00148         msg-&gt;setKind(<a class="code" href="a00017.html#49e0e548a6c20d002bd67afa7b76c483debf9c77bbe6f19772866cccbef0fe4b">PACKET_DROPPED</a>);
<a name="l00149"></a>00149         <a class="code" href="a00016.html#a1190a06fb4dfb15d8ff001468335dc8" title="Sends a control message to an upper layer.">sendControlUp</a>(msg);
<a name="l00150"></a>00150         EV &lt;&lt; <span class="stringliteral">"packet "</span> &lt;&lt; msg &lt;&lt; <span class="stringliteral">" received from higher layer but MAC queue is full, signalling error\n"</span>;
<a name="l00151"></a>00151         <span class="keywordflow">return</span>;
<a name="l00152"></a>00152     }
<a name="l00153"></a>00153 
<a name="l00154"></a>00154     Mac80211Pkt *mac = <a class="code" href="a00086.html#008b57947b7d9287bb34b1e67094ebb8" title="encapsulate packet">encapsMsg</a>(pkt);
<a name="l00155"></a>00155     EV &lt;&lt; <span class="stringliteral">"packet "</span> &lt;&lt; pkt &lt;&lt; <span class="stringliteral">" received from higher layer, dest="</span> &lt;&lt; mac-&gt;getDestAddr() &lt;&lt; <span class="stringliteral">", encapsulated\n"</span>;
<a name="l00156"></a>00156 
<a name="l00157"></a>00157     <a class="code" href="a00086.html#969e8e3a592dffccea28596c61b2af50" title="Buffering of messages from upper layer.">fromUpperLayer</a>.push_back(mac);
<a name="l00158"></a>00158     <span class="comment">// If the MAC is in the IDLE state, then start a new contention period</span>
<a name="l00159"></a>00159     <span class="keywordflow">if</span> (<a class="code" href="a00086.html#56fa75f3eb056ae29b1a4b8da0035d8c" title="Current state of the MAC.">state</a> == <a class="code" href="a00086.html#7ff0b8b49d1a93feae6f808caf5fe4478904ce43407ca530f7fe83d63c558e28">IDLE</a> &amp;&amp; !<a class="code" href="a00086.html#ce80836b6fcb1681f6b2d49466f87fb0" title="Timer used to indicate the end of a SIFS.">endSifs</a>-&gt;isScheduled()) {
<a name="l00160"></a>00160         <a class="code" href="a00086.html#b3030c86acac78401f877a61cefcdad6" title="start a new contention period">beginNewCycle</a>();
<a name="l00161"></a>00161     }
<a name="l00162"></a>00162     <span class="keywordflow">else</span>
<a name="l00163"></a>00163     {
<a name="l00164"></a>00164         EV &lt;&lt; <span class="stringliteral">"enqueued, will be transmitted later\n"</span>;
<a name="l00165"></a>00165     }
<a name="l00166"></a>00166 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="b81dae24d79c2ef010301e2c219966c1"></a><!-- doxytag: member="Mac80211::initialize" ref="b81dae24d79c2ef010301e2c219966c1" args="(int)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Mac80211::initialize           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>stage</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Initialization of the module and some variables. 
<p>
First we have to initialize the module from which we derived ours, in this case <a class="el" href="a00016.html" title="A very simple layer template.">BaseLayer</a>. 
<p>Reimplemented from <a class="el" href="a00017.html#61c82dc3b225eac37f7fa9936c28c2c3">BaseMacLayer</a>.</p>

<p>Definition at line <a class="el" href="a00434.html#l00033">33</a> of file <a class="el" href="a00434.html">Mac80211.cc</a>.</p>

<p>References <a class="el" href="a00435.html#l00232">arp</a>, <a class="el" href="a00435.html#l00281">autoBitrate</a>, <a class="el" href="a00434.html#l00973">backoff()</a>, <a class="el" href="a00435.html#l00277">bitrate</a>, <a class="el" href="a00475.html#l00006">BITRATES_80211</a>, <a class="el" href="a00435.html#l00274">centerFreq</a>, <a class="el" href="a00368.html#l00026">MacToPhyInterface::CHANNEL_SENSE_REQUEST</a>, <a class="el" href="a00435.html#l00250">contention</a>, <a class="el" href="a00435.html#l00313">currentIFS</a>, <a class="el" href="a00397.html#l00141">FWMath::dBm2mW()</a>, <a class="el" href="a00435.html#l00268">defaultBitrate</a>, <a class="el" href="a00435.html#l00320">delta</a>, <a class="el" href="a00475.html#l00055">DIFS</a>, <a class="el" href="a00475.html#l00059">EIFS</a>, <a class="el" href="a00435.html#l00253">endSifs</a>, <a class="el" href="a00435.html#l00333">fsc</a>, <a class="el" href="a00435.html#l00066">IDLE</a>, <a class="el" href="a00435.html#l00300">longRetryCounter</a>, <a class="el" href="a00332.html#l00062">BaseArp::myMacAddr()</a>, <a class="el" href="a00435.html#l00237">myMacAddr</a>, <a class="el" href="a00435.html#l00059">NAV</a>, <a class="el" href="a00435.html#l00247">nav</a>, <a class="el" href="a00435.html#l00325">neighborhoodCacheMaxAge</a>, <a class="el" href="a00435.html#l00323">neighborhoodCacheSize</a>, <a class="el" href="a00435.html#l00287">queueLength</a>, <a class="el" href="a00435.html#l00308">remainingBackoff</a>, <a class="el" href="a00435.html#l00316">rtsCtsThreshold</a>, <a class="el" href="a00434.html#l00120">senseChannelWhileIdle()</a>, <a class="el" href="a00435.html#l00303">shortRetryCounter</a>, <a class="el" href="a00475.html#l00051">SIFS</a>, <a class="el" href="a00435.html#l00283">snrThresholds</a>, <a class="el" href="a00435.html#l00261">state</a>, <a class="el" href="a00435.html#l00330">switching</a>, <a class="el" href="a00435.html#l00058">TIMEOUT</a>, <a class="el" href="a00435.html#l00243">timeout</a>, and <a class="el" href="a00435.html#l00271">txPower</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00034"></a>00034 {
<a name="l00035"></a>00035     <a class="code" href="a00086.html#b81dae24d79c2ef010301e2c219966c1" title="Initialization of the module and some variables.">BaseMacLayer::initialize</a>(stage);
<a name="l00036"></a>00036 
<a name="l00037"></a>00037     <span class="keywordflow">if</span> (stage == 0)
<a name="l00038"></a>00038     {
<a name="l00039"></a>00039         EV &lt;&lt; <span class="stringliteral">"Initializing stage 0\n"</span>;
<a name="l00040"></a>00040 
<a name="l00041"></a>00041         <a class="code" href="a00086.html#93a0c8f9b957d3d4cbf787b0db5438cd" title="Pointer to the arp module.">arp</a> = <a class="code" href="a00006.html" title="Provides access to the hosts ARP module.">BaseArpAccess</a>().get();
<a name="l00042"></a>00042         <a class="code" href="a00086.html#ac2e4050e1e1277556033521e3a296d5" title="MAC address (obtained from arp module).">myMacAddr</a> = <a class="code" href="a00086.html#93a0c8f9b957d3d4cbf787b0db5438cd" title="Pointer to the arp module.">arp</a>-&gt;<a class="code" href="a00005.html#5917debc580744b1a807024720a85f0f" title="Returns the L2 address for the passed mac.">myMacAddr</a>(<span class="keyword">this</span>);
<a name="l00043"></a>00043 
<a name="l00044"></a>00044         <a class="code" href="a00086.html#9f9f566e85a76f63e63b5907bf9ad48a">switching</a> = <span class="keyword">false</span>;
<a name="l00045"></a>00045         <a class="code" href="a00086.html#026837b7167d230bbe79a1e0630c7578">fsc</a> = intrand(0x7FFFFFFF);
<a name="l00046"></a>00046         <span class="keywordflow">if</span>(<a class="code" href="a00086.html#026837b7167d230bbe79a1e0630c7578">fsc</a> == 0) <a class="code" href="a00086.html#026837b7167d230bbe79a1e0630c7578">fsc</a> = 1;
<a name="l00047"></a>00047         EV &lt;&lt; <span class="stringliteral">" fsc: "</span> &lt;&lt; <a class="code" href="a00086.html#026837b7167d230bbe79a1e0630c7578">fsc</a> &lt;&lt; <span class="stringliteral">"\n"</span>;
<a name="l00048"></a>00048 
<a name="l00049"></a>00049         <a class="code" href="a00086.html#e8892c105c3f0fb2b6f28634bb099f31" title="Maximal number of packets in the queue; should be set in the omnetpp.ini.">queueLength</a> = hasPar(<span class="stringliteral">"queueLength"</span>) ? par(<span class="stringliteral">"queueLength"</span>).longValue() : 10;
<a name="l00050"></a>00050 
<a name="l00051"></a>00051         <span class="comment">// timers</span>
<a name="l00052"></a>00052         <a class="code" href="a00086.html#2d31f97b0662b8e37f090c3b996cec82" title="Timer used for time-outs after the transmission of a RTS, a CTS, or a DATA packet...">timeout</a> = <span class="keyword">new</span> cMessage(<span class="stringliteral">"timeout"</span>, <a class="code" href="a00086.html#381307739876ed0d015352b95bd93186317269d758fc1f055750d43926abbb2f">TIMEOUT</a>);
<a name="l00053"></a>00053         <a class="code" href="a00086.html#35efb0198d0085a341aba515bec9146f" title="Timer used for the defer time of a node. Also called NAV : networks allocation vector...">nav</a> = <span class="keyword">new</span> cMessage(<span class="stringliteral">"NAV"</span>, <a class="code" href="a00086.html#381307739876ed0d015352b95bd93186d2d7f908db1dc3ed72e451dad336d654">NAV</a>);
<a name="l00054"></a>00054         <a class="code" href="a00086.html#7bd4f3adc205b150f9fa406fa582f0b6" title="Used to sense if the channel is idle for contention periods.">contention</a> = <span class="keyword">new</span> ChannelSenseRequest(<span class="stringliteral">"contention"</span>, <a class="code" href="a00090.html#36bc50a86bf1cc0f9efd374613d61a52a6ff58f5815b155504d37339ee5c7222">MacToPhyInterface::CHANNEL_SENSE_REQUEST</a>);
<a name="l00055"></a>00055         <a class="code" href="a00086.html#7bd4f3adc205b150f9fa406fa582f0b6" title="Used to sense if the channel is idle for contention periods.">contention</a>-&gt;setSenseMode(UNTIL_BUSY);
<a name="l00056"></a>00056         <a class="code" href="a00086.html#ce80836b6fcb1681f6b2d49466f87fb0" title="Timer used to indicate the end of a SIFS.">endSifs</a> = <span class="keyword">new</span> ChannelSenseRequest(<span class="stringliteral">"end SIFS"</span>, <a class="code" href="a00090.html#36bc50a86bf1cc0f9efd374613d61a52a6ff58f5815b155504d37339ee5c7222">MacToPhyInterface::CHANNEL_SENSE_REQUEST</a>);
<a name="l00057"></a>00057         <a class="code" href="a00086.html#ce80836b6fcb1681f6b2d49466f87fb0" title="Timer used to indicate the end of a SIFS.">endSifs</a>-&gt;setSenseMode(UNTIL_BUSY);
<a name="l00058"></a>00058         <a class="code" href="a00086.html#ce80836b6fcb1681f6b2d49466f87fb0" title="Timer used to indicate the end of a SIFS.">endSifs</a>-&gt;setSenseTimeout(<a class="code" href="a00297.html#51a9ec9ebf3d92c8137776db8f8442c6" title="Short interframe space between DATA and ACK.">SIFS</a>);
<a name="l00059"></a>00059 
<a name="l00060"></a>00060         <a class="code" href="a00086.html#56fa75f3eb056ae29b1a4b8da0035d8c" title="Current state of the MAC.">state</a> = <a class="code" href="a00086.html#7ff0b8b49d1a93feae6f808caf5fe4478904ce43407ca530f7fe83d63c558e28">IDLE</a>;
<a name="l00061"></a>00061         <a class="code" href="a00086.html#11fb608b3564e2d2cd41b463b1a8cc90" title="Number of frame transmission attempt.">longRetryCounter</a> = 0;
<a name="l00062"></a>00062         <a class="code" href="a00086.html#9bbc3d71eddb62c4e12dcd500a58b0bb" title="Number of frame transmission attempt.">shortRetryCounter</a> = 0;
<a name="l00063"></a>00063         <a class="code" href="a00086.html#6ad4dd93415c98c969df05f53d739cfd" title="Number of bits in a packet before RTS/CTS is used.">rtsCtsThreshold</a> = hasPar(<span class="stringliteral">"rtsCtsThreshold"</span>) ? par(<span class="stringliteral">"rtsCtsThreshold"</span>).longValue() : 1;
<a name="l00064"></a>00064         <a class="code" href="a00086.html#4a9d1c8d45c46f18afa0f07f5b6572f4" title="current IFS value (DIFS or EIFS) If an error has been detected, the next backoff...">currentIFS</a> = <a class="code" href="a00297.html#55ea8f073a309c4bf3bb331b6a00a28d" title="extended interframe space whenever a corrupted frame is received, defer actions for...">EIFS</a>;
<a name="l00065"></a>00065 
<a name="l00066"></a>00066         <a class="code" href="a00086.html#979883a8da4b308de4a8e79b5bbbe2e6" title="Auto bit rate adaptation -- switch.">autoBitrate</a> = hasPar(<span class="stringliteral">"autoBitrate"</span>) ? par(<span class="stringliteral">"autoBitrate"</span>).boolValue() : <span class="keyword">false</span>;
<a name="l00067"></a>00067 
<a name="l00068"></a>00068         <a class="code" href="a00086.html#592eee2a24a6fcadd6fdf912a101719f" title="The power at which data is transmitted.">txPower</a> = hasPar(<span class="stringliteral">"txPower"</span>) ? par(<span class="stringliteral">"txPower"</span>).doubleValue() : 110.11;
<a name="l00069"></a>00069         <a class="code" href="a00086.html#67eba657efe23f5e5c21904f4744261d" title="Stores the center frequency the Mac uses.">centerFreq</a> = hasPar(<span class="stringliteral">"centerFrequency"</span>) ? par(<span class="stringliteral">"centerFrequency"</span>).doubleValue() : 2.412e9;
<a name="l00070"></a>00070 
<a name="l00071"></a>00071         <a class="code" href="a00086.html#b9f0ea820748af6d640569fc76f39659" title="Very small value used in timer scheduling in order to avoid multiple changements...">delta</a> = 1E-9;
<a name="l00072"></a>00072 
<a name="l00073"></a>00073         EV &lt;&lt; <span class="stringliteral">"SIFS: "</span> &lt;&lt; <a class="code" href="a00297.html#51a9ec9ebf3d92c8137776db8f8442c6" title="Short interframe space between DATA and ACK.">SIFS</a> &lt;&lt; <span class="stringliteral">" DIFS: "</span> &lt;&lt; <a class="code" href="a00297.html#cd77955cde6b5418987a7d26f7f49b9b" title="Distributed interframe space medium must be clear for this time in DCF.">DIFS</a> &lt;&lt; <span class="stringliteral">" EIFS: "</span> &lt;&lt; <a class="code" href="a00297.html#55ea8f073a309c4bf3bb331b6a00a28d" title="extended interframe space whenever a corrupted frame is received, defer actions for...">EIFS</a> &lt;&lt; endl;
<a name="l00074"></a>00074     }
<a name="l00075"></a>00075     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(stage == 1) {
<a name="l00076"></a>00076       <span class="comment">//TODO: save channel to radio or as member variable!</span>
<a name="l00077"></a>00077       <span class="keywordtype">int</span> channel = hasPar(<span class="stringliteral">"defaultChannel"</span>) ? par(<span class="stringliteral">"defaultChannel"</span>) : 0;
<a name="l00078"></a>00078 
<a name="l00079"></a>00079 
<a name="l00080"></a>00080         <span class="keywordtype">bool</span> found = <span class="keyword">false</span>;
<a name="l00081"></a>00081         <a class="code" href="a00086.html#126c9db5a54bafa6ad74eb3ee24bd936" title="Current bit rate at which data is transmitted.">bitrate</a> = hasPar(<span class="stringliteral">"bitrate"</span>) ? par(<span class="stringliteral">"bitrate"</span>).doubleValue() : <a class="code" href="a00297.html#3e678fe3edd6e7ddf05112025f0362dd" title="Bit rates for 802.11b.">BITRATES_80211</a>[0];
<a name="l00082"></a>00082         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; 4; i++) {
<a name="l00083"></a>00083             <span class="keywordflow">if</span>(<a class="code" href="a00086.html#126c9db5a54bafa6ad74eb3ee24bd936" title="Current bit rate at which data is transmitted.">bitrate</a> == <a class="code" href="a00297.html#3e678fe3edd6e7ddf05112025f0362dd" title="Bit rates for 802.11b.">BITRATES_80211</a>[i]) {
<a name="l00084"></a>00084                 found = <span class="keyword">true</span>;
<a name="l00085"></a>00085                 <span class="keywordflow">break</span>;
<a name="l00086"></a>00086             }
<a name="l00087"></a>00087         }
<a name="l00088"></a>00088         <span class="keywordflow">if</span>(!found) <a class="code" href="a00086.html#126c9db5a54bafa6ad74eb3ee24bd936" title="Current bit rate at which data is transmitted.">bitrate</a> = <a class="code" href="a00297.html#3e678fe3edd6e7ddf05112025f0362dd" title="Bit rates for 802.11b.">BITRATES_80211</a>[0];
<a name="l00089"></a>00089         <a class="code" href="a00086.html#226566e4a56cfed2928acc87ff3af90a" title="Default bitrate.">defaultBitrate</a> = <a class="code" href="a00086.html#126c9db5a54bafa6ad74eb3ee24bd936" title="Current bit rate at which data is transmitted.">bitrate</a>;
<a name="l00090"></a>00090 
<a name="l00091"></a>00091         <a class="code" href="a00086.html#1cd38454a518f922ba57f68d22e2f31e" title="Hold RSSI thresholds at which to change the bitrates.">snrThresholds</a>.push_back(hasPar(<span class="stringliteral">"snr2Mbit"</span>) ? par(<span class="stringliteral">"snr2Mbit"</span>).doubleValue() : 100);
<a name="l00092"></a>00092         <a class="code" href="a00086.html#1cd38454a518f922ba57f68d22e2f31e" title="Hold RSSI thresholds at which to change the bitrates.">snrThresholds</a>.push_back(hasPar(<span class="stringliteral">"snr5Mbit"</span>) ? par(<span class="stringliteral">"snr5Mbit"</span>).doubleValue() : 100);
<a name="l00093"></a>00093         <a class="code" href="a00086.html#1cd38454a518f922ba57f68d22e2f31e" title="Hold RSSI thresholds at which to change the bitrates.">snrThresholds</a>.push_back(hasPar(<span class="stringliteral">"snr11Mbit"</span>) ? par(<span class="stringliteral">"snr11Mbit"</span>).doubleValue() : 100);
<a name="l00094"></a>00094         <a class="code" href="a00086.html#1cd38454a518f922ba57f68d22e2f31e" title="Hold RSSI thresholds at which to change the bitrates.">snrThresholds</a>.push_back(111111111); <span class="comment">// sentinel</span>
<a name="l00095"></a>00095 
<a name="l00096"></a>00096         <a class="code" href="a00086.html#e62ff2c9617e5782f6f7231e36d1574d" title="Keep information for this many neighbors.">neighborhoodCacheSize</a> = hasPar(<span class="stringliteral">"neighborhoodCacheSize"</span>) ? par(<span class="stringliteral">"neighborhoodCacheSize"</span>).longValue() : 0;
<a name="l00097"></a>00097         <a class="code" href="a00086.html#ede2e9e4e32ef871e3a59c51564123de" title="Consider information in cache outdate if it is older than this.">neighborhoodCacheMaxAge</a> = hasPar(<span class="stringliteral">"neighborhoodCacheMaxAge"</span>) ? par(<span class="stringliteral">"neighborhoodCacheMaxAge"</span>).longValue() : 10000;
<a name="l00098"></a>00098 
<a name="l00099"></a>00099         EV &lt;&lt; <span class="stringliteral">" MAC Address: "</span> &lt;&lt; <a class="code" href="a00086.html#ac2e4050e1e1277556033521e3a296d5" title="MAC address (obtained from arp module).">myMacAddr</a>
<a name="l00100"></a>00100            &lt;&lt; <span class="stringliteral">" rtsCtsThreshold: "</span> &lt;&lt; <a class="code" href="a00086.html#6ad4dd93415c98c969df05f53d739cfd" title="Number of bits in a packet before RTS/CTS is used.">rtsCtsThreshold</a>
<a name="l00101"></a>00101            &lt;&lt; <span class="stringliteral">" bitrate: "</span> &lt;&lt; <a class="code" href="a00086.html#126c9db5a54bafa6ad74eb3ee24bd936" title="Current bit rate at which data is transmitted.">bitrate</a>
<a name="l00102"></a>00102            &lt;&lt; <span class="stringliteral">" channel: "</span> &lt;&lt; channel
<a name="l00103"></a>00103            &lt;&lt; <span class="stringliteral">" autoBitrate: "</span> &lt;&lt; <a class="code" href="a00086.html#979883a8da4b308de4a8e79b5bbbe2e6" title="Auto bit rate adaptation -- switch.">autoBitrate</a>
<a name="l00104"></a>00104            &lt;&lt; <span class="stringliteral">" 2MBit: "</span> &lt;&lt; <a class="code" href="a00086.html#1cd38454a518f922ba57f68d22e2f31e" title="Hold RSSI thresholds at which to change the bitrates.">snrThresholds</a>[0]
<a name="l00105"></a>00105            &lt;&lt; <span class="stringliteral">" 5.5MBit: "</span> &lt;&lt;<a class="code" href="a00086.html#1cd38454a518f922ba57f68d22e2f31e" title="Hold RSSI thresholds at which to change the bitrates.">snrThresholds</a>[1]
<a name="l00106"></a>00106            &lt;&lt; <span class="stringliteral">" 11MBit: "</span> &lt;&lt; <a class="code" href="a00086.html#1cd38454a518f922ba57f68d22e2f31e" title="Hold RSSI thresholds at which to change the bitrates.">snrThresholds</a>[2]
<a name="l00107"></a>00107            &lt;&lt; <span class="stringliteral">" neighborhoodCacheSize "</span> &lt;&lt; <a class="code" href="a00086.html#e62ff2c9617e5782f6f7231e36d1574d" title="Keep information for this many neighbors.">neighborhoodCacheSize</a>
<a name="l00108"></a>00108            &lt;&lt; <span class="stringliteral">" neighborhoodCacheMaxAge "</span> &lt;&lt; <a class="code" href="a00086.html#ede2e9e4e32ef871e3a59c51564123de" title="Consider information in cache outdate if it is older than this.">neighborhoodCacheMaxAge</a>
<a name="l00109"></a>00109            &lt;&lt; endl;
<a name="l00110"></a>00110 
<a name="l00111"></a>00111         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; 3; i++) {
<a name="l00112"></a>00112             <a class="code" href="a00086.html#1cd38454a518f922ba57f68d22e2f31e" title="Hold RSSI thresholds at which to change the bitrates.">snrThresholds</a>[i] = <a class="code" href="a00069.html#f308407856d9835b103f2421e373ee28">FWMath::dBm2mW</a>(<a class="code" href="a00086.html#1cd38454a518f922ba57f68d22e2f31e" title="Hold RSSI thresholds at which to change the bitrates.">snrThresholds</a>[i]);
<a name="l00113"></a>00113         }
<a name="l00114"></a>00114 
<a name="l00115"></a>00115         <a class="code" href="a00086.html#58484d1a6f2031548d433d18438042e9" title="remaining backoff time. If the backoff timer is interrupted, this variable holds...">remainingBackoff</a> = <a class="code" href="a00086.html#de2c913df312fd4fc46106c1134889b8" title="Compute a backoff value.">backoff</a>();
<a name="l00116"></a>00116         <a class="code" href="a00086.html#be230265b97330ce9946e4c336b4761c" title="Starts a channel sense request which sense the channel for the passed duration or...">senseChannelWhileIdle</a>(<a class="code" href="a00086.html#58484d1a6f2031548d433d18438042e9" title="remaining backoff time. If the backoff timer is interrupted, this variable holds...">remainingBackoff</a> + <a class="code" href="a00086.html#4a9d1c8d45c46f18afa0f07f5b6572f4" title="current IFS value (DIFS or EIFS) If an error has been detected, the next backoff...">currentIFS</a>);
<a name="l00117"></a>00117     }
<a name="l00118"></a>00118 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="6732e4a776e78432bf5dd9dd26de2f7d"></a><!-- doxytag: member="Mac80211::packetDuration" ref="6732e4a776e78432bf5dd9dd26de2f7d" args="(double bits, double br)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">simtime_t Mac80211::packetDuration           </td>
          <td>(</td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>bits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>br</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
computes the duration of a transmission over the physical channel, given a certain bitrate 
<p>
Computes the duration of the transmission of a frame over the physical channel. 'bits' should be the total length of the mac packet in bits excluding the phy header length. 
<p>Definition at line <a class="el" href="a00434.html#l01095">1095</a> of file <a class="el" href="a00434.html">Mac80211.cc</a>.</p>

<p>References <a class="el" href="a00475.html#l00028">BITRATE_HEADER</a>, and <a class="el" href="a00475.html#l00024">PHY_HEADER_LENGTH</a>.</p>

<p>Referenced by <a class="el" href="a00434.html#l00782">sendACKframe()</a>, <a class="el" href="a00434.html#l00897">sendBROADCASTframe()</a>, <a class="el" href="a00434.html#l00860">sendCTSframe()</a>, <a class="el" href="a00434.html#l00742">sendDATAframe()</a>, <a class="el" href="a00434.html#l00818">sendRTSframe()</a>, and <a class="el" href="a00434.html#l01070">timeOut()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l01096"></a>01096 {
<a name="l01097"></a>01097     <span class="keywordflow">return</span> bits / br + <a class="code" href="a00297.html#1be276497de806411e2c5cc3b8d5d08b" title="Length of PLCP header and Preamble.">PHY_HEADER_LENGTH</a> / <a class="code" href="a00297.html#0454abde1a622bc79c2528d728e466ef" title="Bitrate with which the header is send.">BITRATE_HEADER</a>;
<a name="l01098"></a>01098 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="386da37d596d50ddae0c2bb3ade102e6"></a><!-- doxytag: member="Mac80211::retrieveBitrate" ref="386da37d596d50ddae0c2bb3ade102e6" args="(int destAddress)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double Mac80211::retrieveBitrate           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>destAddress</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
figure out at which bitrate to send to this particular destination 
<p>

<p>Definition at line <a class="el" href="a00434.html#l01178">1178</a> of file <a class="el" href="a00434.html">Mac80211.cc</a>.</p>

<p>References <a class="el" href="a00435.html#l00281">autoBitrate</a>, <a class="el" href="a00435.html#l00277">bitrate</a>, <a class="el" href="a00435.html#l00268">defaultBitrate</a>, <a class="el" href="a00435.html#l00193">findNeighbor()</a>, <a class="el" href="a00404.html#l00032">L2BROADCAST</a>, <a class="el" href="a00435.html#l00300">longRetryCounter</a>, <a class="el" href="a00435.html#l00325">neighborhoodCacheMaxAge</a>, <a class="el" href="a00435.html#l00327">neighbors</a>, and <a class="el" href="a00435.html#l00303">shortRetryCounter</a>.</p>

<p>Referenced by <a class="el" href="a00434.html#l00897">sendBROADCASTframe()</a>, <a class="el" href="a00434.html#l00742">sendDATAframe()</a>, and <a class="el" href="a00434.html#l00818">sendRTSframe()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l01178"></a>01178                                                 {
<a name="l01179"></a>01179     <span class="keywordtype">double</span> <a class="code" href="a00086.html#126c9db5a54bafa6ad74eb3ee24bd936" title="Current bit rate at which data is transmitted.">bitrate</a> = <a class="code" href="a00086.html#226566e4a56cfed2928acc87ff3af90a" title="Default bitrate.">defaultBitrate</a>;
<a name="l01180"></a>01180     NeighborList::iterator it;
<a name="l01181"></a>01181     <span class="keywordflow">if</span>(<a class="code" href="a00086.html#979883a8da4b308de4a8e79b5bbbe2e6" title="Auto bit rate adaptation -- switch.">autoBitrate</a> &amp;&amp; (destAddress != <a class="code" href="a00307.html#gg06fc87d81c62e9abb8790b6e5713c55b7f19df32f2804a6a4898283c48208a80">L2BROADCAST</a>) &amp;&amp;
<a name="l01182"></a>01182        (<a class="code" href="a00086.html#11fb608b3564e2d2cd41b463b1a8cc90" title="Number of frame transmission attempt.">longRetryCounter</a> == 0) &amp;&amp; (<a class="code" href="a00086.html#9bbc3d71eddb62c4e12dcd500a58b0bb" title="Number of frame transmission attempt.">shortRetryCounter</a> == 0)) {
<a name="l01183"></a>01183         it = <a class="code" href="a00086.html#3d2c968c5117f491281ddd54f83a7ee5" title="find a neighbor based on his address">findNeighbor</a>(destAddress);
<a name="l01184"></a>01184         <span class="keywordflow">if</span>((it != <a class="code" href="a00086.html#4caf1f3c2c004851555c9c691b82edf9">neighbors</a>.end()) &amp;&amp; (it-&gt;age &gt; (simTime() - <a class="code" href="a00086.html#ede2e9e4e32ef871e3a59c51564123de" title="Consider information in cache outdate if it is older than this.">neighborhoodCacheMaxAge</a>))) {
<a name="l01185"></a>01185             bitrate = it-&gt;bitrate;
<a name="l01186"></a>01186         }
<a name="l01187"></a>01187     }
<a name="l01188"></a>01188     <span class="keywordflow">return</span> bitrate;
<a name="l01189"></a>01189 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="a316943080d714ffc3c0bf54ea8aeb08"></a><!-- doxytag: member="Mac80211::rtsCts" ref="a316943080d714ffc3c0bf54ea8aeb08" args="(Mac80211Pkt *m)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool Mac80211::rtsCts           </td>
          <td>(</td>
          <td class="paramtype">Mac80211Pkt *&nbsp;</td>
          <td class="paramname"> <em>m</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Check whether the next packet should be send with RTS/CTS. 
<p>

<p>Definition at line <a class="el" href="a00435.html#l00179">179</a> of file <a class="el" href="a00435.html">Mac80211.h</a>.</p>

<p>References <a class="el" href="a00475.html#l00040">MAC80211_HEADER_LENGTH</a>, and <a class="el" href="a00435.html#l00316">rtsCtsThreshold</a>.</p>

<p>Referenced by <a class="el" href="a00434.html#l00493">handleDATAframe()</a>, <a class="el" href="a00434.html#l00585">handleEndContentionTimer()</a>, <a class="el" href="a00434.html#l00327">handleMsgNotForMe()</a>, and <a class="el" href="a00434.html#l00652">handleTimeoutTimer()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00179"></a>00179                                 {
<a name="l00180"></a>00180         <span class="keywordflow">return</span> m-&gt;getBitLength() - <a class="code" href="a00297.html#7e14c9f344489ba48f9f6ad1ee865e19">MAC80211_HEADER_LENGTH</a> &gt; <a class="code" href="a00086.html#6ad4dd93415c98c969df05f53d739cfd" title="Number of bits in a packet before RTS/CTS is used.">rtsCtsThreshold</a>;
<a name="l00181"></a>00181     }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="1c404a5176db493c2fefb71537783607"></a><!-- doxytag: member="Mac80211::sendACKframe" ref="1c404a5176db493c2fefb71537783607" args="(Mac80211Pkt *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Mac80211::sendACKframe           </td>
          <td>(</td>
          <td class="paramtype">Mac80211Pkt *&nbsp;</td>
          <td class="paramname"> <em>af</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
send Acknoledgement 
<p>
Send an ACK frame.Called by HandleEndSifsTimer() 
<p>Definition at line <a class="el" href="a00434.html#l00782">782</a> of file <a class="el" href="a00434.html">Mac80211.cc</a>.</p>

<p>References <a class="el" href="a00435.html#l00048">ACK</a>, <a class="el" href="a00435.html#l00070">BUSY</a>, <a class="el" href="a00434.html#l01004">createSignal()</a>, <a class="el" href="a00375.html#l00040">PhyToMacControlInfo::getDeciderResult()</a>, <a class="el" href="a00475.html#l00038">LENGTH_ACK</a>, <a class="el" href="a00435.html#l00237">myMacAddr</a>, <a class="el" href="a00434.html#l01095">packetDuration()</a>, <a class="el" href="a00336.html#l00108">BaseLayer::sendDown()</a>, <a class="el" href="a00434.html#l01118">setState()</a>, and <a class="el" href="a00435.html#l00271">txPower</a>.</p>

<p>Referenced by <a class="el" href="a00434.html#l00683">handleEndSifsTimer()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00783"></a>00783 {
<a name="l00784"></a>00784     Mac80211Pkt *frame = <span class="keyword">new</span> Mac80211Pkt(<span class="stringliteral">"wlan-ack"</span>);
<a name="l00785"></a>00785 
<a name="l00786"></a>00786     <a class="code" href="a00111.html" title="Controlinfo for packets which are send from Physical layer to the MAC layer.">PhyToMacControlInfo</a>* phyCtrlInfo = <span class="keyword">static_cast&lt;</span><a class="code" href="a00111.html" title="Controlinfo for packets which are send from Physical layer to the MAC layer.">PhyToMacControlInfo</a>*<span class="keyword">&gt;</span>(af-&gt;removeControlInfo());
<a name="l00787"></a>00787     <span class="keywordtype">double</span> br = <span class="keyword">static_cast&lt;</span><span class="keyword">const </span><a class="code" href="a00056.html" title="Defines an extended DeciderResult for the 80211 protocol which stores the bit-rate...">DeciderResult80211</a>*<span class="keyword">&gt;</span>(phyCtrlInfo-&gt;<a class="code" href="a00111.html#0a8f38d6c909e129752f88c8f1377e8f" title="Returns the result of the evaluation of the Decider.">getDeciderResult</a>())-&gt;getBitrate();
<a name="l00788"></a>00788     <span class="keyword">delete</span> phyCtrlInfo;
<a name="l00789"></a>00789     phyCtrlInfo = 0;
<a name="l00790"></a>00790 
<a name="l00791"></a>00791     <a class="code" href="a00124.html" title="The signal class stores the physical representation of the signal of an AirFrame...">Signal</a>* signal = <a class="code" href="a00086.html#f3931f437864a565081885eba81b6019" title="Creates the signal to be used for a packet to be sent.">createSignal</a>(simTime(),
<a name="l00792"></a>00792                   <a class="code" href="a00086.html#6732e4a776e78432bf5dd9dd26de2f7d" title="computes the duration of a transmission over the physical channel, given a certain...">packetDuration</a>(<a class="code" href="a00297.html#2cfa720fa65b7858c072e2f274f3cd55">LENGTH_ACK</a>, br),
<a name="l00793"></a>00793                   <a class="code" href="a00086.html#592eee2a24a6fcadd6fdf912a101719f" title="The power at which data is transmitted.">txPower</a>, br);
<a name="l00794"></a>00794 
<a name="l00795"></a>00795     <a class="code" href="a00089.html" title="Stores information which is needed by the physical layer when sending a MacPkt.">MacToPhyControlInfo</a> *pco = <span class="keyword">new</span> <a class="code" href="a00089.html" title="Stores information which is needed by the physical layer when sending a MacPkt.">MacToPhyControlInfo</a>(signal);
<a name="l00796"></a>00796 
<a name="l00797"></a>00797     frame-&gt;setControlInfo(pco);
<a name="l00798"></a>00798     frame-&gt;setKind(<a class="code" href="a00086.html#e423db101e8431b0cbd67c347076c44a6c9256379fe532383569665e6498c0a5">ACK</a>);
<a name="l00799"></a>00799     frame-&gt;setBitLength((<span class="keywordtype">int</span>)<a class="code" href="a00297.html#2cfa720fa65b7858c072e2f274f3cd55">LENGTH_ACK</a>);
<a name="l00800"></a>00800 
<a name="l00801"></a>00801     <span class="comment">// the dest address must be the src adress of the RTS or the DATA</span>
<a name="l00802"></a>00802     <span class="comment">// packet received. The src adress is the adress of the node</span>
<a name="l00803"></a>00803     frame-&gt;setSrcAddr(<a class="code" href="a00086.html#ac2e4050e1e1277556033521e3a296d5" title="MAC address (obtained from arp module).">myMacAddr</a>);
<a name="l00804"></a>00804     frame-&gt;setDestAddr(af-&gt;getSrcAddr());
<a name="l00805"></a>00805     frame-&gt;setDuration(0);
<a name="l00806"></a>00806 
<a name="l00807"></a>00807     <a class="code" href="a00016.html#1873d6e3fc6d92cf8482b39f1c5ac6c8" title="Sends a message to the lower layer.">sendDown</a>(frame);
<a name="l00808"></a>00808     EV &lt;&lt; <span class="stringliteral">"sent ACK frame!\n"</span>;
<a name="l00809"></a>00809 
<a name="l00810"></a>00810     <span class="comment">// update state and display</span>
<a name="l00811"></a>00811     <a class="code" href="a00086.html#9fc6eb078e53740d354f8ea7b9d94713" title="Sets the state, and produces a log message in between.">setState</a>(<a class="code" href="a00086.html#7ff0b8b49d1a93feae6f808caf5fe447a1070f3c837e8dc4d7890536f7cfbaf9">BUSY</a>);
<a name="l00812"></a>00812 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="26b30d048980b56d79c04e859bfce009"></a><!-- doxytag: member="Mac80211::sendBROADCASTframe" ref="26b30d048980b56d79c04e859bfce009" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Mac80211::sendBROADCASTframe           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
send broadcast frame 
<p>
Send a BROADCAST frame.Called by handleContentionTimer() 
<p>Definition at line <a class="el" href="a00434.html#l00897">897</a> of file <a class="el" href="a00434.html">Mac80211.cc</a>.</p>

<p>References <a class="el" href="a00435.html#l00050">BROADCAST</a>, <a class="el" href="a00435.html#l00070">BUSY</a>, <a class="el" href="a00434.html#l01004">createSignal()</a>, <a class="el" href="a00435.html#l00293">fromUpperLayer</a>, <a class="el" href="a00434.html#l01095">packetDuration()</a>, <a class="el" href="a00434.html#l01178">retrieveBitrate()</a>, <a class="el" href="a00336.html#l00108">BaseLayer::sendDown()</a>, <a class="el" href="a00434.html#l01118">setState()</a>, and <a class="el" href="a00435.html#l00271">txPower</a>.</p>

<p>Referenced by <a class="el" href="a00434.html#l00585">handleEndContentionTimer()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00898"></a>00898 {
<a name="l00899"></a>00899     <span class="comment">// send a copy of the frame in front of the queue</span>
<a name="l00900"></a>00900     Mac80211Pkt *frame = <span class="keyword">static_cast&lt;</span>Mac80211Pkt *<span class="keyword">&gt;</span>(<a class="code" href="a00086.html#969e8e3a592dffccea28596c61b2af50" title="Buffering of messages from upper layer.">fromUpperLayer</a>.front()-&gt;dup());
<a name="l00901"></a>00901 
<a name="l00902"></a>00902     <span class="keywordtype">double</span> br = <a class="code" href="a00086.html#386da37d596d50ddae0c2bb3ade102e6" title="figure out at which bitrate to send to this particular destination">retrieveBitrate</a>(frame-&gt;getDestAddr());
<a name="l00903"></a>00903 
<a name="l00904"></a>00904     simtime_t duration = <a class="code" href="a00086.html#6732e4a776e78432bf5dd9dd26de2f7d" title="computes the duration of a transmission over the physical channel, given a certain...">packetDuration</a>(frame-&gt;getBitLength(), br);
<a name="l00905"></a>00905     <a class="code" href="a00124.html" title="The signal class stores the physical representation of the signal of an AirFrame...">Signal</a>* signal = <a class="code" href="a00086.html#f3931f437864a565081885eba81b6019" title="Creates the signal to be used for a packet to be sent.">createSignal</a>(simTime(), duration, <a class="code" href="a00086.html#592eee2a24a6fcadd6fdf912a101719f" title="The power at which data is transmitted.">txPower</a>, br);
<a name="l00906"></a>00906 
<a name="l00907"></a>00907     <a class="code" href="a00089.html" title="Stores information which is needed by the physical layer when sending a MacPkt.">MacToPhyControlInfo</a> *pco = <span class="keyword">new</span> <a class="code" href="a00089.html" title="Stores information which is needed by the physical layer when sending a MacPkt.">MacToPhyControlInfo</a>(signal);
<a name="l00908"></a>00908 
<a name="l00909"></a>00909     frame-&gt;setControlInfo(pco);
<a name="l00910"></a>00910     frame-&gt;setKind(<a class="code" href="a00086.html#e423db101e8431b0cbd67c347076c44a9b73e5611a23fbbe50ae68325164a9a9">BROADCAST</a>);
<a name="l00911"></a>00911 
<a name="l00912"></a>00912     <a class="code" href="a00016.html#1873d6e3fc6d92cf8482b39f1c5ac6c8" title="Sends a message to the lower layer.">sendDown</a>(frame);
<a name="l00913"></a>00913     <span class="comment">// update state and display</span>
<a name="l00914"></a>00914     <a class="code" href="a00086.html#9fc6eb078e53740d354f8ea7b9d94713" title="Sets the state, and produces a log message in between.">setState</a>(<a class="code" href="a00086.html#7ff0b8b49d1a93feae6f808caf5fe447a1070f3c837e8dc4d7890536f7cfbaf9">BUSY</a>);
<a name="l00915"></a>00915 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="1fd59a589e53facb68c13be84521a49e"></a><!-- doxytag: member="Mac80211::sendCTSframe" ref="1fd59a589e53facb68c13be84521a49e" args="(Mac80211Pkt *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Mac80211::sendCTSframe           </td>
          <td>(</td>
          <td class="paramtype">Mac80211Pkt *&nbsp;</td>
          <td class="paramname"> <em>af</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
send CTS frame 
<p>
Send a CTS frame.Called by HandleEndSifsTimer() 
<p>Definition at line <a class="el" href="a00434.html#l00860">860</a> of file <a class="el" href="a00434.html">Mac80211.cc</a>.</p>

<p>References <a class="el" href="a00434.html#l01004">createSignal()</a>, <a class="el" href="a00435.html#l00047">CTS</a>, <a class="el" href="a00435.html#l00320">delta</a>, <a class="el" href="a00375.html#l00040">PhyToMacControlInfo::getDeciderResult()</a>, <a class="el" href="a00475.html#l00038">LENGTH_ACK</a>, <a class="el" href="a00475.html#l00037">LENGTH_CTS</a>, <a class="el" href="a00435.html#l00237">myMacAddr</a>, <a class="el" href="a00434.html#l01095">packetDuration()</a>, <a class="el" href="a00336.html#l00108">BaseLayer::sendDown()</a>, <a class="el" href="a00434.html#l01118">setState()</a>, <a class="el" href="a00475.html#l00051">SIFS</a>, <a class="el" href="a00435.html#l00243">timeout</a>, <a class="el" href="a00435.html#l00271">txPower</a>, and <a class="el" href="a00435.html#l00064">WFDATA</a>.</p>

<p>Referenced by <a class="el" href="a00434.html#l00683">handleEndSifsTimer()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00861"></a>00861 {
<a name="l00862"></a>00862     Mac80211Pkt *frame = <span class="keyword">new</span> Mac80211Pkt(<span class="stringliteral">"wlan-cts"</span>);
<a name="l00863"></a>00863 
<a name="l00864"></a>00864     <a class="code" href="a00111.html" title="Controlinfo for packets which are send from Physical layer to the MAC layer.">PhyToMacControlInfo</a>* phyCtrlInfo = <span class="keyword">static_cast&lt;</span><a class="code" href="a00111.html" title="Controlinfo for packets which are send from Physical layer to the MAC layer.">PhyToMacControlInfo</a>*<span class="keyword">&gt;</span>(af-&gt;removeControlInfo());
<a name="l00865"></a>00865   <span class="keywordtype">double</span> br = <span class="keyword">static_cast&lt;</span><span class="keyword">const </span><a class="code" href="a00056.html" title="Defines an extended DeciderResult for the 80211 protocol which stores the bit-rate...">DeciderResult80211</a>*<span class="keyword">&gt;</span>(phyCtrlInfo-&gt;<a class="code" href="a00111.html#0a8f38d6c909e129752f88c8f1377e8f" title="Returns the result of the evaluation of the Decider.">getDeciderResult</a>())-&gt;getBitrate();
<a name="l00866"></a>00866   <span class="keyword">delete</span> phyCtrlInfo;
<a name="l00867"></a>00867   phyCtrlInfo = 0;
<a name="l00868"></a>00868 
<a name="l00869"></a>00869   <a class="code" href="a00124.html" title="The signal class stores the physical representation of the signal of an AirFrame...">Signal</a>* signal = <a class="code" href="a00086.html#f3931f437864a565081885eba81b6019" title="Creates the signal to be used for a packet to be sent.">createSignal</a>(simTime(),
<a name="l00870"></a>00870                   <a class="code" href="a00086.html#6732e4a776e78432bf5dd9dd26de2f7d" title="computes the duration of a transmission over the physical channel, given a certain...">packetDuration</a>(<a class="code" href="a00297.html#0904361ff428ae58f8c790bef1cefb4c">LENGTH_CTS</a>, br),
<a name="l00871"></a>00871                   <a class="code" href="a00086.html#592eee2a24a6fcadd6fdf912a101719f" title="The power at which data is transmitted.">txPower</a>, br);
<a name="l00872"></a>00872 
<a name="l00873"></a>00873     <a class="code" href="a00089.html" title="Stores information which is needed by the physical layer when sending a MacPkt.">MacToPhyControlInfo</a> *pco = <span class="keyword">new</span> <a class="code" href="a00089.html" title="Stores information which is needed by the physical layer when sending a MacPkt.">MacToPhyControlInfo</a>(signal);
<a name="l00874"></a>00874     frame-&gt;setControlInfo(pco);
<a name="l00875"></a>00875     frame-&gt;setKind(<a class="code" href="a00086.html#e423db101e8431b0cbd67c347076c44a41f567fa1631dfb9583b3521516896a1">CTS</a>);
<a name="l00876"></a>00876     frame-&gt;setBitLength((<span class="keywordtype">int</span>)<a class="code" href="a00297.html#0904361ff428ae58f8c790bef1cefb4c">LENGTH_CTS</a>);
<a name="l00877"></a>00877 
<a name="l00878"></a>00878     <span class="comment">// the dest adress must be the src adress of the RTS received. The</span>
<a name="l00879"></a>00879     <span class="comment">// src adress is the adress of the node</span>
<a name="l00880"></a>00880     frame-&gt;setSrcAddr(<a class="code" href="a00086.html#ac2e4050e1e1277556033521e3a296d5" title="MAC address (obtained from arp module).">myMacAddr</a>);
<a name="l00881"></a>00881     frame-&gt;setDestAddr(af-&gt;getSrcAddr());
<a name="l00882"></a>00882 
<a name="l00883"></a>00883     frame-&gt;setDuration(af-&gt;getDuration() - <a class="code" href="a00297.html#51a9ec9ebf3d92c8137776db8f8442c6" title="Short interframe space between DATA and ACK.">SIFS</a> - <a class="code" href="a00086.html#6732e4a776e78432bf5dd9dd26de2f7d" title="computes the duration of a transmission over the physical channel, given a certain...">packetDuration</a>(LENGTH_CTS, br));
<a name="l00884"></a>00884 
<a name="l00885"></a>00885     scheduleAt(simTime() + af-&gt;getDuration() - <a class="code" href="a00086.html#6732e4a776e78432bf5dd9dd26de2f7d" title="computes the duration of a transmission over the physical channel, given a certain...">packetDuration</a>(<a class="code" href="a00297.html#2cfa720fa65b7858c072e2f274f3cd55">LENGTH_ACK</a>, br) - 2 * <a class="code" href="a00297.html#51a9ec9ebf3d92c8137776db8f8442c6" title="Short interframe space between DATA and ACK.">SIFS</a> + <a class="code" href="a00086.html#b9f0ea820748af6d640569fc76f39659" title="Very small value used in timer scheduling in order to avoid multiple changements...">delta</a>, <a class="code" href="a00086.html#2d31f97b0662b8e37f090c3b996cec82" title="Timer used for time-outs after the transmission of a RTS, a CTS, or a DATA packet...">timeout</a>);
<a name="l00886"></a>00886     EV &lt;&lt; <span class="stringliteral">" Mac80211::sendCTSframe duration: "</span> &lt;&lt;  <a class="code" href="a00086.html#6732e4a776e78432bf5dd9dd26de2f7d" title="computes the duration of a transmission over the physical channel, given a certain...">packetDuration</a>(LENGTH_CTS, br) &lt;&lt; <span class="stringliteral">" br: "</span> &lt;&lt; br &lt;&lt; <span class="stringliteral">"\n"</span>;
<a name="l00887"></a>00887     <span class="comment">// send CTS frame</span>
<a name="l00888"></a>00888     <a class="code" href="a00016.html#1873d6e3fc6d92cf8482b39f1c5ac6c8" title="Sends a message to the lower layer.">sendDown</a>(frame);
<a name="l00889"></a>00889 
<a name="l00890"></a>00890     <span class="comment">// update state and display</span>
<a name="l00891"></a>00891     <a class="code" href="a00086.html#9fc6eb078e53740d354f8ea7b9d94713" title="Sets the state, and produces a log message in between.">setState</a>(<a class="code" href="a00086.html#7ff0b8b49d1a93feae6f808caf5fe447be0abc1112335ff66c1eef6bd95371e4">WFDATA</a>);
<a name="l00892"></a>00892 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="7a4ff22b4b999827a898794923115880"></a><!-- doxytag: member="Mac80211::sendDATAframe" ref="7a4ff22b4b999827a898794923115880" args="(Mac80211Pkt *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Mac80211::sendDATAframe           </td>
          <td>(</td>
          <td class="paramtype">Mac80211Pkt *&nbsp;</td>
          <td class="paramname"> <em>af</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
send data frame 
<p>
Send a DATA frame. Called by HandleEndSifsTimer() or <a class="el" href="a00086.html#0a87fa1791117ef1dd1841ba217e4245" title="Called by the Blackboard whenever a change occurs we&#39;re interested in.">handleEndContentionTimer()</a> 
<p>Definition at line <a class="el" href="a00434.html#l00742">742</a> of file <a class="el" href="a00434.html">Mac80211.cc</a>.</p>

<p>References <a class="el" href="a00434.html#l01004">createSignal()</a>, <a class="el" href="a00435.html#l00049">DATA</a>, <a class="el" href="a00435.html#l00293">fromUpperLayer</a>, <a class="el" href="a00375.html#l00040">PhyToMacControlInfo::getDeciderResult()</a>, <a class="el" href="a00475.html#l00038">LENGTH_ACK</a>, <a class="el" href="a00435.html#l00237">myMacAddr</a>, <a class="el" href="a00434.html#l01095">packetDuration()</a>, <a class="el" href="a00434.html#l01178">retrieveBitrate()</a>, <a class="el" href="a00336.html#l00108">BaseLayer::sendDown()</a>, <a class="el" href="a00434.html#l01118">setState()</a>, <a class="el" href="a00435.html#l00303">shortRetryCounter</a>, <a class="el" href="a00475.html#l00051">SIFS</a>, <a class="el" href="a00435.html#l00243">timeout</a>, <a class="el" href="a00434.html#l01070">timeOut()</a>, <a class="el" href="a00435.html#l00271">txPower</a>, and <a class="el" href="a00435.html#l00069">WFACK</a>.</p>

<p>Referenced by <a class="el" href="a00434.html#l00585">handleEndContentionTimer()</a>, and <a class="el" href="a00434.html#l00683">handleEndSifsTimer()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00743"></a>00743 {
<a name="l00744"></a>00744     Mac80211Pkt *frame = <span class="keyword">static_cast&lt;</span>Mac80211Pkt *<span class="keyword">&gt;</span>(<a class="code" href="a00086.html#969e8e3a592dffccea28596c61b2af50" title="Buffering of messages from upper layer.">fromUpperLayer</a>.front()-&gt;dup());
<a name="l00745"></a>00745     <span class="keywordtype">double</span> br;
<a name="l00746"></a>00746 
<a name="l00747"></a>00747     <span class="keywordflow">if</span>(af) {
<a name="l00748"></a>00748       <a class="code" href="a00111.html" title="Controlinfo for packets which are send from Physical layer to the MAC layer.">PhyToMacControlInfo</a>* tmp = <span class="keyword">static_cast&lt;</span><a class="code" href="a00111.html" title="Controlinfo for packets which are send from Physical layer to the MAC layer.">PhyToMacControlInfo</a>*<span class="keyword">&gt;</span>(af-&gt;removeControlInfo());
<a name="l00749"></a>00749 
<a name="l00750"></a>00750         br = <span class="keyword">static_cast&lt;</span><span class="keyword">const </span><a class="code" href="a00056.html" title="Defines an extended DeciderResult for the 80211 protocol which stores the bit-rate...">DeciderResult80211</a>*<span class="keyword">&gt;</span>(tmp-&gt;<a class="code" href="a00111.html#0a8f38d6c909e129752f88c8f1377e8f" title="Returns the result of the evaluation of the Decider.">getDeciderResult</a>())-&gt;getBitrate();
<a name="l00751"></a>00751 
<a name="l00752"></a>00752         <span class="keyword">delete</span> tmp;
<a name="l00753"></a>00753     }
<a name="l00754"></a>00754     <span class="keywordflow">else</span> {
<a name="l00755"></a>00755        br  = <a class="code" href="a00086.html#386da37d596d50ddae0c2bb3ade102e6" title="figure out at which bitrate to send to this particular destination">retrieveBitrate</a>(frame-&gt;getDestAddr());
<a name="l00756"></a>00756 
<a name="l00757"></a>00757        <span class="keywordflow">if</span>(<a class="code" href="a00086.html#9bbc3d71eddb62c4e12dcd500a58b0bb" title="Number of frame transmission attempt.">shortRetryCounter</a>) frame-&gt;setRetry(<span class="keyword">true</span>);
<a name="l00758"></a>00758     }
<a name="l00759"></a>00759     simtime_t duration = <a class="code" href="a00086.html#6732e4a776e78432bf5dd9dd26de2f7d" title="computes the duration of a transmission over the physical channel, given a certain...">packetDuration</a>(frame-&gt;getBitLength(), br);
<a name="l00760"></a>00760     <a class="code" href="a00124.html" title="The signal class stores the physical representation of the signal of an AirFrame...">Signal</a>* signal = <a class="code" href="a00086.html#f3931f437864a565081885eba81b6019" title="Creates the signal to be used for a packet to be sent.">createSignal</a>(simTime(), duration, <a class="code" href="a00086.html#592eee2a24a6fcadd6fdf912a101719f" title="The power at which data is transmitted.">txPower</a>, br);
<a name="l00761"></a>00761     <a class="code" href="a00089.html" title="Stores information which is needed by the physical layer when sending a MacPkt.">MacToPhyControlInfo</a> *pco = <span class="keyword">new</span> <a class="code" href="a00089.html" title="Stores information which is needed by the physical layer when sending a MacPkt.">MacToPhyControlInfo</a>(signal);
<a name="l00762"></a>00762     <span class="comment">// build a copy of the frame in front of the queue'</span>
<a name="l00763"></a>00763     frame-&gt;setControlInfo(pco);
<a name="l00764"></a>00764     frame-&gt;setSrcAddr(<a class="code" href="a00086.html#ac2e4050e1e1277556033521e3a296d5" title="MAC address (obtained from arp module).">myMacAddr</a>);
<a name="l00765"></a>00765     frame-&gt;setKind(<a class="code" href="a00086.html#e423db101e8431b0cbd67c347076c44a3e44931a7b0bf9a1f060898544c94467">DATA</a>);
<a name="l00766"></a>00766     frame-&gt;setDuration(<a class="code" href="a00297.html#51a9ec9ebf3d92c8137776db8f8442c6" title="Short interframe space between DATA and ACK.">SIFS</a> + <a class="code" href="a00086.html#6732e4a776e78432bf5dd9dd26de2f7d" title="computes the duration of a transmission over the physical channel, given a certain...">packetDuration</a>(<a class="code" href="a00297.html#2cfa720fa65b7858c072e2f274f3cd55">LENGTH_ACK</a>, br));
<a name="l00767"></a>00767 
<a name="l00768"></a>00768     <span class="comment">// schedule time out</span>
<a name="l00769"></a>00769     scheduleAt(simTime() + <a class="code" href="a00086.html#424851e88bb229fcc3c59cfea80a9079" title="return a timeOut value for a certain type of frame">timeOut</a>(<a class="code" href="a00086.html#e423db101e8431b0cbd67c347076c44a3e44931a7b0bf9a1f060898544c94467">DATA</a>, br), <a class="code" href="a00086.html#2d31f97b0662b8e37f090c3b996cec82" title="Timer used for time-outs after the transmission of a RTS, a CTS, or a DATA packet...">timeout</a>);
<a name="l00770"></a>00770     EV &lt;&lt; <span class="stringliteral">"sending DATA  to "</span> &lt;&lt; frame-&gt;getDestAddr() &lt;&lt; <span class="stringliteral">" with bitrate "</span> &lt;&lt; br &lt;&lt; endl;
<a name="l00771"></a>00771     <span class="comment">// send DATA frame</span>
<a name="l00772"></a>00772     <a class="code" href="a00016.html#1873d6e3fc6d92cf8482b39f1c5ac6c8" title="Sends a message to the lower layer.">sendDown</a>(frame);
<a name="l00773"></a>00773 
<a name="l00774"></a>00774     <span class="comment">// update state and display</span>
<a name="l00775"></a>00775     <a class="code" href="a00086.html#9fc6eb078e53740d354f8ea7b9d94713" title="Sets the state, and produces a log message in between.">setState</a>(<a class="code" href="a00086.html#7ff0b8b49d1a93feae6f808caf5fe44750a717bfadf9a3fdd634d77950607278">WFACK</a>);
<a name="l00776"></a>00776 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="3104750758ab171b20ffcfeae0079a78"></a><!-- doxytag: member="Mac80211::sendRTSframe" ref="3104750758ab171b20ffcfeae0079a78" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Mac80211::sendRTSframe           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
send RTS frame 
<p>
Send a RTS frame.Called by handleContentionTimer() 
<p>Definition at line <a class="el" href="a00434.html#l00818">818</a> of file <a class="el" href="a00434.html">Mac80211.cc</a>.</p>

<p>References <a class="el" href="a00434.html#l01004">createSignal()</a>, <a class="el" href="a00435.html#l00293">fromUpperLayer</a>, <a class="el" href="a00475.html#l00038">LENGTH_ACK</a>, <a class="el" href="a00475.html#l00037">LENGTH_CTS</a>, <a class="el" href="a00475.html#l00036">LENGTH_RTS</a>, <a class="el" href="a00434.html#l01095">packetDuration()</a>, <a class="el" href="a00434.html#l01178">retrieveBitrate()</a>, <a class="el" href="a00435.html#l00046">RTS</a>, <a class="el" href="a00336.html#l00108">BaseLayer::sendDown()</a>, <a class="el" href="a00434.html#l01118">setState()</a>, <a class="el" href="a00475.html#l00051">SIFS</a>, <a class="el" href="a00435.html#l00243">timeout</a>, <a class="el" href="a00434.html#l01070">timeOut()</a>, <a class="el" href="a00435.html#l00271">txPower</a>, and <a class="el" href="a00435.html#l00068">WFCTS</a>.</p>

<p>Referenced by <a class="el" href="a00434.html#l00585">handleEndContentionTimer()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00819"></a>00819 {
<a name="l00820"></a>00820     Mac80211Pkt *frame = <span class="keyword">new</span> Mac80211Pkt(<span class="stringliteral">"wlan-rts"</span>);
<a name="l00821"></a>00821 
<a name="l00822"></a>00822     <span class="keyword">const</span> Mac80211Pkt* frameToSend = <a class="code" href="a00086.html#969e8e3a592dffccea28596c61b2af50" title="Buffering of messages from upper layer.">fromUpperLayer</a>.front();
<a name="l00823"></a>00823     <span class="keywordtype">double</span> br = <a class="code" href="a00086.html#386da37d596d50ddae0c2bb3ade102e6" title="figure out at which bitrate to send to this particular destination">retrieveBitrate</a>(frameToSend-&gt;getDestAddr());
<a name="l00824"></a>00824 
<a name="l00825"></a>00825     <a class="code" href="a00124.html" title="The signal class stores the physical representation of the signal of an AirFrame...">Signal</a>* signal = <a class="code" href="a00086.html#f3931f437864a565081885eba81b6019" title="Creates the signal to be used for a packet to be sent.">createSignal</a>(simTime(),
<a name="l00826"></a>00826                   <a class="code" href="a00086.html#6732e4a776e78432bf5dd9dd26de2f7d" title="computes the duration of a transmission over the physical channel, given a certain...">packetDuration</a>(<a class="code" href="a00297.html#51ede2d449cc2280250de6b6bfe78ad0" title="standard frame lengths (in bit)">LENGTH_RTS</a>, br),
<a name="l00827"></a>00827                   <a class="code" href="a00086.html#592eee2a24a6fcadd6fdf912a101719f" title="The power at which data is transmitted.">txPower</a>, br);
<a name="l00828"></a>00828 
<a name="l00829"></a>00829     <a class="code" href="a00089.html" title="Stores information which is needed by the physical layer when sending a MacPkt.">MacToPhyControlInfo</a> *pco = <span class="keyword">new</span> <a class="code" href="a00089.html" title="Stores information which is needed by the physical layer when sending a MacPkt.">MacToPhyControlInfo</a>(signal);
<a name="l00830"></a>00830 
<a name="l00831"></a>00831     frame-&gt;setControlInfo(pco);
<a name="l00832"></a>00832     frame-&gt;setKind(<a class="code" href="a00086.html#e423db101e8431b0cbd67c347076c44ae37294c092b58bc2b8b13eed3743bbcb">RTS</a>);
<a name="l00833"></a>00833     frame-&gt;setBitLength((<span class="keywordtype">int</span>)<a class="code" href="a00297.html#51ede2d449cc2280250de6b6bfe78ad0" title="standard frame lengths (in bit)">LENGTH_RTS</a>);
<a name="l00834"></a>00834 
<a name="l00835"></a>00835     <span class="comment">// the src adress and dest address are copied in the frame in the queue (frame to be sent)</span>
<a name="l00836"></a>00836     frame-&gt;setSrcAddr(frameToSend-&gt;getSrcAddr());
<a name="l00837"></a>00837     frame-&gt;setDestAddr(frameToSend-&gt;getDestAddr());
<a name="l00838"></a>00838 
<a name="l00839"></a>00839     <span class="keywordtype">double</span> packetSize = frameToSend-&gt;getBitLength();
<a name="l00840"></a>00840     frame-&gt;setDuration(3 * <a class="code" href="a00297.html#51a9ec9ebf3d92c8137776db8f8442c6" title="Short interframe space between DATA and ACK.">SIFS</a> + <a class="code" href="a00086.html#6732e4a776e78432bf5dd9dd26de2f7d" title="computes the duration of a transmission over the physical channel, given a certain...">packetDuration</a>(<a class="code" href="a00297.html#0904361ff428ae58f8c790bef1cefb4c">LENGTH_CTS</a>, br) +
<a name="l00841"></a>00841                        <a class="code" href="a00086.html#6732e4a776e78432bf5dd9dd26de2f7d" title="computes the duration of a transmission over the physical channel, given a certain...">packetDuration</a>(packetSize, br) +
<a name="l00842"></a>00842                        <a class="code" href="a00086.html#6732e4a776e78432bf5dd9dd26de2f7d" title="computes the duration of a transmission over the physical channel, given a certain...">packetDuration</a>(<a class="code" href="a00297.html#2cfa720fa65b7858c072e2f274f3cd55">LENGTH_ACK</a>, br));
<a name="l00843"></a>00843 
<a name="l00844"></a>00844     EV &lt;&lt; <span class="stringliteral">" Mac80211::sendRTSframe duration: "</span> &lt;&lt;  <a class="code" href="a00086.html#6732e4a776e78432bf5dd9dd26de2f7d" title="computes the duration of a transmission over the physical channel, given a certain...">packetDuration</a>(LENGTH_RTS, br) &lt;&lt; <span class="stringliteral">" br: "</span> &lt;&lt; br &lt;&lt; <span class="stringliteral">"\n"</span>;
<a name="l00845"></a>00845 
<a name="l00846"></a>00846     <span class="comment">// schedule time-out</span>
<a name="l00847"></a>00847     scheduleAt(simTime() + <a class="code" href="a00086.html#424851e88bb229fcc3c59cfea80a9079" title="return a timeOut value for a certain type of frame">timeOut</a>(<a class="code" href="a00086.html#e423db101e8431b0cbd67c347076c44ae37294c092b58bc2b8b13eed3743bbcb">RTS</a>, br), <a class="code" href="a00086.html#2d31f97b0662b8e37f090c3b996cec82" title="Timer used for time-outs after the transmission of a RTS, a CTS, or a DATA packet...">timeout</a>);
<a name="l00848"></a>00848 
<a name="l00849"></a>00849     <span class="comment">// send RTS frame</span>
<a name="l00850"></a>00850     <a class="code" href="a00016.html#1873d6e3fc6d92cf8482b39f1c5ac6c8" title="Sends a message to the lower layer.">sendDown</a>(frame);
<a name="l00851"></a>00851 
<a name="l00852"></a>00852     <span class="comment">// update state and display</span>
<a name="l00853"></a>00853     <a class="code" href="a00086.html#9fc6eb078e53740d354f8ea7b9d94713" title="Sets the state, and produces a log message in between.">setState</a>(<a class="code" href="a00086.html#7ff0b8b49d1a93feae6f808caf5fe447ccc67a0993941984c4f6b49c633c2ad8">WFCTS</a>);
<a name="l00854"></a>00854 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="be230265b97330ce9946e4c336b4761c"></a><!-- doxytag: member="Mac80211::senseChannelWhileIdle" ref="be230265b97330ce9946e4c336b4761c" args="(simtime_t duration)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Mac80211::senseChannelWhileIdle           </td>
          <td>(</td>
          <td class="paramtype">simtime_t&nbsp;</td>
          <td class="paramname"> <em>duration</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Starts a channel sense request which sense the channel for the passed duration or until the channel is busy. 
<p>
Used during contend state to check if the channel is free. 
<p>Definition at line <a class="el" href="a00434.html#l00120">120</a> of file <a class="el" href="a00434.html">Mac80211.cc</a>.</p>

<p>References <a class="el" href="a00435.html#l00258">chSenseStart</a>, <a class="el" href="a00435.html#l00250">contention</a>, and <a class="el" href="a00336.html#l00123">BaseLayer::sendControlDown()</a>.</p>

<p>Referenced by <a class="el" href="a00434.html#l00924">beginNewCycle()</a>, and <a class="el" href="a00434.html#l00033">initialize()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00120"></a>00120                                                        {
<a name="l00121"></a>00121   <span class="keywordflow">if</span>(<a class="code" href="a00086.html#7bd4f3adc205b150f9fa406fa582f0b6" title="Used to sense if the channel is idle for contention periods.">contention</a>-&gt;isScheduled()) {
<a name="l00122"></a>00122     error(<span class="stringliteral">"Cannot start a new channel sense request because already sensing the channel!"</span>);
<a name="l00123"></a>00123   }
<a name="l00124"></a>00124 
<a name="l00125"></a>00125   <a class="code" href="a00086.html#8104daf3041394b73fe545427cbc02d7" title="Stores the the time a channel sensing started. Used to calculate the quiet-time of...">chSenseStart</a> = simTime();
<a name="l00126"></a>00126   <a class="code" href="a00086.html#7bd4f3adc205b150f9fa406fa582f0b6" title="Used to sense if the channel is idle for contention periods.">contention</a>-&gt;setSenseTimeout(duration);
<a name="l00127"></a>00127 
<a name="l00128"></a>00128   <a class="code" href="a00016.html#6d01a0f56978740d7617c2e338858cc3" title="Sends a control message to a lower layer.">sendControlDown</a>(<a class="code" href="a00086.html#7bd4f3adc205b150f9fa406fa582f0b6" title="Used to sense if the channel is idle for contention periods.">contention</a>);
<a name="l00129"></a>00129 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="9fc6eb078e53740d354f8ea7b9d94713"></a><!-- doxytag: member="Mac80211::setState" ref="9fc6eb078e53740d354f8ea7b9d94713" args="(State state)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Mac80211::setState           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00086.html#7ff0b8b49d1a93feae6f808caf5fe447">State</a>&nbsp;</td>
          <td class="paramname"> <em>state</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Sets the state, and produces a log message in between. 
<p>

<p>Definition at line <a class="el" href="a00434.html#l01118">1118</a> of file <a class="el" href="a00434.html">Mac80211.cc</a>.</p>

<p>References <a class="el" href="a00435.html#l00261">state</a>, and <a class="el" href="a00434.html#l01100">stateName()</a>.</p>

<p>Referenced by <a class="el" href="a00434.html#l00924">beginNewCycle()</a>, <a class="el" href="a00434.html#l00683">handleEndSifsTimer()</a>, <a class="el" href="a00434.html#l00327">handleMsgNotForMe()</a>, <a class="el" href="a00434.html#l00782">sendACKframe()</a>, <a class="el" href="a00434.html#l00897">sendBROADCASTframe()</a>, <a class="el" href="a00434.html#l00860">sendCTSframe()</a>, <a class="el" href="a00434.html#l00742">sendDATAframe()</a>, and <a class="el" href="a00434.html#l00818">sendRTSframe()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l01119"></a>01119 {
<a name="l01120"></a>01120     <span class="keywordflow">if</span> (<a class="code" href="a00086.html#56fa75f3eb056ae29b1a4b8da0035d8c" title="Current state of the MAC.">state</a>==newState)
<a name="l01121"></a>01121         EV &lt;&lt; <span class="stringliteral">"staying in state "</span> &lt;&lt; <a class="code" href="a00086.html#de8a90e665191333e610b60bad4a32a1" title="Produce a readable name of the given state.">stateName</a>(<a class="code" href="a00086.html#56fa75f3eb056ae29b1a4b8da0035d8c" title="Current state of the MAC.">state</a>) &lt;&lt; <span class="stringliteral">"\n"</span>;
<a name="l01122"></a>01122     <span class="keywordflow">else</span>
<a name="l01123"></a>01123         EV &lt;&lt; <span class="stringliteral">"state "</span> &lt;&lt; <a class="code" href="a00086.html#de8a90e665191333e610b60bad4a32a1" title="Produce a readable name of the given state.">stateName</a>(<a class="code" href="a00086.html#56fa75f3eb056ae29b1a4b8da0035d8c" title="Current state of the MAC.">state</a>) &lt;&lt; <span class="stringliteral">" --&gt; "</span> &lt;&lt; <a class="code" href="a00086.html#de8a90e665191333e610b60bad4a32a1" title="Produce a readable name of the given state.">stateName</a>(newState) &lt;&lt; <span class="stringliteral">"\n"</span>;
<a name="l01124"></a>01124     <a class="code" href="a00086.html#56fa75f3eb056ae29b1a4b8da0035d8c" title="Current state of the MAC.">state</a> = newState;
<a name="l01125"></a>01125 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="de8a90e665191333e610b60bad4a32a1"></a><!-- doxytag: member="Mac80211::stateName" ref="de8a90e665191333e610b60bad4a32a1" args="(State state)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char * Mac80211::stateName           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00086.html#7ff0b8b49d1a93feae6f808caf5fe447">State</a>&nbsp;</td>
          <td class="paramname"> <em>state</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Produce a readable name of the given state. 
<p>

<p>Definition at line <a class="el" href="a00434.html#l01100">1100</a> of file <a class="el" href="a00434.html">Mac80211.cc</a>.</p>

<p>References <a class="el" href="a00435.html#l00070">BUSY</a>, <a class="el" href="a00256.html#60cc06bef97da802b8522d258ac4fe89">CASE</a>, <a class="el" href="a00435.html#l00067">CONTEND</a>, <a class="el" href="a00435.html#l00066">IDLE</a>, <a class="el" href="a00435.html#l00065">QUIET</a>, <a class="el" href="a00435.html#l00069">WFACK</a>, <a class="el" href="a00435.html#l00068">WFCTS</a>, and <a class="el" href="a00435.html#l00064">WFDATA</a>.</p>

<p>Referenced by <a class="el" href="a00434.html#l00397">handleMsgForMe()</a>, <a class="el" href="a00434.html#l00652">handleTimeoutTimer()</a>, and <a class="el" href="a00434.html#l01118">setState()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l01101"></a>01101 {
<a name="l01102"></a>01102 <span class="preprocessor">#define CASE(x) case x: s=#x; break</span>
<a name="l01103"></a>01103 <span class="preprocessor"></span>    <span class="keyword">const</span> <span class="keywordtype">char</span> *s = <span class="stringliteral">"???"</span>;
<a name="l01104"></a>01104     <span class="keywordflow">switch</span> (<a class="code" href="a00086.html#56fa75f3eb056ae29b1a4b8da0035d8c" title="Current state of the MAC.">state</a>)
<a name="l01105"></a>01105     {
<a name="l01106"></a>01106         <a class="code" href="a00256.html#60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="a00086.html#7ff0b8b49d1a93feae6f808caf5fe447be0abc1112335ff66c1eef6bd95371e4">WFDATA</a>);
<a name="l01107"></a>01107         <a class="code" href="a00256.html#60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="a00086.html#7ff0b8b49d1a93feae6f808caf5fe4474cfe7a25808b0e110d662483abec7256">QUIET</a>);
<a name="l01108"></a>01108         <a class="code" href="a00256.html#60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="a00086.html#7ff0b8b49d1a93feae6f808caf5fe4478904ce43407ca530f7fe83d63c558e28">IDLE</a>);
<a name="l01109"></a>01109         <a class="code" href="a00256.html#60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="a00086.html#7ff0b8b49d1a93feae6f808caf5fe447e138f38743ca77f1300a24d4d79786fe">CONTEND</a>);
<a name="l01110"></a>01110         <a class="code" href="a00256.html#60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="a00086.html#7ff0b8b49d1a93feae6f808caf5fe447ccc67a0993941984c4f6b49c633c2ad8">WFCTS</a>);
<a name="l01111"></a>01111         <a class="code" href="a00256.html#60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="a00086.html#7ff0b8b49d1a93feae6f808caf5fe44750a717bfadf9a3fdd634d77950607278">WFACK</a>);
<a name="l01112"></a>01112         <a class="code" href="a00256.html#60cc06bef97da802b8522d258ac4fe89">CASE</a>(<a class="code" href="a00086.html#7ff0b8b49d1a93feae6f808caf5fe447a1070f3c837e8dc4d7890536f7cfbaf9">BUSY</a>);
<a name="l01113"></a>01113     }
<a name="l01114"></a>01114     <span class="keywordflow">return</span> s;
<a name="l01115"></a>01115 <span class="preprocessor">#undef CASE</span>
<a name="l01116"></a>01116 <span class="preprocessor"></span>}
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="9ae0815a0e01c4d4fd13a87393f837a8"></a><!-- doxytag: member="Mac80211::suspendContention" ref="9ae0815a0e01c4d4fd13a87393f837a8" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Mac80211::suspendContention           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
suspend an ongoing contention, pick it up again when the channel becomes idle 
<p>

<p>Definition at line <a class="el" href="a00434.html#l01127">1127</a> of file <a class="el" href="a00434.html">Mac80211.cc</a>.</p>

<p>References <a class="el" href="a00435.html#l00258">chSenseStart</a>, <a class="el" href="a00435.html#l00250">contention</a>, <a class="el" href="a00435.html#l00313">currentIFS</a>, <a class="el" href="a00435.html#l00308">remainingBackoff</a>, and <a class="el" href="a00475.html#l00047">ST</a>.</p>

<p>Referenced by <a class="el" href="a00434.html#l00585">handleEndContentionTimer()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l01127"></a>01127                                   {
<a name="l01128"></a>01128   assert(!<a class="code" href="a00086.html#7bd4f3adc205b150f9fa406fa582f0b6" title="Used to sense if the channel is idle for contention periods.">contention</a>-&gt;isScheduled());
<a name="l01129"></a>01129     <span class="comment">// if there's a contention period</span>
<a name="l01130"></a>01130 
<a name="l01131"></a>01131     <span class="comment">//if(requestReturned || chSenseRequest-&gt;isScheduled()) {</span>
<a name="l01132"></a>01132         <span class="comment">// update the backoff window in order to give higher priority in</span>
<a name="l01133"></a>01133         <span class="comment">// the next battle</span>
<a name="l01134"></a>01134 
<a name="l01135"></a>01135       simtime_t quietTime = simTime() - <a class="code" href="a00086.html#8104daf3041394b73fe545427cbc02d7" title="Stores the the time a channel sensing started. Used to calculate the quiet-time of...">chSenseStart</a>;
<a name="l01136"></a>01136 
<a name="l01137"></a>01137         EV &lt;&lt; simTime() &lt;&lt; <span class="stringliteral">" suspend contention: "</span>
<a name="l01138"></a>01138        &lt;&lt; <span class="stringliteral">"began "</span> &lt;&lt; <a class="code" href="a00086.html#8104daf3041394b73fe545427cbc02d7" title="Stores the the time a channel sensing started. Used to calculate the quiet-time of...">chSenseStart</a>
<a name="l01139"></a>01139        &lt;&lt; <span class="stringliteral">", ends "</span> &lt;&lt; <a class="code" href="a00086.html#8104daf3041394b73fe545427cbc02d7" title="Stores the the time a channel sensing started. Used to calculate the quiet-time of...">chSenseStart</a> + <a class="code" href="a00086.html#7bd4f3adc205b150f9fa406fa582f0b6" title="Used to sense if the channel is idle for contention periods.">contention</a>-&gt;getSenseTimeout()
<a name="l01140"></a>01140        &lt;&lt; <span class="stringliteral">", ifs "</span> &lt;&lt; <a class="code" href="a00086.html#4a9d1c8d45c46f18afa0f07f5b6572f4" title="current IFS value (DIFS or EIFS) If an error has been detected, the next backoff...">currentIFS</a>
<a name="l01141"></a>01141        &lt;&lt; <span class="stringliteral">", quiet time "</span> &lt;&lt; quietTime
<a name="l01142"></a>01142        &lt;&lt; endl;
<a name="l01143"></a>01143 
<a name="l01144"></a>01144         <span class="keywordflow">if</span>(quietTime &lt; <a class="code" href="a00086.html#4a9d1c8d45c46f18afa0f07f5b6572f4" title="current IFS value (DIFS or EIFS) If an error has been detected, the next backoff...">currentIFS</a>) {
<a name="l01145"></a>01145             EV &lt;&lt; <span class="stringliteral">"suspended during D/EIFS (no backoff)"</span> &lt;&lt; endl;
<a name="l01146"></a>01146         }
<a name="l01147"></a>01147         <span class="keywordflow">else</span> {
<a name="l01148"></a>01148             <span class="keywordtype">double</span> remainingSlots;
<a name="l01149"></a>01149             remainingSlots = (<a class="code" href="a00086.html#7bd4f3adc205b150f9fa406fa582f0b6" title="Used to sense if the channel is idle for contention periods.">contention</a>-&gt;getSenseTimeout() - quietTime).dbl()/<a class="code" href="a00297.html#ec0071eea60aae281dd371d97a3cc4cd" title="Standard time values.">ST</a>;
<a name="l01150"></a>01150 
<a name="l01151"></a>01151             <span class="comment">// Distinguish between (if) case where contention is</span>
<a name="l01152"></a>01152             <span class="comment">// suspended after an integer number of slots and we</span>
<a name="l01153"></a>01153             <span class="comment">// _round_ to integer to avoid fp error, and (else) case</span>
<a name="l01154"></a>01154             <span class="comment">// where contention is suspended mid-slot (e.g. hidden</span>
<a name="l01155"></a>01155             <span class="comment">// terminal xmits) and we _ceil_ to repeat the partial</span>
<a name="l01156"></a>01156             <span class="comment">// slot.  Arbitrary value 0.0001 * ST is used to</span>
<a name="l01157"></a>01157             <span class="comment">// distinguish the two cases, which may a problem if clock</span>
<a name="l01158"></a>01158             <span class="comment">// skew between nic's is ever implemented.</span>
<a name="l01159"></a>01159 
<a name="l01160"></a>01160             <span class="keywordflow">if</span> (fabs(ceil(remainingSlots) - remainingSlots) &lt; 0.0001 * <a class="code" href="a00297.html#ec0071eea60aae281dd371d97a3cc4cd" title="Standard time values.">ST</a> ||
<a name="l01161"></a>01161                 fabs(floor(remainingSlots) - remainingSlots) &lt; 0.0001 * <a class="code" href="a00297.html#ec0071eea60aae281dd371d97a3cc4cd" title="Standard time values.">ST</a>) {
<a name="l01162"></a>01162                 <a class="code" href="a00086.html#58484d1a6f2031548d433d18438042e9" title="remaining backoff time. If the backoff timer is interrupted, this variable holds...">remainingBackoff</a> = floor(remainingSlots + 0.5) * <a class="code" href="a00297.html#ec0071eea60aae281dd371d97a3cc4cd" title="Standard time values.">ST</a>;
<a name="l01163"></a>01163             }
<a name="l01164"></a>01164             <span class="keywordflow">else</span> {
<a name="l01165"></a>01165                 <a class="code" href="a00086.html#58484d1a6f2031548d433d18438042e9" title="remaining backoff time. If the backoff timer is interrupted, this variable holds...">remainingBackoff</a> = ceil(remainingSlots) * <a class="code" href="a00297.html#ec0071eea60aae281dd371d97a3cc4cd" title="Standard time values.">ST</a>;
<a name="l01166"></a>01166             }
<a name="l01167"></a>01167 
<a name="l01168"></a>01168             EV &lt;&lt; <span class="stringliteral">"backoff was "</span> &lt;&lt; ((<a class="code" href="a00086.html#7bd4f3adc205b150f9fa406fa582f0b6" title="Used to sense if the channel is idle for contention periods.">contention</a>-&gt;getSenseTimeout() - <a class="code" href="a00086.html#4a9d1c8d45c46f18afa0f07f5b6572f4" title="current IFS value (DIFS or EIFS) If an error has been detected, the next backoff...">currentIFS</a>))/<a class="code" href="a00297.html#ec0071eea60aae281dd371d97a3cc4cd" title="Standard time values.">ST</a>
<a name="l01169"></a>01169                &lt;&lt; <span class="stringliteral">" slots, now "</span> &lt;&lt; remainingSlots &lt;&lt; <span class="stringliteral">" slots remain"</span> &lt;&lt; endl;
<a name="l01170"></a>01170         }
<a name="l01171"></a>01171 
<a name="l01172"></a>01172         EV &lt;&lt; <span class="stringliteral">"suspended backoff timer, remaining backoff time: "</span>
<a name="l01173"></a>01173            &lt;&lt; <a class="code" href="a00086.html#58484d1a6f2031548d433d18438042e9" title="remaining backoff time. If the backoff timer is interrupted, this variable holds...">remainingBackoff</a> &lt;&lt; endl;
<a name="l01174"></a>01174 
<a name="l01175"></a>01175     <span class="comment">//}</span>
<a name="l01176"></a>01176 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="72e78257babff863ca8749b2bb1a97f4"></a><!-- doxytag: member="Mac80211::testMaxAttempts" ref="72e78257babff863ca8749b2bb1a97f4" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Mac80211::testMaxAttempts           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Test if maximum number of retries to transmit is exceeded. 
<p>
Test if the maximal retry limit is reached, and delete the frame to send in this case. 
<p>Definition at line <a class="el" href="a00434.html#l00988">988</a> of file <a class="el" href="a00434.html">Mac80211.cc</a>.</p>

<p>References <a class="el" href="a00435.html#l00293">fromUpperLayer</a>, <a class="el" href="a00475.html#l00065">LONG_RETRY_LIMIT</a>, <a class="el" href="a00435.html#l00300">longRetryCounter</a>, <a class="el" href="a00339.html#l00053">BaseMacLayer::PACKET_DROPPED</a>, <a class="el" href="a00336.html#l00118">BaseLayer::sendControlUp()</a>, <a class="el" href="a00475.html#l00071">SHORT_RETRY_LIMIT</a>, and <a class="el" href="a00435.html#l00303">shortRetryCounter</a>.</p>

<p>Referenced by <a class="el" href="a00434.html#l00924">beginNewCycle()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00989"></a>00989 {
<a name="l00990"></a>00990     <span class="keywordflow">if</span> ((<a class="code" href="a00086.html#11fb608b3564e2d2cd41b463b1a8cc90" title="Number of frame transmission attempt.">longRetryCounter</a> &gt;= <a class="code" href="a00297.html#2bb160720063fb50dbd82ab9e847d24c" title="We have to stop transmitting somewhen.">LONG_RETRY_LIMIT</a>) || (<a class="code" href="a00086.html#9bbc3d71eddb62c4e12dcd500a58b0bb" title="Number of frame transmission attempt.">shortRetryCounter</a> &gt;= <a class="code" href="a00297.html#173b916179dfb4601b7dd270d68c49a6" title="Imcrement longRetryCounter when this limit is met.">SHORT_RETRY_LIMIT</a>)) {
<a name="l00991"></a>00991         EV &lt;&lt; <span class="stringliteral">"retry limit reached src: "</span>&lt;&lt; <a class="code" href="a00086.html#9bbc3d71eddb62c4e12dcd500a58b0bb" title="Number of frame transmission attempt.">shortRetryCounter</a> &lt;&lt; <span class="stringliteral">" lrc: "</span> &lt;&lt; <a class="code" href="a00086.html#11fb608b3564e2d2cd41b463b1a8cc90" title="Number of frame transmission attempt.">longRetryCounter</a> &lt;&lt; endl;
<a name="l00992"></a>00992         <span class="comment">// initialize counter</span>
<a name="l00993"></a>00993         <a class="code" href="a00086.html#11fb608b3564e2d2cd41b463b1a8cc90" title="Number of frame transmission attempt.">longRetryCounter</a> = 0;
<a name="l00994"></a>00994         <a class="code" href="a00086.html#9bbc3d71eddb62c4e12dcd500a58b0bb" title="Number of frame transmission attempt.">shortRetryCounter</a> = 0;
<a name="l00995"></a>00995         <span class="comment">// delete the frame to transmit</span>
<a name="l00996"></a>00996         Mac80211Pkt *temp = <a class="code" href="a00086.html#969e8e3a592dffccea28596c61b2af50" title="Buffering of messages from upper layer.">fromUpperLayer</a>.front();
<a name="l00997"></a>00997         <a class="code" href="a00086.html#969e8e3a592dffccea28596c61b2af50" title="Buffering of messages from upper layer.">fromUpperLayer</a>.pop_front();
<a name="l00998"></a>00998         temp-&gt;setName(<span class="stringliteral">"MAC ERROR"</span>);
<a name="l00999"></a>00999         temp-&gt;setKind(<a class="code" href="a00017.html#49e0e548a6c20d002bd67afa7b76c483debf9c77bbe6f19772866cccbef0fe4b">PACKET_DROPPED</a>);
<a name="l01000"></a>01000         <a class="code" href="a00016.html#a1190a06fb4dfb15d8ff001468335dc8" title="Sends a control message to an upper layer.">sendControlUp</a>(temp);
<a name="l01001"></a>01001     }
<a name="l01002"></a>01002 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="424851e88bb229fcc3c59cfea80a9079"></a><!-- doxytag: member="Mac80211::timeOut" ref="424851e88bb229fcc3c59cfea80a9079" args="(Mac80211MessageKinds type, double br)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">simtime_t Mac80211::timeOut           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00086.html#e423db101e8431b0cbd67c347076c44a">Mac80211MessageKinds</a>&nbsp;</td>
          <td class="paramname"> <em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>br</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
return a timeOut value for a certain type of frame 
<p>
Handle change nofitications. In this layer it is usually information about the radio channel, i.e. if it is IDLE etc. Return a time-out value for a type of frame. Called by SendRTSframe, sendCTSframe, etc. 
<p>Definition at line <a class="el" href="a00434.html#l01070">1070</a> of file <a class="el" href="a00434.html">Mac80211.cc</a>.</p>

<p>References <a class="el" href="a00435.html#l00049">DATA</a>, <a class="el" href="a00435.html#l00320">delta</a>, <a class="el" href="a00435.html#l00293">fromUpperLayer</a>, <a class="el" href="a00475.html#l00038">LENGTH_ACK</a>, <a class="el" href="a00475.html#l00037">LENGTH_CTS</a>, <a class="el" href="a00475.html#l00036">LENGTH_RTS</a>, <a class="el" href="a00434.html#l01095">packetDuration()</a>, <a class="el" href="a00435.html#l00046">RTS</a>, and <a class="el" href="a00475.html#l00051">SIFS</a>.</p>

<p>Referenced by <a class="el" href="a00434.html#l00742">sendDATAframe()</a>, and <a class="el" href="a00434.html#l00818">sendRTSframe()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l01071"></a>01071 {
<a name="l01072"></a>01072     simtime_t time_out = 0;
<a name="l01073"></a>01073 
<a name="l01074"></a>01074     <span class="keywordflow">switch</span> (type)
<a name="l01075"></a>01075     {
<a name="l01076"></a>01076     <span class="keywordflow">case</span> <a class="code" href="a00086.html#e423db101e8431b0cbd67c347076c44ae37294c092b58bc2b8b13eed3743bbcb">RTS</a>:
<a name="l01077"></a>01077         time_out = <a class="code" href="a00297.html#51a9ec9ebf3d92c8137776db8f8442c6" title="Short interframe space between DATA and ACK.">SIFS</a> + <a class="code" href="a00086.html#6732e4a776e78432bf5dd9dd26de2f7d" title="computes the duration of a transmission over the physical channel, given a certain...">packetDuration</a>(<a class="code" href="a00297.html#51ede2d449cc2280250de6b6bfe78ad0" title="standard frame lengths (in bit)">LENGTH_RTS</a>, br) + <a class="code" href="a00086.html#6732e4a776e78432bf5dd9dd26de2f7d" title="computes the duration of a transmission over the physical channel, given a certain...">packetDuration</a>(<a class="code" href="a00297.html#0904361ff428ae58f8c790bef1cefb4c">LENGTH_CTS</a>, br) + <a class="code" href="a00086.html#b9f0ea820748af6d640569fc76f39659" title="Very small value used in timer scheduling in order to avoid multiple changements...">delta</a>;
<a name="l01078"></a>01078         EV &lt;&lt; <span class="stringliteral">" Mac80211::timeOut RTS "</span> &lt;&lt; time_out &lt;&lt; <span class="stringliteral">"\n"</span>;
<a name="l01079"></a>01079         <span class="keywordflow">break</span>;
<a name="l01080"></a>01080     <span class="keywordflow">case</span> <a class="code" href="a00086.html#e423db101e8431b0cbd67c347076c44a3e44931a7b0bf9a1f060898544c94467">DATA</a>:
<a name="l01081"></a>01081         time_out = <a class="code" href="a00297.html#51a9ec9ebf3d92c8137776db8f8442c6" title="Short interframe space between DATA and ACK.">SIFS</a> + <a class="code" href="a00086.html#6732e4a776e78432bf5dd9dd26de2f7d" title="computes the duration of a transmission over the physical channel, given a certain...">packetDuration</a>(<a class="code" href="a00086.html#969e8e3a592dffccea28596c61b2af50" title="Buffering of messages from upper layer.">fromUpperLayer</a>.front()-&gt;getBitLength(), br) + <a class="code" href="a00086.html#6732e4a776e78432bf5dd9dd26de2f7d" title="computes the duration of a transmission over the physical channel, given a certain...">packetDuration</a>(<a class="code" href="a00297.html#2cfa720fa65b7858c072e2f274f3cd55">LENGTH_ACK</a>, br) + delta;
<a name="l01082"></a>01082         EV &lt;&lt; <span class="stringliteral">" Mac80211::timeOut DATA "</span> &lt;&lt; time_out &lt;&lt; <span class="stringliteral">"\n"</span>;
<a name="l01083"></a>01083         <span class="keywordflow">break</span>;
<a name="l01084"></a>01084     <span class="keywordflow">default</span>:
<a name="l01085"></a>01085         EV &lt;&lt; <span class="stringliteral">"Unused frame type was given when calling timeOut(), this should not happen!\n"</span>;
<a name="l01086"></a>01086     }
<a name="l01087"></a>01087     <span class="keywordflow">return</span> time_out;
<a name="l01088"></a>01088 }
</pre></div>
<p>

</div>
</div><p>
<hr><h2>Member Data Documentation</h2>
<a class="anchor" name="93a0c8f9b957d3d4cbf787b0db5438cd"></a><!-- doxytag: member="Mac80211::arp" ref="93a0c8f9b957d3d4cbf787b0db5438cd" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="a00005.html">BaseArp</a>* <a class="el" href="a00086.html#93a0c8f9b957d3d4cbf787b0db5438cd">Mac80211::arp</a><code> [protected]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Pointer to the arp module. 
<p>

<p>Definition at line <a class="el" href="a00435.html#l00232">232</a> of file <a class="el" href="a00435.html">Mac80211.h</a>.</p>

<p>Referenced by <a class="el" href="a00434.html#l00033">initialize()</a>.</p>

</div>
</div><p>
<a class="anchor" name="979883a8da4b308de4a8e79b5bbbe2e6"></a><!-- doxytag: member="Mac80211::autoBitrate" ref="979883a8da4b308de4a8e79b5bbbe2e6" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="a00086.html#979883a8da4b308de4a8e79b5bbbe2e6">Mac80211::autoBitrate</a><code> [protected]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Auto bit rate adaptation -- switch. 
<p>

<p>Definition at line <a class="el" href="a00435.html#l00281">281</a> of file <a class="el" href="a00435.html">Mac80211.h</a>.</p>

<p>Referenced by <a class="el" href="a00434.html#l00033">initialize()</a>, and <a class="el" href="a00434.html#l01178">retrieveBitrate()</a>.</p>

</div>
</div><p>
<a class="anchor" name="126c9db5a54bafa6ad74eb3ee24bd936"></a><!-- doxytag: member="Mac80211::bitrate" ref="126c9db5a54bafa6ad74eb3ee24bd936" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="a00086.html#126c9db5a54bafa6ad74eb3ee24bd936">Mac80211::bitrate</a><code> [protected]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Current bit rate at which data is transmitted. 
<p>

<p>Definition at line <a class="el" href="a00435.html#l00277">277</a> of file <a class="el" href="a00435.html">Mac80211.h</a>.</p>

<p>Referenced by <a class="el" href="a00434.html#l01191">addNeighbor()</a>, <a class="el" href="a00434.html#l00033">initialize()</a>, and <a class="el" href="a00434.html#l01178">retrieveBitrate()</a>.</p>

</div>
</div><p>
<a class="anchor" name="4b0f6dec191e5c70ee11e380deaf2f81"></a><!-- doxytag: member="Mac80211::catBitrate" ref="4b0f6dec191e5c70ee11e380deaf2f81" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="a00086.html#4b0f6dec191e5c70ee11e380deaf2f81">Mac80211::catBitrate</a><code> [protected]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
and category number 
<p>

<p>Definition at line <a class="el" href="a00435.html#l00279">279</a> of file <a class="el" href="a00435.html">Mac80211.h</a>.</p>

</div>
</div><p>
<a class="anchor" name="67eba657efe23f5e5c21904f4744261d"></a><!-- doxytag: member="Mac80211::centerFreq" ref="67eba657efe23f5e5c21904f4744261d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="a00086.html#67eba657efe23f5e5c21904f4744261d">Mac80211::centerFreq</a><code> [protected]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Stores the center frequency the Mac uses. 
<p>

<p>Definition at line <a class="el" href="a00435.html#l00274">274</a> of file <a class="el" href="a00435.html">Mac80211.h</a>.</p>

<p>Referenced by <a class="el" href="a00434.html#l01004">createSignal()</a>, and <a class="el" href="a00434.html#l00033">initialize()</a>.</p>

</div>
</div><p>
<a class="anchor" name="8104daf3041394b73fe545427cbc02d7"></a><!-- doxytag: member="Mac80211::chSenseStart" ref="8104daf3041394b73fe545427cbc02d7" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">simtime_t <a class="el" href="a00086.html#8104daf3041394b73fe545427cbc02d7">Mac80211::chSenseStart</a><code> [protected]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Stores the the time a channel sensing started. Used to calculate the quiet-time of the channel if the sensing was aborted. 
<p>

<p>Definition at line <a class="el" href="a00435.html#l00258">258</a> of file <a class="el" href="a00435.html">Mac80211.h</a>.</p>

<p>Referenced by <a class="el" href="a00434.html#l00120">senseChannelWhileIdle()</a>, and <a class="el" href="a00434.html#l01127">suspendContention()</a>.</p>

</div>
</div><p>
<a class="anchor" name="7bd4f3adc205b150f9fa406fa582f0b6"></a><!-- doxytag: member="Mac80211::contention" ref="7bd4f3adc205b150f9fa406fa582f0b6" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ChannelSenseRequest* <a class="el" href="a00086.html#7bd4f3adc205b150f9fa406fa582f0b6">Mac80211::contention</a><code> [protected]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Used to sense if the channel is idle for contention periods. 
<p>

<p>Definition at line <a class="el" href="a00435.html#l00250">250</a> of file <a class="el" href="a00435.html">Mac80211.h</a>.</p>

<p>Referenced by <a class="el" href="a00434.html#l00924">beginNewCycle()</a>, <a class="el" href="a00434.html#l01232">finish()</a>, <a class="el" href="a00434.html#l00562">handleBroadcastMsg()</a>, <a class="el" href="a00434.html#l00585">handleEndContentionTimer()</a>, <a class="el" href="a00434.html#l00244">handleLowerControl()</a>, <a class="el" href="a00434.html#l00216">handleLowerMsg()</a>, <a class="el" href="a00434.html#l00397">handleMsgForMe()</a>, <a class="el" href="a00434.html#l00327">handleMsgNotForMe()</a>, <a class="el" href="a00434.html#l00033">initialize()</a>, <a class="el" href="a00434.html#l00120">senseChannelWhileIdle()</a>, and <a class="el" href="a00434.html#l01127">suspendContention()</a>.</p>

</div>
</div><p>
<a class="anchor" name="4a9d1c8d45c46f18afa0f07f5b6572f4"></a><!-- doxytag: member="Mac80211::currentIFS" ref="4a9d1c8d45c46f18afa0f07f5b6572f4" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">simtime_t <a class="el" href="a00086.html#4a9d1c8d45c46f18afa0f07f5b6572f4">Mac80211::currentIFS</a><code> [protected]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
current IFS value (DIFS or EIFS) If an error has been detected, the next backoff requires EIFS, once a valid frame has been received, resets to DIFS. 
<p>

<p>Definition at line <a class="el" href="a00435.html#l00313">313</a> of file <a class="el" href="a00435.html">Mac80211.h</a>.</p>

<p>Referenced by <a class="el" href="a00434.html#l00924">beginNewCycle()</a>, <a class="el" href="a00434.html#l00244">handleLowerControl()</a>, <a class="el" href="a00434.html#l00216">handleLowerMsg()</a>, <a class="el" href="a00434.html#l00327">handleMsgNotForMe()</a>, <a class="el" href="a00434.html#l00033">initialize()</a>, and <a class="el" href="a00434.html#l01127">suspendContention()</a>.</p>

</div>
</div><p>
<a class="anchor" name="226566e4a56cfed2928acc87ff3af90a"></a><!-- doxytag: member="Mac80211::defaultBitrate" ref="226566e4a56cfed2928acc87ff3af90a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="a00086.html#226566e4a56cfed2928acc87ff3af90a">Mac80211::defaultBitrate</a><code> [protected]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Default bitrate. 
<p>
The default bitrate must be set in the omnetpp.ini. It is used whenever an auto bitrate is not appropriate, like broadcasts. 
<p>Definition at line <a class="el" href="a00435.html#l00268">268</a> of file <a class="el" href="a00435.html">Mac80211.h</a>.</p>

<p>Referenced by <a class="el" href="a00434.html#l00033">initialize()</a>, and <a class="el" href="a00434.html#l01178">retrieveBitrate()</a>.</p>

</div>
</div><p>
<a class="anchor" name="b9f0ea820748af6d640569fc76f39659"></a><!-- doxytag: member="Mac80211::delta" ref="b9f0ea820748af6d640569fc76f39659" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">simtime_t <a class="el" href="a00086.html#b9f0ea820748af6d640569fc76f39659">Mac80211::delta</a><code> [protected]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Very small value used in timer scheduling in order to avoid multiple changements of state in the same simulation time. 
<p>

<p>Definition at line <a class="el" href="a00435.html#l00320">320</a> of file <a class="el" href="a00435.html">Mac80211.h</a>.</p>

<p>Referenced by <a class="el" href="a00434.html#l00033">initialize()</a>, <a class="el" href="a00434.html#l00860">sendCTSframe()</a>, and <a class="el" href="a00434.html#l01070">timeOut()</a>.</p>

</div>
</div><p>
<a class="anchor" name="ce80836b6fcb1681f6b2d49466f87fb0"></a><!-- doxytag: member="Mac80211::endSifs" ref="ce80836b6fcb1681f6b2d49466f87fb0" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ChannelSenseRequest* <a class="el" href="a00086.html#ce80836b6fcb1681f6b2d49466f87fb0">Mac80211::endSifs</a><code> [protected]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<a class="el" href="a00137.html">Timer</a> used to indicate the end of a SIFS. 
<p>

<p>Definition at line <a class="el" href="a00435.html#l00253">253</a> of file <a class="el" href="a00435.html">Mac80211.h</a>.</p>

<p>Referenced by <a class="el" href="a00434.html#l01232">finish()</a>, <a class="el" href="a00434.html#l00543">handleCTSframe()</a>, <a class="el" href="a00434.html#l00493">handleDATAframe()</a>, <a class="el" href="a00434.html#l00683">handleEndSifsTimer()</a>, <a class="el" href="a00434.html#l00244">handleLowerControl()</a>, <a class="el" href="a00434.html#l00478">handleRTSframe()</a>, <a class="el" href="a00434.html#l00135">handleUpperMsg()</a>, and <a class="el" href="a00434.html#l00033">initialize()</a>.</p>

</div>
</div><p>
<a class="anchor" name="969e8e3a592dffccea28596c61b2af50"></a><!-- doxytag: member="Mac80211::fromUpperLayer" ref="969e8e3a592dffccea28596c61b2af50" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="a00086.html#565ab82077f95d80ec44a4a4fed08ab9">MacPktList</a> <a class="el" href="a00086.html#969e8e3a592dffccea28596c61b2af50">Mac80211::fromUpperLayer</a><code> [protected]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Buffering of messages from upper layer. 
<p>

<p>Definition at line <a class="el" href="a00435.html#l00293">293</a> of file <a class="el" href="a00435.html">Mac80211.h</a>.</p>

<p>Referenced by <a class="el" href="a00434.html#l00924">beginNewCycle()</a>, <a class="el" href="a00434.html#l01232">finish()</a>, <a class="el" href="a00434.html#l00520">handleACKframe()</a>, <a class="el" href="a00434.html#l00585">handleEndContentionTimer()</a>, <a class="el" href="a00434.html#l00683">handleEndSifsTimer()</a>, <a class="el" href="a00434.html#l00327">handleMsgNotForMe()</a>, <a class="el" href="a00434.html#l00652">handleTimeoutTimer()</a>, <a class="el" href="a00434.html#l00135">handleUpperMsg()</a>, <a class="el" href="a00434.html#l00897">sendBROADCASTframe()</a>, <a class="el" href="a00434.html#l00742">sendDATAframe()</a>, <a class="el" href="a00434.html#l00818">sendRTSframe()</a>, <a class="el" href="a00434.html#l00988">testMaxAttempts()</a>, and <a class="el" href="a00434.html#l01070">timeOut()</a>.</p>

</div>
</div><p>
<a class="anchor" name="026837b7167d230bbe79a1e0630c7578"></a><!-- doxytag: member="Mac80211::fsc" ref="026837b7167d230bbe79a1e0630c7578" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="a00086.html#026837b7167d230bbe79a1e0630c7578">Mac80211::fsc</a><code> [protected]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
sequence control -- to detect duplicates 
<p>Definition at line <a class="el" href="a00435.html#l00333">333</a> of file <a class="el" href="a00435.html">Mac80211.h</a>.</p>

<p>Referenced by <a class="el" href="a00434.html#l00172">encapsMsg()</a>, and <a class="el" href="a00434.html#l00033">initialize()</a>.</p>

</div>
</div><p>
<a class="anchor" name="11fb608b3564e2d2cd41b463b1a8cc90"></a><!-- doxytag: member="Mac80211::longRetryCounter" ref="11fb608b3564e2d2cd41b463b1a8cc90" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned <a class="el" href="a00086.html#11fb608b3564e2d2cd41b463b1a8cc90">Mac80211::longRetryCounter</a><code> [protected]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Number of frame transmission attempt. 
<p>
Incremented when the SHORT_RETRY_LIMIT is hit, or when an ACK or CTS is missing. 
<p>Definition at line <a class="el" href="a00435.html#l00300">300</a> of file <a class="el" href="a00435.html">Mac80211.h</a>.</p>

<p>Referenced by <a class="el" href="a00434.html#l00973">backoff()</a>, <a class="el" href="a00434.html#l00520">handleACKframe()</a>, <a class="el" href="a00434.html#l00725">handleEndTransmission()</a>, <a class="el" href="a00434.html#l00327">handleMsgNotForMe()</a>, <a class="el" href="a00434.html#l00652">handleTimeoutTimer()</a>, <a class="el" href="a00434.html#l00033">initialize()</a>, <a class="el" href="a00434.html#l01178">retrieveBitrate()</a>, and <a class="el" href="a00434.html#l00988">testMaxAttempts()</a>.</p>

</div>
</div><p>
<a class="anchor" name="ac2e4050e1e1277556033521e3a296d5"></a><!-- doxytag: member="Mac80211::myMacAddr" ref="ac2e4050e1e1277556033521e3a296d5" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="a00086.html#ac2e4050e1e1277556033521e3a296d5">Mac80211::myMacAddr</a><code> [protected]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
MAC address (obtained from arp module). 
<p>

<p>Reimplemented from <a class="el" href="a00017.html#b4c8f97d540fc49277ab3a08e41a0c6f">BaseMacLayer</a>.</p>

<p>Definition at line <a class="el" href="a00435.html#l00237">237</a> of file <a class="el" href="a00435.html">Mac80211.h</a>.</p>

<p>Referenced by <a class="el" href="a00434.html#l00172">encapsMsg()</a>, <a class="el" href="a00434.html#l00216">handleLowerMsg()</a>, <a class="el" href="a00434.html#l00033">initialize()</a>, <a class="el" href="a00434.html#l00782">sendACKframe()</a>, <a class="el" href="a00434.html#l00860">sendCTSframe()</a>, and <a class="el" href="a00434.html#l00742">sendDATAframe()</a>.</p>

</div>
</div><p>
<a class="anchor" name="35efb0198d0085a341aba515bec9146f"></a><!-- doxytag: member="Mac80211::nav" ref="35efb0198d0085a341aba515bec9146f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">cMessage* <a class="el" href="a00086.html#35efb0198d0085a341aba515bec9146f">Mac80211::nav</a><code> [protected]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<a class="el" href="a00137.html">Timer</a> used for the defer time of a node. Also called NAV : networks allocation vector. 
<p>

<p>Definition at line <a class="el" href="a00435.html#l00247">247</a> of file <a class="el" href="a00435.html">Mac80211.h</a>.</p>

<p>Referenced by <a class="el" href="a00434.html#l00924">beginNewCycle()</a>, <a class="el" href="a00434.html#l01232">finish()</a>, <a class="el" href="a00434.html#l00327">handleMsgNotForMe()</a>, and <a class="el" href="a00434.html#l00033">initialize()</a>.</p>

</div>
</div><p>
<a class="anchor" name="ede2e9e4e32ef871e3a59c51564123de"></a><!-- doxytag: member="Mac80211::neighborhoodCacheMaxAge" ref="ede2e9e4e32ef871e3a59c51564123de" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">simtime_t <a class="el" href="a00086.html#ede2e9e4e32ef871e3a59c51564123de">Mac80211::neighborhoodCacheMaxAge</a><code> [protected]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Consider information in cache outdate if it is older than this. 
<p>

<p>Definition at line <a class="el" href="a00435.html#l00325">325</a> of file <a class="el" href="a00435.html">Mac80211.h</a>.</p>

<p>Referenced by <a class="el" href="a00434.html#l00033">initialize()</a>, and <a class="el" href="a00434.html#l01178">retrieveBitrate()</a>.</p>

</div>
</div><p>
<a class="anchor" name="e62ff2c9617e5782f6f7231e36d1574d"></a><!-- doxytag: member="Mac80211::neighborhoodCacheSize" ref="e62ff2c9617e5782f6f7231e36d1574d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned <a class="el" href="a00086.html#e62ff2c9617e5782f6f7231e36d1574d">Mac80211::neighborhoodCacheSize</a><code> [protected]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Keep information for this many neighbors. 
<p>

<p>Definition at line <a class="el" href="a00435.html#l00323">323</a> of file <a class="el" href="a00435.html">Mac80211.h</a>.</p>

<p>Referenced by <a class="el" href="a00434.html#l01191">addNeighbor()</a>, and <a class="el" href="a00434.html#l00033">initialize()</a>.</p>

</div>
</div><p>
<a class="anchor" name="4caf1f3c2c004851555c9c691b82edf9"></a><!-- doxytag: member="Mac80211::neighbors" ref="4caf1f3c2c004851555c9c691b82edf9" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="a00086.html#072f068412a3577d8d11ca98c52a9c48">NeighborList</a> <a class="el" href="a00086.html#4caf1f3c2c004851555c9c691b82edf9">Mac80211::neighbors</a><code> [protected]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="a00435.html#l00327">327</a> of file <a class="el" href="a00435.html">Mac80211.h</a>.</p>

<p>Referenced by <a class="el" href="a00434.html#l01191">addNeighbor()</a>, <a class="el" href="a00435.html#l00193">findNeighbor()</a>, <a class="el" href="a00435.html#l00202">findOldestNeighbor()</a>, <a class="el" href="a00434.html#l00493">handleDATAframe()</a>, and <a class="el" href="a00434.html#l01178">retrieveBitrate()</a>.</p>

</div>
</div><p>
<a class="anchor" name="5d8e9b53c8d6cb0116feed506d843e18"></a><!-- doxytag: member="Mac80211::nextIsBroadcast" ref="5d8e9b53c8d6cb0116feed506d843e18" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="a00086.html#5d8e9b53c8d6cb0116feed506d843e18">Mac80211::nextIsBroadcast</a><code> [protected]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Boolean used to know if the next packet is a broadcast packet. 
<p>

<p>Definition at line <a class="el" href="a00435.html#l00290">290</a> of file <a class="el" href="a00435.html">Mac80211.h</a>.</p>

<p>Referenced by <a class="el" href="a00434.html#l00924">beginNewCycle()</a>, <a class="el" href="a00434.html#l00585">handleEndContentionTimer()</a>, and <a class="el" href="a00434.html#l00725">handleEndTransmission()</a>.</p>

</div>
</div><p>
<a class="anchor" name="e8892c105c3f0fb2b6f28634bb099f31"></a><!-- doxytag: member="Mac80211::queueLength" ref="e8892c105c3f0fb2b6f28634bb099f31" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned <a class="el" href="a00086.html#e8892c105c3f0fb2b6f28634bb099f31">Mac80211::queueLength</a><code> [protected]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Maximal number of packets in the queue; should be set in the omnetpp.ini. 
<p>

<p>Definition at line <a class="el" href="a00435.html#l00287">287</a> of file <a class="el" href="a00435.html">Mac80211.h</a>.</p>

<p>Referenced by <a class="el" href="a00434.html#l00135">handleUpperMsg()</a>, and <a class="el" href="a00434.html#l00033">initialize()</a>.</p>

</div>
</div><p>
<a class="anchor" name="58484d1a6f2031548d433d18438042e9"></a><!-- doxytag: member="Mac80211::remainingBackoff" ref="58484d1a6f2031548d433d18438042e9" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">simtime_t <a class="el" href="a00086.html#58484d1a6f2031548d433d18438042e9">Mac80211::remainingBackoff</a><code> [protected]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
remaining backoff time. If the backoff timer is interrupted, this variable holds the remaining backoff time. 
<p>

<p>Definition at line <a class="el" href="a00435.html#l00308">308</a> of file <a class="el" href="a00435.html">Mac80211.h</a>.</p>

<p>Referenced by <a class="el" href="a00434.html#l00924">beginNewCycle()</a>, <a class="el" href="a00434.html#l00520">handleACKframe()</a>, <a class="el" href="a00434.html#l00585">handleEndContentionTimer()</a>, <a class="el" href="a00434.html#l00725">handleEndTransmission()</a>, <a class="el" href="a00434.html#l00652">handleTimeoutTimer()</a>, <a class="el" href="a00434.html#l00033">initialize()</a>, and <a class="el" href="a00434.html#l01127">suspendContention()</a>.</p>

</div>
</div><p>
<a class="anchor" name="6ad4dd93415c98c969df05f53d739cfd"></a><!-- doxytag: member="Mac80211::rtsCtsThreshold" ref="6ad4dd93415c98c969df05f53d739cfd" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="a00086.html#6ad4dd93415c98c969df05f53d739cfd">Mac80211::rtsCtsThreshold</a><code> [protected]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Number of bits in a packet before RTS/CTS is used. 
<p>

<p>Definition at line <a class="el" href="a00435.html#l00316">316</a> of file <a class="el" href="a00435.html">Mac80211.h</a>.</p>

<p>Referenced by <a class="el" href="a00434.html#l00033">initialize()</a>, and <a class="el" href="a00435.html#l00179">rtsCts()</a>.</p>

</div>
</div><p>
<a class="anchor" name="9bbc3d71eddb62c4e12dcd500a58b0bb"></a><!-- doxytag: member="Mac80211::shortRetryCounter" ref="9bbc3d71eddb62c4e12dcd500a58b0bb" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned <a class="el" href="a00086.html#9bbc3d71eddb62c4e12dcd500a58b0bb">Mac80211::shortRetryCounter</a><code> [protected]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Number of frame transmission attempt. 
<p>

<p>Definition at line <a class="el" href="a00435.html#l00303">303</a> of file <a class="el" href="a00435.html">Mac80211.h</a>.</p>

<p>Referenced by <a class="el" href="a00434.html#l00973">backoff()</a>, <a class="el" href="a00434.html#l00520">handleACKframe()</a>, <a class="el" href="a00434.html#l00543">handleCTSframe()</a>, <a class="el" href="a00434.html#l00725">handleEndTransmission()</a>, <a class="el" href="a00434.html#l00327">handleMsgNotForMe()</a>, <a class="el" href="a00434.html#l00652">handleTimeoutTimer()</a>, <a class="el" href="a00434.html#l00033">initialize()</a>, <a class="el" href="a00434.html#l01178">retrieveBitrate()</a>, <a class="el" href="a00434.html#l00742">sendDATAframe()</a>, and <a class="el" href="a00434.html#l00988">testMaxAttempts()</a>.</p>

</div>
</div><p>
<a class="anchor" name="1cd38454a518f922ba57f68d22e2f31e"></a><!-- doxytag: member="Mac80211::snrThresholds" ref="1cd38454a518f922ba57f68d22e2f31e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;double&gt; <a class="el" href="a00086.html#1cd38454a518f922ba57f68d22e2f31e">Mac80211::snrThresholds</a><code> [protected]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Hold RSSI thresholds at which to change the bitrates. 
<p>

<p>Definition at line <a class="el" href="a00435.html#l00283">283</a> of file <a class="el" href="a00435.html">Mac80211.h</a>.</p>

<p>Referenced by <a class="el" href="a00434.html#l01191">addNeighbor()</a>, and <a class="el" href="a00434.html#l00033">initialize()</a>.</p>

</div>
</div><p>
<a class="anchor" name="56fa75f3eb056ae29b1a4b8da0035d8c"></a><!-- doxytag: member="Mac80211::state" ref="56fa75f3eb056ae29b1a4b8da0035d8c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="a00086.html#7ff0b8b49d1a93feae6f808caf5fe447">State</a> <a class="el" href="a00086.html#56fa75f3eb056ae29b1a4b8da0035d8c">Mac80211::state</a><code> [protected]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Current state of the MAC. 
<p>

<p>Definition at line <a class="el" href="a00435.html#l00261">261</a> of file <a class="el" href="a00435.html">Mac80211.h</a>.</p>

<p>Referenced by <a class="el" href="a00434.html#l00562">handleBroadcastMsg()</a>, <a class="el" href="a00434.html#l00585">handleEndContentionTimer()</a>, <a class="el" href="a00434.html#l00725">handleEndTransmission()</a>, <a class="el" href="a00434.html#l00397">handleMsgForMe()</a>, <a class="el" href="a00434.html#l00327">handleMsgNotForMe()</a>, <a class="el" href="a00434.html#l00629">handleNavTimer()</a>, <a class="el" href="a00434.html#l00652">handleTimeoutTimer()</a>, <a class="el" href="a00434.html#l00135">handleUpperMsg()</a>, <a class="el" href="a00434.html#l00033">initialize()</a>, and <a class="el" href="a00434.html#l01118">setState()</a>.</p>

</div>
</div><p>
<a class="anchor" name="9f9f566e85a76f63e63b5907bf9ad48a"></a><!-- doxytag: member="Mac80211::switching" ref="9f9f566e85a76f63e63b5907bf9ad48a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="a00086.html#9f9f566e85a76f63e63b5907bf9ad48a">Mac80211::switching</a><code> [protected]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
take care of switchover times 
<p>Definition at line <a class="el" href="a00435.html#l00330">330</a> of file <a class="el" href="a00435.html">Mac80211.h</a>.</p>

<p>Referenced by <a class="el" href="a00434.html#l00562">handleBroadcastMsg()</a>, <a class="el" href="a00434.html#l00397">handleMsgForMe()</a>, and <a class="el" href="a00434.html#l00033">initialize()</a>.</p>

</div>
</div><p>
<a class="anchor" name="2d31f97b0662b8e37f090c3b996cec82"></a><!-- doxytag: member="Mac80211::timeout" ref="2d31f97b0662b8e37f090c3b996cec82" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">cMessage* <a class="el" href="a00086.html#2d31f97b0662b8e37f090c3b996cec82">Mac80211::timeout</a><code> [protected]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<a class="el" href="a00137.html">Timer</a> used for time-outs after the transmission of a RTS, a CTS, or a DATA packet. 
<p>

<p>Definition at line <a class="el" href="a00435.html#l00243">243</a> of file <a class="el" href="a00435.html">Mac80211.h</a>.</p>

<p>Referenced by <a class="el" href="a00434.html#l01232">finish()</a>, <a class="el" href="a00434.html#l00520">handleACKframe()</a>, <a class="el" href="a00434.html#l00543">handleCTSframe()</a>, <a class="el" href="a00434.html#l00493">handleDATAframe()</a>, <a class="el" href="a00434.html#l00327">handleMsgNotForMe()</a>, <a class="el" href="a00434.html#l00033">initialize()</a>, <a class="el" href="a00434.html#l00860">sendCTSframe()</a>, <a class="el" href="a00434.html#l00742">sendDATAframe()</a>, and <a class="el" href="a00434.html#l00818">sendRTSframe()</a>.</p>

</div>
</div><p>
<a class="anchor" name="592eee2a24a6fcadd6fdf912a101719f"></a><!-- doxytag: member="Mac80211::txPower" ref="592eee2a24a6fcadd6fdf912a101719f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="a00086.html#592eee2a24a6fcadd6fdf912a101719f">Mac80211::txPower</a><code> [protected]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
The power at which data is transmitted. 
<p>

<p>Definition at line <a class="el" href="a00435.html#l00271">271</a> of file <a class="el" href="a00435.html">Mac80211.h</a>.</p>

<p>Referenced by <a class="el" href="a00434.html#l00033">initialize()</a>, <a class="el" href="a00434.html#l00782">sendACKframe()</a>, <a class="el" href="a00434.html#l00897">sendBROADCASTframe()</a>, <a class="el" href="a00434.html#l00860">sendCTSframe()</a>, <a class="el" href="a00434.html#l00742">sendDATAframe()</a>, and <a class="el" href="a00434.html#l00818">sendRTSframe()</a>.</p>

</div>
</div><p>
<hr>The documentation for this class was generated from the following files:<ul>
<li>modules/mac/<a class="el" href="a00435.html">Mac80211.h</a><li>modules/mac/<a class="el" href="a00434.html">Mac80211.cc</a></ul>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Mon Sep 28 15:57:05 2009 for MiXiM by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.8 </small></address>
</body>
</html>
