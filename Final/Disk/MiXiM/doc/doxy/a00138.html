<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>MiXiM: TimerCore Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.8 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="classes.html"><span>Class&nbsp;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>TimerCore Class Reference</h1><!-- doxytag: class="TimerCore" --><!-- doxytag: inherits="BaseModule" --><code>#include &lt;<a class="el" href="a00393.html">TimerCore.h</a>&gt;</code>
<p>
Inherits <a class="el" href="a00019.html">BaseModule</a>.
<p>
<div class="dynheader">
Collaboration diagram for TimerCore:</div>
<div class="dynsection">
<p><center><img src="a01079.png" border="0" usemap="#a01080" alt="Collaboration graph"></center>
<map name="a01080">
<area shape="rect" href="a00137.html" title="Timer" alt="" coords="25,173,79,200"><area shape="rect" href="a00019.html" title="Base class for all simple modules of a host that want to have access to the BaseUtility..." alt="" coords="5,5,99,32"></map>
<center><font size="2">[<a target="top" href="graph_legend.html">legend</a>]</font></center></div>

<p>
<a href="a01081.html">List of all members.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">typedef void()&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00138.html#8a425082874e8503554679e98183f11e">cleanup</a> (void *data)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00138.html#b111f5d18071222c5f4430882e2d26c8">~TimerCore</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00138.html#93ca5fca6ebc0721043a69a3cc83e9a9">init</a> (<a class="el" href="a00137.html">Timer</a> *t)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00138.html#b8cda9efda31e457c52cb35df35358f1">setTimer</a> (unsigned int index, simtime_t when)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">unsigned int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00138.html#82a9e53719c6d202a625fee47b3218a8">setTimer</a> (simtime_t when)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00138.html#80a71f2b5260aa27949a147e3bca52a8">cancelTimer</a> (unsigned int index)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">float&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00138.html#dd07fb2b29fe3f84f133603573f03387">remainingTimer</a> (unsigned int index)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00138.html#4c7e3a0e01131b2dfbd881a7bb457599">setContextPointer</a> (unsigned int index, void *data)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00138.html#ce137442375abc65840d74ea11fd4db3">contextPointer</a> (unsigned int index)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00138.html#6021d86b056453796b6c2f66ecec6ea6">setContextDestructor</a> (unsigned int index, cleanup *)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00138.html#75fadb3d88498e31b9abca9f859e5dc9">allocateTimers</a> (unsigned int count)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00138.html#a5222be46d94acbf8e8a23844244d72e">deleteTimer</a> (unsigned int index)</td></tr>

<tr><td colspan="2"><br><h2>Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00138.html#45735968ad7a245b9a6f118af4d4c6e3">checkExists</a> (unsigned int index)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00138.html#62c38e7d298f0b1d966b4af1a236a2b6">handleMessage</a> (cMessage *msg)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Handle self messages.  <a href="#62c38e7d298f0b1d966b4af1a236a2b6"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="a00137.html">Timer</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00138.html#fbcfe1747af562889d8bd91a5fcb5bfa">timer</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">std::map&lt; unsigned int, <br class="typebreak">
cMessage * &gt; *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00138.html#7bb31550112c82f8a480a9f4a958644e">timers</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">std::map&lt; unsigned int, <br class="typebreak">
cleanup * &gt; *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00138.html#db6c09ae23872341c8d5bbf306feff14">destructors</a></td></tr>

</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>

<p>Definition at line <a class="el" href="a00393.html#l00009">9</a> of file <a class="el" href="a00393.html">TimerCore.h</a>.</p>
<hr><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" name="b111f5d18071222c5f4430882e2d26c8"></a><!-- doxytag: member="TimerCore::~TimerCore" ref="b111f5d18071222c5f4430882e2d26c8" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TimerCore::~TimerCore           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="a00392.html#l00081">81</a> of file <a class="el" href="a00392.html">TimerCore.cc</a>.</p>

<p>References <a class="el" href="a00392.html#l00008">checkExists()</a>, <a class="el" href="a00392.html#l00113">contextPointer()</a>, <a class="el" href="a00393.html#l00018">destructors</a>, and <a class="el" href="a00393.html#l00017">timers</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00082"></a>00082 {
<a name="l00083"></a>00083   <span class="keywordflow">for</span> (std::map&lt;unsigned int,cMessage*&gt;::const_iterator p=<a class="code" href="a00138.html#7bb31550112c82f8a480a9f4a958644e">timers</a>-&gt;begin();p!=<a class="code" href="a00138.html#7bb31550112c82f8a480a9f4a958644e">timers</a>-&gt;end();p++)
<a name="l00084"></a>00084   {
<a name="l00085"></a>00085     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> index = p-&gt;second-&gt;getKind();
<a name="l00086"></a>00086     <a class="code" href="a00138.html#45735968ad7a245b9a6f118af4d4c6e3">checkExists</a>(index);
<a name="l00087"></a>00087     <span class="keywordflow">if</span> ((*<a class="code" href="a00138.html#7bb31550112c82f8a480a9f4a958644e">timers</a>)[index]-&gt;isScheduled())
<a name="l00088"></a>00088     {
<a name="l00089"></a>00089       <span class="keywordflow">if</span> ((*<a class="code" href="a00138.html#db6c09ae23872341c8d5bbf306feff14">destructors</a>)[index]!=NULL)
<a name="l00090"></a>00090         (*destructors)[index](<a class="code" href="a00138.html#ce137442375abc65840d74ea11fd4db3">contextPointer</a>(index));
<a name="l00091"></a>00091       cancelEvent((*<a class="code" href="a00138.html#7bb31550112c82f8a480a9f4a958644e">timers</a>)[index]);
<a name="l00092"></a>00092     }
<a name="l00093"></a>00093     <span class="keyword">delete</span> p-&gt;second;
<a name="l00094"></a>00094   }
<a name="l00095"></a>00095   <span class="keyword">delete</span> <a class="code" href="a00138.html#7bb31550112c82f8a480a9f4a958644e">timers</a>;
<a name="l00096"></a>00096   <span class="keyword">delete</span> <a class="code" href="a00138.html#db6c09ae23872341c8d5bbf306feff14">destructors</a>;
<a name="l00097"></a>00097 }
</pre></div>
<p>

</div>
</div><p>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="75fadb3d88498e31b9abca9f859e5dc9"></a><!-- doxytag: member="TimerCore::allocateTimers" ref="75fadb3d88498e31b9abca9f859e5dc9" args="(unsigned int count)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TimerCore::allocateTimers           </td>
          <td>(</td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>count</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="a00392.html#l00123">123</a> of file <a class="el" href="a00392.html">TimerCore.cc</a>.</p>

<p>References <a class="el" href="a00393.html#l00015">timer</a>, and <a class="el" href="a00393.html#l00017">timers</a>.</p>

<p>Referenced by <a class="el" href="a00391.html#l00112">Timer::allocateTimers()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00124"></a>00124 {
<a name="l00125"></a>00125   Enter_Method_Silent();
<a name="l00126"></a>00126   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0;i&lt;count;i++)
<a name="l00127"></a>00127   {
<a name="l00128"></a>00128     cMessage *<a class="code" href="a00138.html#fbcfe1747af562889d8bd91a5fcb5bfa">timer</a>;
<a name="l00129"></a>00129     <span class="keywordflow">if</span> (<a class="code" href="a00138.html#7bb31550112c82f8a480a9f4a958644e">timers</a>-&gt;find(i)==<a class="code" href="a00138.html#7bb31550112c82f8a480a9f4a958644e">timers</a>-&gt;end())
<a name="l00130"></a>00130     {
<a name="l00131"></a>00131       timer = <span class="keyword">new</span> cMessage(<span class="stringliteral">"timer"</span>);
<a name="l00132"></a>00132       timer-&gt;setKind(i);
<a name="l00133"></a>00133       (*timers)[i] = timer;
<a name="l00134"></a>00134     }
<a name="l00135"></a>00135   }
<a name="l00136"></a>00136 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="80a71f2b5260aa27949a147e3bca52a8"></a><!-- doxytag: member="TimerCore::cancelTimer" ref="80a71f2b5260aa27949a147e3bca52a8" args="(unsigned int index)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TimerCore::cancelTimer           </td>
          <td>(</td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>index</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Cancel an existing timer set by <b><a class="el" href="a00138.html#b8cda9efda31e457c52cb35df35358f1">setTimer()</a></b> If the timer has not been set, or has already fires, this does nothing Must call <b>initTimers()</b> before using. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>index</em>&nbsp;</td><td><a class="el" href="a00137.html">Timer</a> to cancel. Must be between 0 and the value given to <b>initTimers()</b> </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="a00392.html#l00058">58</a> of file <a class="el" href="a00392.html">TimerCore.cc</a>.</p>

<p>References <a class="el" href="a00392.html#l00008">checkExists()</a>, and <a class="el" href="a00393.html#l00017">timers</a>.</p>

<p>Referenced by <a class="el" href="a00391.html#l00076">Timer::cancelTimer()</a>, and <a class="el" href="a00392.html#l00142">deleteTimer()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00059"></a>00059 {
<a name="l00060"></a>00060   Enter_Method_Silent();
<a name="l00061"></a>00061   <a class="code" href="a00138.html#45735968ad7a245b9a6f118af4d4c6e3">checkExists</a>(index);
<a name="l00062"></a>00062   <span class="keywordflow">if</span> ((*<a class="code" href="a00138.html#7bb31550112c82f8a480a9f4a958644e">timers</a>)[index]-&gt;isScheduled())
<a name="l00063"></a>00063     cancelEvent((*<a class="code" href="a00138.html#7bb31550112c82f8a480a9f4a958644e">timers</a>)[index]);
<a name="l00064"></a>00064 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="45735968ad7a245b9a6f118af4d4c6e3"></a><!-- doxytag: member="TimerCore::checkExists" ref="45735968ad7a245b9a6f118af4d4c6e3" args="(unsigned int index)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TimerCore::checkExists           </td>
          <td>(</td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>index</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="a00392.html#l00008">8</a> of file <a class="el" href="a00392.html">TimerCore.cc</a>.</p>

<p>References <a class="el" href="a00393.html#l00017">timers</a>.</p>

<p>Referenced by <a class="el" href="a00392.html#l00058">cancelTimer()</a>, <a class="el" href="a00392.html#l00113">contextPointer()</a>, <a class="el" href="a00392.html#l00066">remainingTimer()</a>, <a class="el" href="a00392.html#l00075">setContextDestructor()</a>, <a class="el" href="a00392.html#l00103">setContextPointer()</a>, and <a class="el" href="a00392.html#l00081">~TimerCore()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00009"></a>00009 {
<a name="l00010"></a>00010   <span class="keywordflow">if</span> (<a class="code" href="a00138.html#7bb31550112c82f8a480a9f4a958644e">timers</a>-&gt;find(index)==<a class="code" href="a00138.html#7bb31550112c82f8a480a9f4a958644e">timers</a>-&gt;end())
<a name="l00011"></a>00011     error(<span class="stringliteral">" timer index %u doesn't exist"</span>, index);
<a name="l00012"></a>00012 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="8a425082874e8503554679e98183f11e"></a><!-- doxytag: member="TimerCore::cleanup" ref="8a425082874e8503554679e98183f11e" args="(void *data)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef void() TimerCore::cleanup           </td>
          <td>(</td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>data</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="ce137442375abc65840d74ea11fd4db3"></a><!-- doxytag: member="TimerCore::contextPointer" ref="ce137442375abc65840d74ea11fd4db3" args="(unsigned int index)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void * TimerCore::contextPointer           </td>
          <td>(</td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>index</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Retreive a "context pointer" refering to some piece of opaque useful data <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>index</em>&nbsp;</td><td><a class="el" href="a00137.html">Timer</a> number </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>Opaque pointer from  </dd></dl>

<p>Definition at line <a class="el" href="a00392.html#l00113">113</a> of file <a class="el" href="a00392.html">TimerCore.cc</a>.</p>

<p>References <a class="el" href="a00392.html#l00008">checkExists()</a>, and <a class="el" href="a00393.html#l00017">timers</a>.</p>

<p>Referenced by <a class="el" href="a00391.html#l00099">Timer::contextPointer()</a>, and <a class="el" href="a00392.html#l00081">~TimerCore()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00114"></a>00114 {
<a name="l00115"></a>00115   <a class="code" href="a00138.html#45735968ad7a245b9a6f118af4d4c6e3">checkExists</a>(index);
<a name="l00116"></a>00116   <span class="keywordflow">return</span> (*<a class="code" href="a00138.html#7bb31550112c82f8a480a9f4a958644e">timers</a>)[index]-&gt;getContextPointer();
<a name="l00117"></a>00117 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="a5222be46d94acbf8e8a23844244d72e"></a><!-- doxytag: member="TimerCore::deleteTimer" ref="a5222be46d94acbf8e8a23844244d72e" args="(unsigned int index)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TimerCore::deleteTimer           </td>
          <td>(</td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>index</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="a00392.html#l00142">142</a> of file <a class="el" href="a00392.html">TimerCore.cc</a>.</p>

<p>References <a class="el" href="a00392.html#l00058">cancelTimer()</a>, and <a class="el" href="a00393.html#l00017">timers</a>.</p>

<p>Referenced by <a class="el" href="a00391.html#l00124">Timer::deleteTimer()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00143"></a>00143 {
<a name="l00144"></a>00144   <span class="keywordflow">if</span> (<a class="code" href="a00138.html#7bb31550112c82f8a480a9f4a958644e">timers</a>-&gt;find(index)!=<a class="code" href="a00138.html#7bb31550112c82f8a480a9f4a958644e">timers</a>-&gt;end())
<a name="l00145"></a>00145   {
<a name="l00146"></a>00146     <a class="code" href="a00138.html#80a71f2b5260aa27949a147e3bca52a8">cancelTimer</a>(index);
<a name="l00147"></a>00147     <span class="keyword">delete</span> <a class="code" href="a00138.html#7bb31550112c82f8a480a9f4a958644e">timers</a>-&gt;find(index)-&gt;second;
<a name="l00148"></a>00148     <a class="code" href="a00138.html#7bb31550112c82f8a480a9f4a958644e">timers</a>-&gt;erase(<a class="code" href="a00138.html#7bb31550112c82f8a480a9f4a958644e">timers</a>-&gt;find(index));
<a name="l00149"></a>00149   }
<a name="l00150"></a>00150 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="62c38e7d298f0b1d966b4af1a236a2b6"></a><!-- doxytag: member="TimerCore::handleMessage" ref="62c38e7d298f0b1d966b4af1a236a2b6" args="(cMessage *msg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TimerCore::handleMessage           </td>
          <td>(</td>
          <td class="paramtype">cMessage *&nbsp;</td>
          <td class="paramname"> <em>msg</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Handle self messages. 
<p>

<p>Definition at line <a class="el" href="a00392.html#l00014">14</a> of file <a class="el" href="a00392.html">TimerCore.cc</a>.</p>

<p>References <a class="el" href="a00137.html#2173406797e96aa63b965e25a9be498e">Timer::handleTimer()</a>, and <a class="el" href="a00393.html#l00015">timer</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00015"></a>00015 {
<a name="l00016"></a>00016   assert(msg-&gt;isSelfMessage());
<a name="l00017"></a>00017   <span class="comment">//simulation.setContextModule(timer-&gt;owner);  </span>
<a name="l00018"></a>00018   <a class="code" href="a00138.html#fbcfe1747af562889d8bd91a5fcb5bfa">timer</a>-&gt;<a class="code" href="a00137.html#2173406797e96aa63b965e25a9be498e">handleTimer</a>(msg-&gt;getKind());
<a name="l00019"></a>00019 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="93ca5fca6ebc0721043a69a3cc83e9a9"></a><!-- doxytag: member="TimerCore::init" ref="93ca5fca6ebc0721043a69a3cc83e9a9" args="(Timer *t)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TimerCore::init           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00137.html">Timer</a> *&nbsp;</td>
          <td class="paramname"> <em>t</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="a00392.html#l00021">21</a> of file <a class="el" href="a00392.html">TimerCore.cc</a>.</p>

<p>References <a class="el" href="a00393.html#l00018">destructors</a>, <a class="el" href="a00393.html#l00015">timer</a>, and <a class="el" href="a00393.html#l00017">timers</a>.</p>

<p>Referenced by <a class="el" href="a00390.html#l00004">Timer::init()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00022"></a>00022 {
<a name="l00023"></a>00023   <a class="code" href="a00138.html#fbcfe1747af562889d8bd91a5fcb5bfa">timer</a> = owner;
<a name="l00024"></a>00024   <a class="code" href="a00138.html#7bb31550112c82f8a480a9f4a958644e">timers</a> = <span class="keyword">new</span> std::map&lt;unsigned int,cMessage *&gt;();
<a name="l00025"></a>00025   <a class="code" href="a00138.html#db6c09ae23872341c8d5bbf306feff14">destructors</a> = <span class="keyword">new</span> std::map&lt;unsigned int,cleanup *&gt;();
<a name="l00026"></a>00026 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="dd07fb2b29fe3f84f133603573f03387"></a><!-- doxytag: member="TimerCore::remainingTimer" ref="dd07fb2b29fe3f84f133603573f03387" args="(unsigned int index)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float TimerCore::remainingTimer           </td>
          <td>(</td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>index</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Fires on expiration of a timer. Fires after a call to <b><a class="el" href="a00138.html#b8cda9efda31e457c52cb35df35358f1">setTimer()</a></b>. Subclasses should override this. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>index</em>&nbsp;</td><td><a class="el" href="a00137.html">Timer</a> number that fired. Will be between 0 and the value given to <b>initTimers()</b> </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="a00392.html#l00066">66</a> of file <a class="el" href="a00392.html">TimerCore.cc</a>.</p>

<p>References <a class="el" href="a00392.html#l00008">checkExists()</a>, and <a class="el" href="a00393.html#l00017">timers</a>.</p>

<p>Referenced by <a class="el" href="a00391.html#l00082">Timer::remainingTimer()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00067"></a>00067 {
<a name="l00068"></a>00068   <a class="code" href="a00138.html#45735968ad7a245b9a6f118af4d4c6e3">checkExists</a>(index);
<a name="l00069"></a>00069   <span class="keywordflow">if</span> ((*<a class="code" href="a00138.html#7bb31550112c82f8a480a9f4a958644e">timers</a>)[index]-&gt;isScheduled())
<a name="l00070"></a>00070     <span class="keywordflow">return</span> SIMTIME_DBL((*<a class="code" href="a00138.html#7bb31550112c82f8a480a9f4a958644e">timers</a>)[index]-&gt;getArrivalTime()-simTime());
<a name="l00071"></a>00071   <span class="keywordflow">else</span>
<a name="l00072"></a>00072     <span class="keywordflow">return</span> -1;
<a name="l00073"></a>00073 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="6021d86b056453796b6c2f66ecec6ea6"></a><!-- doxytag: member="TimerCore::setContextDestructor" ref="6021d86b056453796b6c2f66ecec6ea6" args="(unsigned int index, cleanup *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TimerCore::setContextDestructor           </td>
          <td>(</td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">cleanup *&nbsp;</td>
          <td class="paramname"> <em>c</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Provide a destructor function for a "context pointer" such that we can do complete cleanup even if there are still timers remaining at the end of a simulation. Called on end of sim for still scheduled timers. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>index</em>&nbsp;</td><td><a class="el" href="a00137.html">Timer</a> number </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="a00392.html#l00075">75</a> of file <a class="el" href="a00392.html">TimerCore.cc</a>.</p>

<p>References <a class="el" href="a00392.html#l00008">checkExists()</a>.</p>

<p>Referenced by <a class="el" href="a00391.html#l00106">Timer::setContextDestructor()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00076"></a>00076 {
<a name="l00077"></a>00077   <a class="code" href="a00138.html#45735968ad7a245b9a6f118af4d4c6e3">checkExists</a>(index);
<a name="l00078"></a>00078   (*destructors)[index] = c;
<a name="l00079"></a>00079 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="4c7e3a0e01131b2dfbd881a7bb457599"></a><!-- doxytag: member="TimerCore::setContextPointer" ref="4c7e3a0e01131b2dfbd881a7bb457599" args="(unsigned int index, void *data)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TimerCore::setContextPointer           </td>
          <td>(</td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>data</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Set a "context pointer" refering to some piece of opaque useful data <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>index</em>&nbsp;</td><td><a class="el" href="a00137.html">Timer</a> number </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>data</em>&nbsp;</td><td>Opaque pointer. Never free'd or dereferenced </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="a00392.html#l00103">103</a> of file <a class="el" href="a00392.html">TimerCore.cc</a>.</p>

<p>References <a class="el" href="a00392.html#l00008">checkExists()</a>.</p>

<p>Referenced by <a class="el" href="a00391.html#l00093">Timer::setContextPointer()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00104"></a>00104 {
<a name="l00105"></a>00105   <a class="code" href="a00138.html#45735968ad7a245b9a6f118af4d4c6e3">checkExists</a>(index);
<a name="l00106"></a>00106   (*timers)[index]-&gt;setContextPointer(data);
<a name="l00107"></a>00107 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="82a9e53719c6d202a625fee47b3218a8"></a><!-- doxytag: member="TimerCore::setTimer" ref="82a9e53719c6d202a625fee47b3218a8" args="(simtime_t when)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int TimerCore::setTimer           </td>
          <td>(</td>
          <td class="paramtype">simtime_t&nbsp;</td>
          <td class="paramname"> <em>when</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Set a timer to fire at a point in the future. Auto-generates a timer id that's guaranteed not to have been used by anyone else. If the timer with that id has already been set then this discards the old information. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>when</em>&nbsp;</td><td>Time in seconds in the future to fire the timer </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd><a class="el" href="a00137.html">Timer</a> id </dd></dl>

<p>Definition at line <a class="el" href="a00392.html#l00028">28</a> of file <a class="el" href="a00392.html">TimerCore.cc</a>.</p>

<p>References <a class="el" href="a00392.html#l00037">setTimer()</a>, and <a class="el" href="a00393.html#l00017">timers</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00029"></a>00029 {
<a name="l00030"></a>00030   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> key = <a class="code" href="a00138.html#7bb31550112c82f8a480a9f4a958644e">timers</a>-&gt;size();
<a name="l00031"></a>00031   <span class="keywordflow">while</span> (<a class="code" href="a00138.html#7bb31550112c82f8a480a9f4a958644e">timers</a>-&gt;find(key)!=<a class="code" href="a00138.html#7bb31550112c82f8a480a9f4a958644e">timers</a>-&gt;end())
<a name="l00032"></a>00032     key++;
<a name="l00033"></a>00033   <a class="code" href="a00138.html#b8cda9efda31e457c52cb35df35358f1">setTimer</a>(key,when);
<a name="l00034"></a>00034   <span class="keywordflow">return</span> key;
<a name="l00035"></a>00035 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="b8cda9efda31e457c52cb35df35358f1"></a><!-- doxytag: member="TimerCore::setTimer" ref="b8cda9efda31e457c52cb35df35358f1" args="(unsigned int index, simtime_t when)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TimerCore::setTimer           </td>
          <td>(</td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">simtime_t&nbsp;</td>
          <td class="paramname"> <em>when</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Set a timer to fire at a point in the future. If the timer with that id has already been set then this discards the old information. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>index</em>&nbsp;</td><td><a class="el" href="a00137.html">Timer</a> number to set. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>when</em>&nbsp;</td><td>Time in seconds in the future to fire the timer </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="a00392.html#l00037">37</a> of file <a class="el" href="a00392.html">TimerCore.cc</a>.</p>

<p>References <a class="el" href="a00393.html#l00015">timer</a>, and <a class="el" href="a00393.html#l00017">timers</a>.</p>

<p>Referenced by <a class="el" href="a00392.html#l00028">setTimer()</a>, and <a class="el" href="a00391.html#l00061">Timer::setTimer()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00038"></a>00038 {
<a name="l00039"></a>00039   Enter_Method_Silent();
<a name="l00040"></a>00040   cMessage *<a class="code" href="a00138.html#fbcfe1747af562889d8bd91a5fcb5bfa">timer</a>;
<a name="l00041"></a>00041   <span class="keywordflow">if</span> (<a class="code" href="a00138.html#7bb31550112c82f8a480a9f4a958644e">timers</a>-&gt;find(index)==<a class="code" href="a00138.html#7bb31550112c82f8a480a9f4a958644e">timers</a>-&gt;end())
<a name="l00042"></a>00042   {
<a name="l00043"></a>00043     timer = <span class="keyword">new</span> cMessage(<span class="stringliteral">"timer"</span>);
<a name="l00044"></a>00044     timer-&gt;setKind(index);
<a name="l00045"></a>00045     (*timers)[index] = timer;
<a name="l00046"></a>00046     (*destructors)[index] = NULL;
<a name="l00047"></a>00047   }
<a name="l00048"></a>00048   <span class="keywordflow">else</span>
<a name="l00049"></a>00049   {
<a name="l00050"></a>00050     timer = (*timers)[index];
<a name="l00051"></a>00051     <span class="keywordflow">if</span> (timer-&gt;isScheduled())
<a name="l00052"></a>00052       cancelEvent(timer);
<a name="l00053"></a>00053   }
<a name="l00054"></a>00054 
<a name="l00055"></a>00055   scheduleAt(simTime() + when, timer);  
<a name="l00056"></a>00056 }
</pre></div>
<p>

</div>
</div><p>
<hr><h2>Member Data Documentation</h2>
<a class="anchor" name="db6c09ae23872341c8d5bbf306feff14"></a><!-- doxytag: member="TimerCore::destructors" ref="db6c09ae23872341c8d5bbf306feff14" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt;unsigned int, cleanup*&gt;* <a class="el" href="a00138.html#db6c09ae23872341c8d5bbf306feff14">TimerCore::destructors</a><code> [protected]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="a00393.html#l00018">18</a> of file <a class="el" href="a00393.html">TimerCore.h</a>.</p>

<p>Referenced by <a class="el" href="a00392.html#l00021">init()</a>, and <a class="el" href="a00392.html#l00081">~TimerCore()</a>.</p>

</div>
</div><p>
<a class="anchor" name="fbcfe1747af562889d8bd91a5fcb5bfa"></a><!-- doxytag: member="TimerCore::timer" ref="fbcfe1747af562889d8bd91a5fcb5bfa" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="a00137.html">Timer</a>* <a class="el" href="a00138.html#fbcfe1747af562889d8bd91a5fcb5bfa">TimerCore::timer</a><code> [protected]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="a00393.html#l00015">15</a> of file <a class="el" href="a00393.html">TimerCore.h</a>.</p>

<p>Referenced by <a class="el" href="a00392.html#l00123">allocateTimers()</a>, <a class="el" href="a00392.html#l00014">handleMessage()</a>, <a class="el" href="a00392.html#l00021">init()</a>, and <a class="el" href="a00392.html#l00037">setTimer()</a>.</p>

</div>
</div><p>
<a class="anchor" name="7bb31550112c82f8a480a9f4a958644e"></a><!-- doxytag: member="TimerCore::timers" ref="7bb31550112c82f8a480a9f4a958644e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt;unsigned int, cMessage *&gt;* <a class="el" href="a00138.html#7bb31550112c82f8a480a9f4a958644e">TimerCore::timers</a><code> [protected]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="a00393.html#l00017">17</a> of file <a class="el" href="a00393.html">TimerCore.h</a>.</p>

<p>Referenced by <a class="el" href="a00392.html#l00123">allocateTimers()</a>, <a class="el" href="a00392.html#l00058">cancelTimer()</a>, <a class="el" href="a00392.html#l00008">checkExists()</a>, <a class="el" href="a00392.html#l00113">contextPointer()</a>, <a class="el" href="a00392.html#l00142">deleteTimer()</a>, <a class="el" href="a00392.html#l00021">init()</a>, <a class="el" href="a00392.html#l00066">remainingTimer()</a>, <a class="el" href="a00392.html#l00028">setTimer()</a>, and <a class="el" href="a00392.html#l00081">~TimerCore()</a>.</p>

</div>
</div><p>
<hr>The documentation for this class was generated from the following files:<ul>
<li>base/timers/<a class="el" href="a00393.html">TimerCore.h</a><li>base/timers/<a class="el" href="a00392.html">TimerCore.cc</a></ul>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Mon Sep 28 15:57:10 2009 for MiXiM by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.8 </small></address>
</body>
</html>
