<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>MiXiM: Decider80211 Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.8 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="classes.html"><span>Class&nbsp;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>Decider80211 Class Reference<br>
<small>
[<a class="el" href="a00305.html">decider - decider modules</a>]</small>
</h1><!-- doxytag: class="Decider80211" --><!-- doxytag: inherits="BaseDecider" --><a class="el" href="a00052.html" title="The basic Decider class.">Decider</a> for the 802.11 modules.  
<a href="#_details">More...</a>
<p>
<code>#include &lt;<a class="el" href="a00459.html">Decider80211.h</a>&gt;</code>
<p>
Inherits <a class="el" href="a00011.html">BaseDecider</a>.
<p>
Inherited by <a class="el" href="a00054.html">Decider80211Battery</a>.
<p>
<div class="dynheader">
Collaboration diagram for Decider80211:</div>
<div class="dynsection">
<p><center><img src="a00870.png" border="0" usemap="#a00871" alt="Collaboration graph"></center>
<map name="a00871">
<area shape="rect" href="a00011.html" title="Provides some base functionality for most common deciders." alt="" coords="7,5,103,32"></map>
<center><font size="2">[<a target="top" href="graph_legend.html">legend</a>]</font></center></div>

<p>
<a href="a00872.html">List of all members.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Public Types</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00053.html#adf94ce46e3edca3fa4d93150f72f4ae">Decider80211ControlKinds</a> { <a class="el" href="a00053.html#adf94ce46e3edca3fa4d93150f72f4ae406458adbfbedec1d989361675c3f37d">NOTHING</a> =  22100, 
<a class="el" href="a00053.html#adf94ce46e3edca3fa4d93150f72f4aee12bbafd7ed8d0978ac925c1a493aabb">BITERROR</a>, 
<a class="el" href="a00053.html#adf94ce46e3edca3fa4d93150f72f4aee5c2edad30720b7e527373b28bd4e1ab">COLLISION</a>, 
<a class="el" href="a00053.html#adf94ce46e3edca3fa4d93150f72f4ae397fbae93de43832a0bb2bc1bf7003a5">LAST_DECIDER_80211_CONTROL_KIND</a>
 }</td></tr>

<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00053.html#07a5fe046d32020b189f73f5bbf4f010">Decider80211</a> (<a class="el" href="a00057.html">DeciderToPhyInterface</a> *<a class="el" href="a00052.html#e47e3459af2a4a7a1f14f6e60d2fc4c8">phy</a>, double threshold, double <a class="el" href="a00011.html#5eece8bf532f92912ccbd0a3bc4d6fb0">sensitivity</a>, double <a class="el" href="a00053.html#15af6d061ab83d73474b6b94684707b6">centerFrequency</a>, int <a class="el" href="a00011.html#33e7f02028e78116193d09d6cdbc987e">myIndex</a>=-1, bool <a class="el" href="a00011.html#a22cd5156240713e37578172ba5557ce">debug</a>=false)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initializes the <a class="el" href="a00052.html" title="The basic Decider class.">Decider</a> with a pointer to its <a class="el" href="a00109.html" title="Provides initialisation for several AnalogueModels and Deciders from modules directory...">PhyLayer</a> and specific values for threshold and sensitivity.  <a href="#07a5fe046d32020b189f73f5bbf4f010"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00053.html#46c5172b26f2e0bce6454b178d8b4998">~Decider80211</a> ()</td></tr>

<tr><td colspan="2"><br><h2>Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual <a class="el" href="a00055.html">DeciderResult</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00053.html#d765525c74deb1b88742ed8dce4271cb">checkIfSignalOk</a> (<a class="el" href="a00092.html">Mapping</a> *snrMap, AirFrame *frame)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Checks a mapping against a specific threshold (element-wise).  <a href="#d765525c74deb1b88742ed8dce4271cb"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual simtime_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00053.html#1f929f5b474f7b42c5c47acdd740cc68">processNewSignal</a> (AirFrame *frame)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Processes a new <a class="el" href="a00124.html" title="The signal class stores the physical representation of the signal of an AirFrame...">Signal</a>. Returns the time it wants to handle the signal again.  <a href="#1f929f5b474f7b42c5c47acdd740cc68"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual simtime_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00053.html#2f8e006c849f1c14f4578b70358d0ecf">processSignalEnd</a> (AirFrame *frame)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Processes a received AirFrame.  <a href="#2f8e006c849f1c14f4578b70358d0ecf"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00053.html#8fa275c3922106556c98a2f51b502794">packetOk</a> (double snirMin, int lengthMPDU, double bitrate)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">computes if packet is ok or has errors  <a href="#8fa275c3922106556c98a2f51b502794"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00053.html#3d7bfccf1c3b199842ea44b7c00e70b2">calcChannelSenseRSSI</a> (<a class="el" href="a00011.html#cf6221fc304163856f01b71710922cd3">CSRInfo</a> &amp;requestInfo)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Calculates the RSSI value for the passed ChannelSenseRequest.  <a href="#3d7bfccf1c3b199842ea44b7c00e70b2"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00053.html#252eace2ccbe59484cd209be494a3983">snrThreshold</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00053.html#15af6d061ab83d73474b6b94684707b6">centerFrequency</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The center frequency on which the decider listens for signals.  <a href="#15af6d061ab83d73474b6b94684707b6"></a><br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
<a class="el" href="a00052.html" title="The basic Decider class.">Decider</a> for the 802.11 modules. 
<p>
Depending on the minimum of the snr included in the PhySDU this module computes a bit error probability. The header (1 Mbit/s) is always modulated with DBQPSK. The PDU is normally modulated either with DBPSK (1 and 2 Mbit/s) or CCK (5.5 and 11 Mbit/s). CCK is not easy to model, therefore it is modeled as DQPSK with a 16-QAM for 5.5 Mbit/s and a 256-QAM for 11 Mbit/s.<p>
<dl class="author" compact><dt><b>Author:</b></dt><dd>Marc Lï¿½bbers, David Raguin, Karl Wessel(port for MiXiM) </dd></dl>

<p>Definition at line <a class="el" href="a00459.html#l00028">28</a> of file <a class="el" href="a00459.html">Decider80211.h</a>.</p>
<hr><h2>Member Enumeration Documentation</h2>
<a class="anchor" name="adf94ce46e3edca3fa4d93150f72f4ae"></a><!-- doxytag: member="Decider80211::Decider80211ControlKinds" ref="adf94ce46e3edca3fa4d93150f72f4ae" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="a00053.html#adf94ce46e3edca3fa4d93150f72f4ae">Decider80211::Decider80211ControlKinds</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl compact><dt><b>Enumerator: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" name="adf94ce46e3edca3fa4d93150f72f4ae406458adbfbedec1d989361675c3f37d"></a><!-- doxytag: member="NOTHING" ref="adf94ce46e3edca3fa4d93150f72f4ae406458adbfbedec1d989361675c3f37d" args="" -->NOTHING</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" name="adf94ce46e3edca3fa4d93150f72f4aee12bbafd7ed8d0978ac925c1a493aabb"></a><!-- doxytag: member="BITERROR" ref="adf94ce46e3edca3fa4d93150f72f4aee12bbafd7ed8d0978ac925c1a493aabb" args="" -->BITERROR</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" name="adf94ce46e3edca3fa4d93150f72f4aee5c2edad30720b7e527373b28bd4e1ab"></a><!-- doxytag: member="COLLISION" ref="adf94ce46e3edca3fa4d93150f72f4aee5c2edad30720b7e527373b28bd4e1ab" args="" -->COLLISION</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" name="adf94ce46e3edca3fa4d93150f72f4ae397fbae93de43832a0bb2bc1bf7003a5"></a><!-- doxytag: member="LAST_DECIDER_80211_CONTROL_KIND" ref="adf94ce46e3edca3fa4d93150f72f4ae397fbae93de43832a0bb2bc1bf7003a5" args="" -->LAST_DECIDER_80211_CONTROL_KIND</em>&nbsp;</td><td>
</td></tr>
</table>
</dl>

<p>Definition at line <a class="el" href="a00459.html#l00030">30</a> of file <a class="el" href="a00459.html">Decider80211.h</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00030"></a>00030                                 {
<a name="l00031"></a>00031     <a class="code" href="a00053.html#adf94ce46e3edca3fa4d93150f72f4ae406458adbfbedec1d989361675c3f37d">NOTHING</a> = 22100,
<a name="l00032"></a>00032     <a class="code" href="a00053.html#adf94ce46e3edca3fa4d93150f72f4aee12bbafd7ed8d0978ac925c1a493aabb">BITERROR</a>,       <span class="comment">//the phy has recognized a bit error in the packet</span>
<a name="l00033"></a>00033     <a class="code" href="a00053.html#adf94ce46e3edca3fa4d93150f72f4aee5c2edad30720b7e527373b28bd4e1ab">COLLISION</a>,       <span class="comment">//packet lost due to collision</span>
<a name="l00034"></a>00034     <a class="code" href="a00053.html#adf94ce46e3edca3fa4d93150f72f4ae397fbae93de43832a0bb2bc1bf7003a5">LAST_DECIDER_80211_CONTROL_KIND</a>
<a name="l00035"></a>00035   };
</pre></div>
<p>

</div>
</div><p>
<hr><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" name="07a5fe046d32020b189f73f5bbf4f010"></a><!-- doxytag: member="Decider80211::Decider80211" ref="07a5fe046d32020b189f73f5bbf4f010" args="(DeciderToPhyInterface *phy, double threshold, double sensitivity, double centerFrequency, int myIndex=&#45;1, bool debug=false)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Decider80211::Decider80211           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00057.html">DeciderToPhyInterface</a> *&nbsp;</td>
          <td class="paramname"> <em>phy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>threshold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>sensitivity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>centerFrequency</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>myIndex</em> = <code>-1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>debug</em> = <code>false</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Initializes the <a class="el" href="a00052.html" title="The basic Decider class.">Decider</a> with a pointer to its <a class="el" href="a00109.html" title="Provides initialisation for several AnalogueModels and Deciders from modules directory...">PhyLayer</a> and specific values for threshold and sensitivity. 
<p>

<p>Definition at line <a class="el" href="a00459.html#l00088">88</a> of file <a class="el" href="a00459.html">Decider80211.h</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00093"></a>00093                            :
<a name="l00094"></a>00094     <a class="code" href="a00011.html#cff4618fa7a9c2e9abf257e60e487de2">BaseDecider</a>(phy, <a class="code" href="a00011.html#5eece8bf532f92912ccbd0a3bc4d6fb0" title="sensitivity value for receiving an AirFrame">sensitivity</a>, <a class="code" href="a00011.html#33e7f02028e78116193d09d6cdbc987e" title="index for this Decider-instance given by Phy-Layer (mostly Host-index) default-value...">myIndex</a>, <a class="code" href="a00011.html#a22cd5156240713e37578172ba5557ce" title="toggles display of debugging messages">debug</a>),
<a name="l00095"></a>00095     <a class="code" href="a00053.html#252eace2ccbe59484cd209be494a3983">snrThreshold</a>(threshold),
<a name="l00096"></a>00096     <a class="code" href="a00053.html#15af6d061ab83d73474b6b94684707b6" title="The center frequency on which the decider listens for signals.">centerFrequency</a>(<a class="code" href="a00053.html#15af6d061ab83d73474b6b94684707b6" title="The center frequency on which the decider listens for signals.">centerFrequency</a>)
<a name="l00097"></a>00097   {}

</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="46c5172b26f2e0bce6454b178d8b4998"></a><!-- doxytag: member="Decider80211::~Decider80211" ref="46c5172b26f2e0bce6454b178d8b4998" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual Decider80211::~Decider80211           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="a00459.html#l00099">99</a> of file <a class="el" href="a00459.html">Decider80211.h</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00099"></a>00099 {};
</pre></div>
<p>

</div>
</div><p>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="3d7bfccf1c3b199842ea44b7c00e70b2"></a><!-- doxytag: member="Decider80211::calcChannelSenseRSSI" ref="3d7bfccf1c3b199842ea44b7c00e70b2" args="(CSRInfo &amp;requestInfo)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double Decider80211::calcChannelSenseRSSI           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00011.html#cf6221fc304163856f01b71710922cd3">CSRInfo</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>requestInfo</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Calculates the RSSI value for the passed ChannelSenseRequest. 
<p>
This method is called by <a class="el" href="a00011.html" title="Provides some base functionality for most common deciders.">BaseDecider</a> when it answers a ChannelSenseRequest and can be overridden by sub classing Deciders.<p>
Returns the maximum RSSI value inside the ChannelSenseRequest time interval and the channel the <a class="el" href="a00052.html" title="The basic Decider class.">Decider</a> currently listens to. 
<p>Reimplemented from <a class="el" href="a00011.html#f326e85e885a64d5deea135dc4bcdb85">BaseDecider</a>.</p>

<p>Definition at line <a class="el" href="a00458.html#l00048">48</a> of file <a class="el" href="a00458.html">Decider80211.cc</a>.</p>

<p>References <a class="el" href="a00355.html#l00220">BaseDecider::calculateRSSIMapping()</a>, <a class="el" href="a00459.html#l00041">centerFrequency</a>, <a class="el" href="a00372.html#l00219">MappingUtils::findMax()</a>, <a class="el" href="a00370.html#l00034">Dimension::frequency_static()</a>, <a class="el" href="a00057.html#73660771f127a990489fb04da07ea39e">DeciderToPhyInterface::getSimTime()</a>, <a class="el" href="a00364.html#l00072">Decider::phy</a>, <a class="el" href="a00370.html#l00165">Argument::setArgValue()</a>, <a class="el" href="a00370.html#l00106">Argument::setTime()</a>, and <a class="el" href="a00371.html#l00165">DimensionSet::timeFreqDomain</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00048"></a>00048                                                               {
<a name="l00049"></a>00049   simtime_t start = requestInfo.second;
<a name="l00050"></a>00050   simtime_t end = <a class="code" href="a00052.html#e47e3459af2a4a7a1f14f6e60d2fc4c8" title="A pointer to the physical layer of this Decider.">phy</a>-&gt;<a class="code" href="a00057.html#73660771f127a990489fb04da07ea39e" title="Returns the current simulation time.">getSimTime</a>();
<a name="l00051"></a>00051 
<a name="l00052"></a>00052   <a class="code" href="a00092.html" title="Represents a changeable mapping (mathematical function) from at least time to double...">Mapping</a>* rssiMap = <a class="code" href="a00011.html#11e802adb6060617d7357d308d3b2cdb" title="Calculates a RSSI-Mapping (or Noise-Strength-Mapping) for a Signal.">calculateRSSIMapping</a>(start, end);
<a name="l00053"></a>00053 
<a name="l00054"></a>00054   <a class="code" href="a00003.html" title="Defines an argument for a mapping.">Argument</a> min(<a class="code" href="a00061.html#c3f34a560d6c4ad5dc8d72dc69359b77" title="Shortcut to a DimensionSet which contains time and frequency.">DimensionSet::timeFreqDomain</a>);
<a name="l00055"></a>00055   min.setTime(start);
<a name="l00056"></a>00056   min.setArgValue(<a class="code" href="a00060.html#ad8d4dbdfadd58664a90f34ce4d8154e" title="Shortcut to the frequency Dimension, same as &amp;#39;Dimension(&amp;quot;frequency&amp;quot;)&amp;#39;...">Dimension::frequency_static</a>(), <a class="code" href="a00053.html#15af6d061ab83d73474b6b94684707b6" title="The center frequency on which the decider listens for signals.">centerFrequency</a> - 11e6);
<a name="l00057"></a>00057   <a class="code" href="a00003.html" title="Defines an argument for a mapping.">Argument</a> max(<a class="code" href="a00061.html#c3f34a560d6c4ad5dc8d72dc69359b77" title="Shortcut to a DimensionSet which contains time and frequency.">DimensionSet::timeFreqDomain</a>);
<a name="l00058"></a>00058   max.setTime(end);
<a name="l00059"></a>00059   max.setArgValue(<a class="code" href="a00060.html#ad8d4dbdfadd58664a90f34ce4d8154e" title="Shortcut to the frequency Dimension, same as &amp;#39;Dimension(&amp;quot;frequency&amp;quot;)&amp;#39;...">Dimension::frequency_static</a>(), <a class="code" href="a00053.html#15af6d061ab83d73474b6b94684707b6" title="The center frequency on which the decider listens for signals.">centerFrequency</a> + 11e6);
<a name="l00060"></a>00060 
<a name="l00061"></a>00061   <span class="keywordtype">double</span> rssi = <a class="code" href="a00094.html#668f67af89ac8cda8542a268f3c48a33" title="Iterates over the passed mapping and returns value at the key entry with the highest...">MappingUtils::findMax</a>(*rssiMap, min, max);
<a name="l00062"></a>00062 
<a name="l00063"></a>00063   <span class="keyword">delete</span> rssiMap;
<a name="l00064"></a>00064 
<a name="l00065"></a>00065   <span class="keywordflow">return</span> rssi;
<a name="l00066"></a>00066 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="d765525c74deb1b88742ed8dce4271cb"></a><!-- doxytag: member="Decider80211::checkIfSignalOk" ref="d765525c74deb1b88742ed8dce4271cb" args="(Mapping *snrMap, AirFrame *frame)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="a00055.html">DeciderResult</a> * Decider80211::checkIfSignalOk           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00092.html">Mapping</a> *&nbsp;</td>
          <td class="paramname"> <em>snrMap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">AirFrame *&nbsp;</td>
          <td class="paramname"> <em>frame</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Checks a mapping against a specific threshold (element-wise). 
<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>true , if every entry of the mapping is above threshold false , otherwise </dd></dl>

<p>Definition at line <a class="el" href="a00458.html#l00069">69</a> of file <a class="el" href="a00458.html">Decider80211.cc</a>.</p>

<p>References <a class="el" href="a00459.html#l00041">centerFrequency</a>, <a class="el" href="a00371.html#l00912">Mapping::createConstIterator()</a>, <a class="el" href="a00372.html#l00277">MappingUtils::findMin()</a>, <a class="el" href="a00370.html#l00034">Dimension::frequency_static()</a>, <a class="el" href="a00379.html#l00183">Signal::getBitrate()</a>, <a class="el" href="a00378.html#l00115">Signal::getSignalLength()</a>, <a class="el" href="a00378.html#l00111">Signal::getSignalStart()</a>, <a class="el" href="a00046.html#3a026005be6f95bd957de14f995fa586">ConstMappingIterator::getValue()</a>, <a class="el" href="a00046.html#fdafa6870cd19b3d35674a7bc777585d">ConstMappingIterator::next()</a>, <a class="el" href="a00458.html#l00112">packetOk()</a>, <a class="el" href="a00475.html#l00024">PHY_HEADER_LENGTH</a>, <a class="el" href="a00475.html#l00021">RED_PHY_HEADER_DURATION</a>, <a class="el" href="a00370.html#l00165">Argument::setArgValue()</a>, <a class="el" href="a00370.html#l00106">Argument::setTime()</a>, <a class="el" href="a00459.html#l00038">snrThreshold</a>, and <a class="el" href="a00371.html#l00165">DimensionSet::timeFreqDomain</a>.</p>

<p>Referenced by <a class="el" href="a00458.html#l00153">processSignalEnd()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00070"></a>00070 {
<a name="l00071"></a>00071   assert(snrMap);
<a name="l00072"></a>00072 
<a name="l00073"></a>00073   <a class="code" href="a00124.html" title="The signal class stores the physical representation of the signal of an AirFrame...">Signal</a>&amp; s = frame-&gt;getSignal();
<a name="l00074"></a>00074   simtime_t start = s.<a class="code" href="a00124.html#67358914ffdd97d4c08c051e6849c500" title="Returns the point in time when the receiving of the Signal started.">getSignalStart</a>();
<a name="l00075"></a>00075   simtime_t end = start + s.<a class="code" href="a00124.html#45626a4b652952d4b7d25b32164d417b" title="Returns the length of the signal transmission.">getSignalLength</a>();
<a name="l00076"></a>00076 
<a name="l00077"></a>00077   start = start + <a class="code" href="a00297.html#7121f04d75dff0f763aca848c199088f" title="duration of the PHY header">RED_PHY_HEADER_DURATION</a>; <span class="comment">//its ok if the phy header is received only</span>
<a name="l00078"></a>00078                        <span class="comment">//partly - TODO: maybe solve this nicer</span>
<a name="l00079"></a>00079   <a class="code" href="a00003.html" title="Defines an argument for a mapping.">Argument</a> min(<a class="code" href="a00061.html#c3f34a560d6c4ad5dc8d72dc69359b77" title="Shortcut to a DimensionSet which contains time and frequency.">DimensionSet::timeFreqDomain</a>);
<a name="l00080"></a>00080   min.setTime(start);
<a name="l00081"></a>00081   min.setArgValue(<a class="code" href="a00060.html#ad8d4dbdfadd58664a90f34ce4d8154e" title="Shortcut to the frequency Dimension, same as &amp;#39;Dimension(&amp;quot;frequency&amp;quot;)&amp;#39;...">Dimension::frequency_static</a>(), <a class="code" href="a00053.html#15af6d061ab83d73474b6b94684707b6" title="The center frequency on which the decider listens for signals.">centerFrequency</a> - 11e6);
<a name="l00082"></a>00082   <a class="code" href="a00003.html" title="Defines an argument for a mapping.">Argument</a> max(<a class="code" href="a00061.html#c3f34a560d6c4ad5dc8d72dc69359b77" title="Shortcut to a DimensionSet which contains time and frequency.">DimensionSet::timeFreqDomain</a>);
<a name="l00083"></a>00083   max.setTime(end);
<a name="l00084"></a>00084   max.setArgValue(<a class="code" href="a00060.html#ad8d4dbdfadd58664a90f34ce4d8154e" title="Shortcut to the frequency Dimension, same as &amp;#39;Dimension(&amp;quot;frequency&amp;quot;)&amp;#39;...">Dimension::frequency_static</a>(), <a class="code" href="a00053.html#15af6d061ab83d73474b6b94684707b6" title="The center frequency on which the decider listens for signals.">centerFrequency</a> + 11e6);
<a name="l00085"></a>00085 
<a name="l00086"></a>00086   <span class="keywordtype">double</span> snirMin = <a class="code" href="a00094.html#71b1d9b8b3821818ecba6682166d5ed5" title="Iterates over the passed mapping and returns value at the key entry with the smallest...">MappingUtils::findMin</a>(*snrMap, min, max);
<a name="l00087"></a>00087 
<a name="l00088"></a>00088   EV &lt;&lt; <span class="stringliteral">" snrMin: "</span> &lt;&lt; snirMin &lt;&lt; endl;
<a name="l00089"></a>00089 
<a name="l00090"></a>00090   <a class="code" href="a00046.html" title="Defines an const iterator for a ConstMapping which is able to iterate over the Mapping...">ConstMappingIterator</a>* bitrateIt = s.<a class="code" href="a00124.html#dfd5ce93e172004046d7714eaefb36c7" title="Returns the function representing the bitrate of the signal.">getBitrate</a>()-&gt;<a class="code" href="a00092.html#3fdd4beb095f7a98e32823d4e031da54" title="Returns an ConstMappingIterator by use of the respective implementation of the &amp;quot;createIterator(...">createConstIterator</a>();
<a name="l00091"></a>00091   bitrateIt-&gt;<a class="code" href="a00046.html#fdafa6870cd19b3d35674a7bc777585d" title="Iterates to the next position of the Mapping.">next</a>(); <span class="comment">//iterate to payload bitrate indicator</span>
<a name="l00092"></a>00092   <span class="keywordtype">double</span> payloadBitrate = bitrateIt-&gt;<a class="code" href="a00046.html#3a026005be6f95bd957de14f995fa586" title="Returns the value of the Mapping at the current position.">getValue</a>();
<a name="l00093"></a>00093   <span class="keyword">delete</span> bitrateIt;
<a name="l00094"></a>00094 
<a name="l00095"></a>00095   <a class="code" href="a00056.html" title="Defines an extended DeciderResult for the 80211 protocol which stores the bit-rate...">DeciderResult80211</a>* result = 0;
<a name="l00096"></a>00096 
<a name="l00097"></a>00097   <span class="keywordflow">if</span> (snirMin &gt; <a class="code" href="a00053.html#252eace2ccbe59484cd209be494a3983">snrThreshold</a>) {
<a name="l00098"></a>00098     <span class="keywordflow">if</span>(<a class="code" href="a00053.html#8fa275c3922106556c98a2f51b502794" title="computes if packet is ok or has errors">packetOk</a>(snirMin, frame-&gt;getBitLength() - (int)<a class="code" href="a00297.html#1be276497de806411e2c5cc3b8d5d08b" title="Length of PLCP header and Preamble.">PHY_HEADER_LENGTH</a>, payloadBitrate)) {
<a name="l00099"></a>00099       result = <span class="keyword">new</span> <a class="code" href="a00056.html" title="Defines an extended DeciderResult for the 80211 protocol which stores the bit-rate...">DeciderResult80211</a>(<span class="keyword">true</span>, payloadBitrate, snirMin);
<a name="l00100"></a>00100     } <span class="keywordflow">else</span> {
<a name="l00101"></a>00101       EV &lt;&lt; <span class="stringliteral">"Packet has BIT ERRORS! It is lost!\n"</span>;
<a name="l00102"></a>00102       result = <span class="keyword">new</span> <a class="code" href="a00056.html" title="Defines an extended DeciderResult for the 80211 protocol which stores the bit-rate...">DeciderResult80211</a>(<span class="keyword">false</span>, payloadBitrate, snirMin);
<a name="l00103"></a>00103     }
<a name="l00104"></a>00104   } <span class="keywordflow">else</span> {
<a name="l00105"></a>00105     EV &lt;&lt; <span class="stringliteral">"Packet has ERRORS! It is lost!\n"</span>;
<a name="l00106"></a>00106     result = <span class="keyword">new</span> <a class="code" href="a00056.html" title="Defines an extended DeciderResult for the 80211 protocol which stores the bit-rate...">DeciderResult80211</a>(<span class="keyword">false</span>, payloadBitrate, snirMin);
<a name="l00107"></a>00107   }
<a name="l00108"></a>00108 
<a name="l00109"></a>00109   <span class="keywordflow">return</span> result;
<a name="l00110"></a>00110 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="8fa275c3922106556c98a2f51b502794"></a><!-- doxytag: member="Decider80211::packetOk" ref="8fa275c3922106556c98a2f51b502794" args="(double snirMin, int lengthMPDU, double bitrate)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool Decider80211::packetOk           </td>
          <td>(</td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>snirMin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>lengthMPDU</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>bitrate</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
computes if packet is ok or has errors 
<p>

<p>Definition at line <a class="el" href="a00458.html#l00112">112</a> of file <a class="el" href="a00458.html">Decider80211.cc</a>.</p>

<p>References <a class="el" href="a00475.html#l00030">BANDWIDTH</a>, <a class="el" href="a00475.html#l00028">BITRATE_HEADER</a>, and <a class="el" href="a00475.html#l00026">HEADER_WITHOUT_PREAMBLE</a>.</p>

<p>Referenced by <a class="el" href="a00458.html#l00069">checkIfSignalOk()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00113"></a>00113 {
<a name="l00114"></a>00114     <span class="keywordtype">double</span> berHeader, berMPDU;
<a name="l00115"></a>00115 
<a name="l00116"></a>00116     berHeader = 0.5 * exp(-snirMin * <a class="code" href="a00297.html#007aaecac439a0b64fa29eef0da1d9b6" title="3dB filter bandwidth -- channels overlap!">BANDWIDTH</a> / <a class="code" href="a00297.html#0454abde1a622bc79c2528d728e466ef" title="Bitrate with which the header is send.">BITRATE_HEADER</a>);
<a name="l00117"></a>00117     <span class="comment">//if PSK modulation</span>
<a name="l00118"></a>00118     <span class="keywordflow">if</span> (bitrate == 1E+6 || bitrate == 2E+6) {
<a name="l00119"></a>00119         berMPDU = 0.5 * exp(-snirMin * <a class="code" href="a00297.html#007aaecac439a0b64fa29eef0da1d9b6" title="3dB filter bandwidth -- channels overlap!">BANDWIDTH</a> / bitrate);
<a name="l00120"></a>00120     }
<a name="l00121"></a>00121     <span class="comment">//if CCK modulation (modeled with 16-QAM)</span>
<a name="l00122"></a>00122     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bitrate == 5.5E+6) {
<a name="l00123"></a>00123         berMPDU = 2.0 * (1.0 - 1.0 / sqrt(pow(2.0, 4))) * erfc(sqrt(2.0*snirMin * <a class="code" href="a00297.html#007aaecac439a0b64fa29eef0da1d9b6" title="3dB filter bandwidth -- channels overlap!">BANDWIDTH</a> / bitrate));
<a name="l00124"></a>00124     }
<a name="l00125"></a>00125     <span class="keywordflow">else</span> {                       <span class="comment">// CCK, modelled with 256-QAM</span>
<a name="l00126"></a>00126         berMPDU = 2.0 * (1.0 - 1.0 / sqrt(pow(2.0, 8))) * erfc(sqrt(2.0*snirMin * <a class="code" href="a00297.html#007aaecac439a0b64fa29eef0da1d9b6" title="3dB filter bandwidth -- channels overlap!">BANDWIDTH</a> / bitrate));
<a name="l00127"></a>00127     }
<a name="l00128"></a>00128 
<a name="l00129"></a>00129     <span class="comment">//probability of no bit error in the PLCP header</span>
<a name="l00130"></a>00130     <span class="keywordtype">double</span> headerNoError = pow(1.0 - berHeader, <a class="code" href="a00297.html#478fe6b796ffdc77e63b77c4d447cf64" title="PLCP header.">HEADER_WITHOUT_PREAMBLE</a>);
<a name="l00131"></a>00131 
<a name="l00132"></a>00132     <span class="comment">//probability of no bit error in the MPDU</span>
<a name="l00133"></a>00133     <span class="keywordtype">double</span> MpduNoError = pow(1.0 - berMPDU, lengthMPDU);
<a name="l00134"></a>00134     EV &lt;&lt; <span class="stringliteral">"berHeader: "</span> &lt;&lt; berHeader &lt;&lt; <span class="stringliteral">" berMPDU: "</span> &lt;&lt; berMPDU &lt;&lt; endl;
<a name="l00135"></a>00135     <span class="keywordtype">double</span> rand = dblrand();
<a name="l00136"></a>00136 
<a name="l00137"></a>00137     <span class="comment">//if error in header</span>
<a name="l00138"></a>00138     <span class="keywordflow">if</span> (rand &gt; headerNoError)
<a name="l00139"></a>00139         <span class="keywordflow">return</span> (<span class="keyword">false</span>);
<a name="l00140"></a>00140     <span class="keywordflow">else</span>
<a name="l00141"></a>00141     {
<a name="l00142"></a>00142         rand = dblrand();
<a name="l00143"></a>00143 
<a name="l00144"></a>00144         <span class="comment">//if error in MPDU</span>
<a name="l00145"></a>00145         <span class="keywordflow">if</span> (rand &gt; MpduNoError)
<a name="l00146"></a>00146             <span class="keywordflow">return</span> (<span class="keyword">false</span>);
<a name="l00147"></a>00147         <span class="comment">//if no error</span>
<a name="l00148"></a>00148         <span class="keywordflow">else</span>
<a name="l00149"></a>00149             <span class="keywordflow">return</span> (<span class="keyword">true</span>);
<a name="l00150"></a>00150     }
<a name="l00151"></a>00151 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="1f929f5b474f7b42c5c47acdd740cc68"></a><!-- doxytag: member="Decider80211::processNewSignal" ref="1f929f5b474f7b42c5c47acdd740cc68" args="(AirFrame *frame)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">simtime_t Decider80211::processNewSignal           </td>
          <td>(</td>
          <td class="paramtype">AirFrame *&nbsp;</td>
          <td class="paramname"> <em>frame</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Processes a new <a class="el" href="a00124.html" title="The signal class stores the physical representation of the signal of an AirFrame...">Signal</a>. Returns the time it wants to handle the signal again. 
<p>
Default implementation checks if the signals receiving power is above the sensitivity of the radio and we are not already trying to receive another AirFrame. If thats the case it waits for the end of the signal. 
<p>Reimplemented from <a class="el" href="a00011.html#6a480f87157d0509c0c1fccf94ea9fef">BaseDecider</a>.</p>

<p>Definition at line <a class="el" href="a00458.html#l00012">12</a> of file <a class="el" href="a00458.html">Decider80211.cc</a>.</p>

<p>References <a class="el" href="a00459.html#l00041">centerFrequency</a>, <a class="el" href="a00356.html#l00055">BaseDecider::currentSignal</a>, <a class="el" href="a00356.html#l00013">debugEV</a>, <a class="el" href="a00356.html#l00045">BaseDecider::EXPECT_END</a>, <a class="el" href="a00370.html#l00034">Dimension::frequency_static()</a>, <a class="el" href="a00379.html#l00202">Signal::getReceivingPower()</a>, <a class="el" href="a00378.html#l00115">Signal::getSignalLength()</a>, <a class="el" href="a00378.html#l00111">Signal::getSignalStart()</a>, <a class="el" href="a00364.html#l00075">Decider::notAgain</a>, <a class="el" href="a00356.html#l00049">BaseDecider::sensitivity</a>, <a class="el" href="a00370.html#l00165">Argument::setArgValue()</a>, <a class="el" href="a00355.html#l00136">BaseDecider::setChannelIdleStatus()</a>, <a class="el" href="a00370.html#l00106">Argument::setTime()</a>, and <a class="el" href="a00371.html#l00165">DimensionSet::timeFreqDomain</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00012"></a>00012                                                         {
<a name="l00013"></a>00013   <span class="keywordflow">if</span>(<a class="code" href="a00011.html#22e578e992fab5ab54fe5fcdf196d9e3" title="pointer to the currently received AirFrame">currentSignal</a>.first != 0) {
<a name="l00014"></a>00014     <a class="code" href="a00179.html#43107a17c21e08a3b52d6957f01d3987">debugEV</a> &lt;&lt; <span class="stringliteral">"Already receiving another AirFrame!"</span> &lt;&lt; endl;
<a name="l00015"></a>00015     <span class="keywordflow">return</span> <a class="code" href="a00052.html#3edae7484aed7b0b874521c724bd3c30" title="simtime that tells the Phy-Layer not to pass an AirFrame again">notAgain</a>;
<a name="l00016"></a>00016   }
<a name="l00017"></a>00017 
<a name="l00018"></a>00018   <span class="comment">// get the receiving power of the Signal at start-time and center frequency</span>
<a name="l00019"></a>00019   <a class="code" href="a00124.html" title="The signal class stores the physical representation of the signal of an AirFrame...">Signal</a>&amp; signal = frame-&gt;getSignal();
<a name="l00020"></a>00020   <a class="code" href="a00003.html" title="Defines an argument for a mapping.">Argument</a> start(<a class="code" href="a00061.html#c3f34a560d6c4ad5dc8d72dc69359b77" title="Shortcut to a DimensionSet which contains time and frequency.">DimensionSet::timeFreqDomain</a>);
<a name="l00021"></a>00021   start.setTime(signal.<a class="code" href="a00124.html#67358914ffdd97d4c08c051e6849c500" title="Returns the point in time when the receiving of the Signal started.">getSignalStart</a>());
<a name="l00022"></a>00022   start.setArgValue(<a class="code" href="a00060.html#ad8d4dbdfadd58664a90f34ce4d8154e" title="Shortcut to the frequency Dimension, same as &amp;#39;Dimension(&amp;quot;frequency&amp;quot;)&amp;#39;...">Dimension::frequency_static</a>(), <a class="code" href="a00053.html#15af6d061ab83d73474b6b94684707b6" title="The center frequency on which the decider listens for signals.">centerFrequency</a>);
<a name="l00023"></a>00023 
<a name="l00024"></a>00024   <span class="keywordtype">double</span> recvPower = signal.<a class="code" href="a00124.html#513b1abac0b04549585257f7f5f8ebea" title="Calculates and returns the receiving power of this Signal. Ownership of the returned...">getReceivingPower</a>()-&gt;getValue(start);
<a name="l00025"></a>00025 
<a name="l00026"></a>00026   <span class="comment">// check whether signal is strong enough to receive</span>
<a name="l00027"></a>00027   <span class="keywordflow">if</span> ( recvPower &lt; <a class="code" href="a00011.html#5eece8bf532f92912ccbd0a3bc4d6fb0" title="sensitivity value for receiving an AirFrame">sensitivity</a> )
<a name="l00028"></a>00028   {
<a name="l00029"></a>00029     <a class="code" href="a00179.html#43107a17c21e08a3b52d6957f01d3987">debugEV</a> &lt;&lt; <span class="stringliteral">"Signal is to weak ("</span> &lt;&lt; recvPower &lt;&lt; <span class="stringliteral">" &lt; "</span> &lt;&lt; <a class="code" href="a00011.html#5eece8bf532f92912ccbd0a3bc4d6fb0" title="sensitivity value for receiving an AirFrame">sensitivity</a>
<a name="l00030"></a>00030         &lt;&lt; <span class="stringliteral">") -&gt; do not receive."</span> &lt;&lt; endl;
<a name="l00031"></a>00031     <span class="comment">// Signal too weak, we can't receive it, tell PhyLayer that we don't want it again</span>
<a name="l00032"></a>00032     <span class="keywordflow">return</span> <a class="code" href="a00052.html#3edae7484aed7b0b874521c724bd3c30" title="simtime that tells the Phy-Layer not to pass an AirFrame again">notAgain</a>;
<a name="l00033"></a>00033   }
<a name="l00034"></a>00034 
<a name="l00035"></a>00035   <span class="comment">// Signal is strong enough, receive this Signal and schedule it</span>
<a name="l00036"></a>00036   <a class="code" href="a00179.html#43107a17c21e08a3b52d6957f01d3987">debugEV</a> &lt;&lt; <span class="stringliteral">"Signal is strong enough ("</span> &lt;&lt; recvPower &lt;&lt; <span class="stringliteral">" &gt; "</span> &lt;&lt; <a class="code" href="a00011.html#5eece8bf532f92912ccbd0a3bc4d6fb0" title="sensitivity value for receiving an AirFrame">sensitivity</a>
<a name="l00037"></a>00037       &lt;&lt; <span class="stringliteral">") -&gt; Trying to receive AirFrame."</span> &lt;&lt; endl;
<a name="l00038"></a>00038 
<a name="l00039"></a>00039   <a class="code" href="a00011.html#22e578e992fab5ab54fe5fcdf196d9e3" title="pointer to the currently received AirFrame">currentSignal</a>.first = frame;
<a name="l00040"></a>00040   <a class="code" href="a00011.html#22e578e992fab5ab54fe5fcdf196d9e3" title="pointer to the currently received AirFrame">currentSignal</a>.second = <a class="code" href="a00011.html#e4acbca8f960e9c49379ae2a82e2d90b5539b8e545c0676dab0b0efb80dfeeac" title="Waiting for the header of the signal.">EXPECT_END</a>;
<a name="l00041"></a>00041 
<a name="l00042"></a>00042   <span class="comment">//channel turned busy</span>
<a name="l00043"></a>00043   <a class="code" href="a00011.html#e535b44e34061014fe282c36c27b0193" title="Changes the &amp;quot;isIdle&amp;quot;-status to the passed value.">setChannelIdleStatus</a>(<span class="keyword">false</span>);
<a name="l00044"></a>00044 
<a name="l00045"></a>00045   <span class="keywordflow">return</span> ( signal.<a class="code" href="a00124.html#67358914ffdd97d4c08c051e6849c500" title="Returns the point in time when the receiving of the Signal started.">getSignalStart</a>() + signal.<a class="code" href="a00124.html#45626a4b652952d4b7d25b32164d417b" title="Returns the length of the signal transmission.">getSignalLength</a>() );
<a name="l00046"></a>00046 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="2f8e006c849f1c14f4578b70358d0ecf"></a><!-- doxytag: member="Decider80211::processSignalEnd" ref="2f8e006c849f1c14f4578b70358d0ecf" args="(AirFrame *frame)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">simtime_t Decider80211::processSignalEnd           </td>
          <td>(</td>
          <td class="paramtype">AirFrame *&nbsp;</td>
          <td class="paramname"> <em>frame</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Processes a received AirFrame. 
<p>
The SNR-mapping for the <a class="el" href="a00124.html" title="The signal class stores the physical representation of the signal of an AirFrame...">Signal</a> is created and checked against the Deciders SNR-threshold. Depending on that the received AirFrame is either sent up to the MAC-Layer or dropped.<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>usually return a value for: 'do not pass it again' </dd></dl>

<p>Reimplemented from <a class="el" href="a00011.html#b9cfef6c04e12d2524d45e881f341300">BaseDecider</a>.</p>

<p>Definition at line <a class="el" href="a00458.html#l00153">153</a> of file <a class="el" href="a00458.html">Decider80211.cc</a>.</p>

<p>References <a class="el" href="a00459.html#l00032">BITERROR</a>, <a class="el" href="a00355.html#l00198">BaseDecider::calculateSnrMapping()</a>, <a class="el" href="a00458.html#l00069">checkIfSignalOk()</a>, <a class="el" href="a00356.html#l00055">BaseDecider::currentSignal</a>, <a class="el" href="a00363.html#l00004">DeciderResult::isSignalCorrect()</a>, <a class="el" href="a00364.html#l00075">Decider::notAgain</a>, <a class="el" href="a00364.html#l00072">Decider::phy</a>, <a class="el" href="a00057.html#14d6506f37de87b057084c01295d5e8c">DeciderToPhyInterface::sendControlMsg()</a>, <a class="el" href="a00057.html#3c0676323e402449d0972890c6a14df3">DeciderToPhyInterface::sendUp()</a>, and <a class="el" href="a00355.html#l00136">BaseDecider::setChannelIdleStatus()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00154"></a>00154 {
<a name="l00155"></a>00155   <span class="comment">// here the Signal is finally processed</span>
<a name="l00156"></a>00156 
<a name="l00157"></a>00157   <span class="comment">// first collect all necessary information</span>
<a name="l00158"></a>00158   <a class="code" href="a00092.html" title="Represents a changeable mapping (mathematical function) from at least time to double...">Mapping</a>* snrMap = <a class="code" href="a00011.html#bac709d59f48d292f147919854c002e2" title="Calculates a SNR-Mapping for a Signal.">calculateSnrMapping</a>(frame);
<a name="l00159"></a>00159   assert(snrMap);
<a name="l00160"></a>00160 
<a name="l00161"></a>00161   <a class="code" href="a00055.html" title="A class to represent the result of a processed packet (that is not noise) by the...">DeciderResult</a>* result = <a class="code" href="a00053.html#d765525c74deb1b88742ed8dce4271cb" title="Checks a mapping against a specific threshold (element-wise).">checkIfSignalOk</a>(snrMap, frame);
<a name="l00162"></a>00162 
<a name="l00163"></a>00163   <span class="comment">// check if the snrMapping is above the Decider's specific threshold,</span>
<a name="l00164"></a>00164   <span class="comment">// i.e. the Decider has received it correctly</span>
<a name="l00165"></a>00165   <span class="keywordflow">if</span> (result-&gt;<a class="code" href="a00055.html#a0ff5bc718c64668cb1ce09c2c7dba80" title="A Function that returns a very basic result about the Signal.">isSignalCorrect</a>())
<a name="l00166"></a>00166   {
<a name="l00167"></a>00167     EV &lt;&lt; <span class="stringliteral">"packet was received correctly, it is now handed to upper layer...\n"</span>;
<a name="l00168"></a>00168     <span class="comment">// go on with processing this AirFrame, send it to the Mac-Layer</span>
<a name="l00169"></a>00169     <a class="code" href="a00052.html#e47e3459af2a4a7a1f14f6e60d2fc4c8" title="A pointer to the physical layer of this Decider.">phy</a>-&gt;<a class="code" href="a00057.html#3c0676323e402449d0972890c6a14df3" title="Called to send an AirFrame with DeciderResult to the MACLayer.">sendUp</a>(frame, result);
<a name="l00170"></a>00170   } <span class="keywordflow">else</span>
<a name="l00171"></a>00171   {
<a name="l00172"></a>00172     EV &lt;&lt; <span class="stringliteral">"packet was not received correctly, sending it as control message to upper layer\n"</span>;
<a name="l00173"></a>00173     Mac80211Pkt* mac = <span class="keyword">static_cast&lt;</span>Mac80211Pkt*<span class="keyword">&gt;</span>(frame-&gt;decapsulate());
<a name="l00174"></a>00174     mac-&gt;setName(<span class="stringliteral">"ERROR"</span>);
<a name="l00175"></a>00175     mac-&gt;setKind(<a class="code" href="a00053.html#adf94ce46e3edca3fa4d93150f72f4aee12bbafd7ed8d0978ac925c1a493aabb">BITERROR</a>);
<a name="l00176"></a>00176     <a class="code" href="a00052.html#e47e3459af2a4a7a1f14f6e60d2fc4c8" title="A pointer to the physical layer of this Decider.">phy</a>-&gt;<a class="code" href="a00057.html#14d6506f37de87b057084c01295d5e8c" title="Called by the Decider to send a control message to the MACLayer.">sendControlMsg</a>(mac);
<a name="l00177"></a>00177     <span class="keyword">delete</span> result;
<a name="l00178"></a>00178   }
<a name="l00179"></a>00179 
<a name="l00180"></a>00180   <span class="keyword">delete</span> snrMap;
<a name="l00181"></a>00181   snrMap = 0;
<a name="l00182"></a>00182 
<a name="l00183"></a>00183 
<a name="l00184"></a>00184   <span class="comment">// we have processed this AirFrame and we prepare to receive the next one</span>
<a name="l00185"></a>00185   <a class="code" href="a00011.html#22e578e992fab5ab54fe5fcdf196d9e3" title="pointer to the currently received AirFrame">currentSignal</a>.first = 0;
<a name="l00186"></a>00186 
<a name="l00187"></a>00187   <span class="comment">//channel is idle now</span>
<a name="l00188"></a>00188   <a class="code" href="a00011.html#e535b44e34061014fe282c36c27b0193" title="Changes the &amp;quot;isIdle&amp;quot;-status to the passed value.">setChannelIdleStatus</a>(<span class="keyword">true</span>);
<a name="l00189"></a>00189 
<a name="l00190"></a>00190   <span class="keywordflow">return</span> <a class="code" href="a00052.html#3edae7484aed7b0b874521c724bd3c30" title="simtime that tells the Phy-Layer not to pass an AirFrame again">notAgain</a>;
<a name="l00191"></a>00191 }
</pre></div>
<p>

</div>
</div><p>
<hr><h2>Member Data Documentation</h2>
<a class="anchor" name="15af6d061ab83d73474b6b94684707b6"></a><!-- doxytag: member="Decider80211::centerFrequency" ref="15af6d061ab83d73474b6b94684707b6" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="a00053.html#15af6d061ab83d73474b6b94684707b6">Decider80211::centerFrequency</a><code> [protected]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
The center frequency on which the decider listens for signals. 
<p>

<p>Definition at line <a class="el" href="a00459.html#l00041">41</a> of file <a class="el" href="a00459.html">Decider80211.h</a>.</p>

<p>Referenced by <a class="el" href="a00458.html#l00048">calcChannelSenseRSSI()</a>, <a class="el" href="a00458.html#l00069">checkIfSignalOk()</a>, and <a class="el" href="a00458.html#l00012">processNewSignal()</a>.</p>

</div>
</div><p>
<a class="anchor" name="252eace2ccbe59484cd209be494a3983"></a><!-- doxytag: member="Decider80211::snrThreshold" ref="252eace2ccbe59484cd209be494a3983" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="a00053.html#252eace2ccbe59484cd209be494a3983">Decider80211::snrThreshold</a><code> [protected]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="a00459.html#l00038">38</a> of file <a class="el" href="a00459.html">Decider80211.h</a>.</p>

<p>Referenced by <a class="el" href="a00458.html#l00069">checkIfSignalOk()</a>.</p>

</div>
</div><p>
<hr>The documentation for this class was generated from the following files:<ul>
<li>modules/phy/<a class="el" href="a00459.html">Decider80211.h</a><li>modules/phy/<a class="el" href="a00458.html">Decider80211.cc</a></ul>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Mon Sep 28 15:57:02 2009 for MiXiM by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.8 </small></address>
</body>
</html>
