<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>MiXiM: BaseNetwLayer Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.8 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="classes.html"><span>Class&nbsp;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>BaseNetwLayer Class Reference<br>
<small>
[<a class="el" href="a00300.html">netwLayer - network layer modules</a>,&nbsp;<a class="el" href="a00309.html">baseModules - base module classes of MiXiM</a>]</small>
</h1><!-- doxytag: class="BaseNetwLayer" --><!-- doxytag: inherits="BaseLayer" -->Base class for the network layer.  
<a href="#_details">More...</a>
<p>
<code>#include &lt;<a class="el" href="a00345.html">BaseNetwLayer.h</a>&gt;</code>
<p>
Inherits <a class="el" href="a00016.html">BaseLayer</a>.
<p>
<div class="dynheader">
Collaboration diagram for BaseNetwLayer:</div>
<div class="dynsection">
<p><center><img src="a00780.png" border="0" usemap="#a00781" alt="Collaboration graph"></center>
<map name="a00781">
<area shape="rect" href="a00016.html" title="A very simple layer template." alt="" coords="5,5,88,32"><area shape="rect" href="a00005.html" title="A class to convert integer layer addresses." alt="" coords="112,5,184,32"></map>
<center><font size="2">[<a target="top" href="graph_legend.html">legend</a>]</font></center></div>

<p>
<a href="a00782.html">List of all members.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Public Types</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00020.html#e9b454fb23adb3ba3d2fe487f507ffab">BaseNetwMessageKinds</a> { <a class="el" href="a00020.html#e9b454fb23adb3ba3d2fe487f507ffab0739a621763c662b0064f1f92644ae05">LAST_BASE_NETW_MESSAGE_KIND</a> =  24000
 }</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00020.html#ca717c433c9975c6cbbc8f3ec8ce8af4">BaseNetwControlKinds</a> { <a class="el" href="a00020.html#ca717c433c9975c6cbbc8f3ec8ce8af49d1de6d232d7ba06347a8c4f77477b89">LAST_BASE_NETW_CONTROL_KIND</a> =  24500
 }</td></tr>

<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00020.html#1e521b5549bfe29ae94d95265c0fe8d2">initialize</a> (int)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialization of the module and some variables.  <a href="#1e521b5549bfe29ae94d95265c0fe8d2"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual cMessage *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00020.html#ddca7d4968a09f46dcfc2da9737e2f8e">decapsMsg</a> (NetwPkt *)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">decapsulate higher layer message from NetwPkt  <a href="#ddca7d4968a09f46dcfc2da9737e2f8e"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual NetwPkt *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00020.html#b3da21cae2c9e90d48534f064893ed4a">encapsMsg</a> (cPacket *)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Encapsulate higher layer packet into an NetwPkt.  <a href="#b3da21cae2c9e90d48534f064893ed4a"></a><br></td></tr>
<tr><td colspan="2"><div class="groupHeader">Handle Messages</div></td></tr>
<tr><td colspan="2"><div class="groupText">Functions to redefine by the programmer<p>
These are the functions provided to add own functionality to your modules. These functions are called whenever a self message or a data message from the upper or lower layer arrives respectively. <br><br></div></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00020.html#0b473fbb2517ac7b0c633afdb002c269">handleUpperMsg</a> (cMessage *msg)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Handle messages from upper layer.  <a href="#0b473fbb2517ac7b0c633afdb002c269"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00020.html#58afc64e0a96fe4d80d6b9f53cfd53c6">handleLowerMsg</a> (cMessage *msg)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Handle messages from lower layer.  <a href="#58afc64e0a96fe4d80d6b9f53cfd53c6"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00020.html#758f0a0b17aec922758173e19624f212">handleSelfMsg</a> (cMessage *msg)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Handle self messages.  <a href="#758f0a0b17aec922758173e19624f212"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00020.html#478dcd88ab7a82412deb8075afe61278">handleLowerControl</a> (cMessage *msg)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Handle control messages from lower layer.  <a href="#478dcd88ab7a82412deb8075afe61278"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00020.html#5265eb248cc3660c862444a3591f0ec2">handleUpperControl</a> (cMessage *msg)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Handle control messages from lower layer.  <a href="#5265eb248cc3660c862444a3591f0ec2"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00020.html#9b802bd94a739e6202690d743ecc83a2">headerLength</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Length of the NetwPkt header Read from omnetpp.ini.  <a href="#9b802bd94a739e6202690d743ecc83a2"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="a00005.html">BaseArp</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00020.html#a4c224bf9a1185097d2558f17639620c">arp</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Pointer to the arp module.  <a href="#a4c224bf9a1185097d2558f17639620c"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00020.html#b1415ba246faecc09ac82aac5b01442c">myNetwAddr</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">cached variable of my networ address  <a href="#b1415ba246faecc09ac82aac5b01442c"></a><br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Base class for the network layer. 
<p>
<dl class="author" compact><dt><b>Author:</b></dt><dd>Daniel Willkomm </dd></dl>

<p>Definition at line <a class="el" href="a00345.html#l00039">39</a> of file <a class="el" href="a00345.html">BaseNetwLayer.h</a>.</p>
<hr><h2>Member Enumeration Documentation</h2>
<a class="anchor" name="ca717c433c9975c6cbbc8f3ec8ce8af4"></a><!-- doxytag: member="BaseNetwLayer::BaseNetwControlKinds" ref="ca717c433c9975c6cbbc8f3ec8ce8af4" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="a00020.html#ca717c433c9975c6cbbc8f3ec8ce8af4">BaseNetwLayer::BaseNetwControlKinds</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl compact><dt><b>Enumerator: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" name="ca717c433c9975c6cbbc8f3ec8ce8af49d1de6d232d7ba06347a8c4f77477b89"></a><!-- doxytag: member="LAST_BASE_NETW_CONTROL_KIND" ref="ca717c433c9975c6cbbc8f3ec8ce8af49d1de6d232d7ba06347a8c4f77477b89" args="" -->LAST_BASE_NETW_CONTROL_KIND</em>&nbsp;</td><td>
Stores the id on which classes extending BaseNetw should continue their own control kinds. </td></tr>
</table>
</dl>

<p>Definition at line <a class="el" href="a00345.html#l00047">47</a> of file <a class="el" href="a00345.html">BaseNetwLayer.h</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00047"></a>00047                             {
<a name="l00050"></a>00050     <a class="code" href="a00020.html#ca717c433c9975c6cbbc8f3ec8ce8af49d1de6d232d7ba06347a8c4f77477b89">LAST_BASE_NETW_CONTROL_KIND</a> = 24500,
<a name="l00051"></a>00051   };
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="e9b454fb23adb3ba3d2fe487f507ffab"></a><!-- doxytag: member="BaseNetwLayer::BaseNetwMessageKinds" ref="e9b454fb23adb3ba3d2fe487f507ffab" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="a00020.html#e9b454fb23adb3ba3d2fe487f507ffab">BaseNetwLayer::BaseNetwMessageKinds</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl compact><dt><b>Enumerator: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" name="e9b454fb23adb3ba3d2fe487f507ffab0739a621763c662b0064f1f92644ae05"></a><!-- doxytag: member="LAST_BASE_NETW_MESSAGE_KIND" ref="e9b454fb23adb3ba3d2fe487f507ffab0739a621763c662b0064f1f92644ae05" args="" -->LAST_BASE_NETW_MESSAGE_KIND</em>&nbsp;</td><td>
Stores the id on which classes extending BaseNetw should continue their own message kinds. </td></tr>
</table>
</dl>

<p>Definition at line <a class="el" href="a00345.html#l00042">42</a> of file <a class="el" href="a00345.html">BaseNetwLayer.h</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00042"></a>00042                             {
<a name="l00045"></a>00045     <a class="code" href="a00020.html#e9b454fb23adb3ba3d2fe487f507ffab0739a621763c662b0064f1f92644ae05">LAST_BASE_NETW_MESSAGE_KIND</a> = 24000,
<a name="l00046"></a>00046   };
</pre></div>
<p>

</div>
</div><p>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="ddca7d4968a09f46dcfc2da9737e2f8e"></a><!-- doxytag: member="BaseNetwLayer::decapsMsg" ref="ddca7d4968a09f46dcfc2da9737e2f8e" args="(NetwPkt *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">cMessage * BaseNetwLayer::decapsMsg           </td>
          <td>(</td>
          <td class="paramtype">NetwPkt *&nbsp;</td>
          <td class="paramname"> <em>msg</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
decapsulate higher layer message from NetwPkt 
<p>
Decapsulates the packet from the received Network packet 
<p>Definition at line <a class="el" href="a00344.html#l00047">47</a> of file <a class="el" href="a00344.html">BaseNetwLayer.cc</a>.</p>

<p>Referenced by <a class="el" href="a00344.html#l00111">handleLowerMsg()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00048"></a>00048 {
<a name="l00049"></a>00049     cMessage *m = msg-&gt;decapsulate();
<a name="l00050"></a>00050     m-&gt;setControlInfo(<span class="keyword">new</span> <a class="code" href="a00101.html" title="Control info netw messages.">NetwControlInfo</a>(msg-&gt;getSrcAddr()));
<a name="l00051"></a>00051     <span class="comment">// delete the netw packet</span>
<a name="l00052"></a>00052     <span class="keyword">delete</span> msg;
<a name="l00053"></a>00053     <span class="keywordflow">return</span> m;
<a name="l00054"></a>00054 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="b3da21cae2c9e90d48534f064893ed4a"></a><!-- doxytag: member="BaseNetwLayer::encapsMsg" ref="b3da21cae2c9e90d48534f064893ed4a" args="(cPacket *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">NetwPkt * BaseNetwLayer::encapsMsg           </td>
          <td>(</td>
          <td class="paramtype">cPacket *&nbsp;</td>
          <td class="paramname"> <em>appPkt</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Encapsulate higher layer packet into an NetwPkt. 
<p>
Encapsulates the received ApplPkt into a NetwPkt and set all needed header fields. 
<p>Definition at line <a class="el" href="a00344.html#l00061">61</a> of file <a class="el" href="a00344.html">BaseNetwLayer.cc</a>.</p>

<p>References <a class="el" href="a00345.html#l00061">arp</a>, <a class="el" href="a00332.html#l00032">BaseArp::getMacAddr()</a>, <a class="el" href="a00402.html#l00055">NetwControlInfo::getNetwAddr()</a>, <a class="el" href="a00345.html#l00058">headerLength</a>, <a class="el" href="a00404.html#l00032">L2BROADCAST</a>, <a class="el" href="a00404.html#l00031">L3BROADCAST</a>, and <a class="el" href="a00345.html#l00064">myNetwAddr</a>.</p>

<p>Referenced by <a class="el" href="a00344.html#l00128">handleUpperMsg()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00061"></a>00061                                                  {
<a name="l00062"></a>00062     <span class="keywordtype">int</span> macAddr;
<a name="l00063"></a>00063     <span class="keywordtype">int</span> netwAddr;
<a name="l00064"></a>00064 
<a name="l00065"></a>00065     EV &lt;&lt;<span class="stringliteral">"in encaps...\n"</span>;
<a name="l00066"></a>00066 
<a name="l00067"></a>00067     NetwPkt *pkt = <span class="keyword">new</span> NetwPkt(appPkt-&gt;getName(), appPkt-&gt;getKind());
<a name="l00068"></a>00068     pkt-&gt;setBitLength(<a class="code" href="a00020.html#9b802bd94a739e6202690d743ecc83a2" title="Length of the NetwPkt header Read from omnetpp.ini.">headerLength</a>);
<a name="l00069"></a>00069 
<a name="l00070"></a>00070     <a class="code" href="a00101.html" title="Control info netw messages.">NetwControlInfo</a>* cInfo = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="a00101.html" title="Control info netw messages.">NetwControlInfo</a>*<span class="keyword">&gt;</span>(appPkt-&gt;removeControlInfo());
<a name="l00071"></a>00071 
<a name="l00072"></a>00072     <span class="keywordflow">if</span>(cInfo == 0){
<a name="l00073"></a>00073   EV &lt;&lt; <span class="stringliteral">"warning: Application layer did not specifiy a destination L3 address\n"</span>
<a name="l00074"></a>00074      &lt;&lt; <span class="stringliteral">"\tusing broadcast address instead\n"</span>;
<a name="l00075"></a>00075   netwAddr = <a class="code" href="a00307.html#gg06fc87d81c62e9abb8790b6e5713c55b9366702cbd97be712e57f88b0ef4e8c8">L3BROADCAST</a>;
<a name="l00076"></a>00076     } <span class="keywordflow">else</span> {
<a name="l00077"></a>00077   EV &lt;&lt;<span class="stringliteral">"CInfo removed, netw addr="</span>&lt;&lt; cInfo-&gt;<a class="code" href="a00101.html#7a9a8d6a6038920fb98965abbbcf6bdc" title="Getter method.">getNetwAddr</a>()&lt;&lt;endl;
<a name="l00078"></a>00078         netwAddr = cInfo-&gt;<a class="code" href="a00101.html#7a9a8d6a6038920fb98965abbbcf6bdc" title="Getter method.">getNetwAddr</a>();
<a name="l00079"></a>00079   <span class="keyword">delete</span> cInfo;
<a name="l00080"></a>00080     }
<a name="l00081"></a>00081 
<a name="l00082"></a>00082     pkt-&gt;setSrcAddr(<a class="code" href="a00020.html#b1415ba246faecc09ac82aac5b01442c" title="cached variable of my networ address">myNetwAddr</a>);
<a name="l00083"></a>00083     pkt-&gt;setDestAddr(netwAddr);
<a name="l00084"></a>00084     EV &lt;&lt; <span class="stringliteral">" netw "</span>&lt;&lt; <a class="code" href="a00020.html#b1415ba246faecc09ac82aac5b01442c" title="cached variable of my networ address">myNetwAddr</a> &lt;&lt; <span class="stringliteral">" sending packet"</span> &lt;&lt;endl;
<a name="l00085"></a>00085     <span class="keywordflow">if</span>(netwAddr == <a class="code" href="a00307.html#gg06fc87d81c62e9abb8790b6e5713c55b9366702cbd97be712e57f88b0ef4e8c8">L3BROADCAST</a>) {
<a name="l00086"></a>00086         EV &lt;&lt; <span class="stringliteral">"sendDown: nHop=L3BROADCAST -&gt; message has to be broadcasted"</span>
<a name="l00087"></a>00087            &lt;&lt; <span class="stringliteral">" -&gt; set destMac=L2BROADCAST\n"</span>;
<a name="l00088"></a>00088         macAddr = <a class="code" href="a00307.html#gg06fc87d81c62e9abb8790b6e5713c55b7f19df32f2804a6a4898283c48208a80">L2BROADCAST</a>;
<a name="l00089"></a>00089     }
<a name="l00090"></a>00090     <span class="keywordflow">else</span>{
<a name="l00091"></a>00091         EV &lt;&lt;<span class="stringliteral">"sendDown: get the MAC address\n"</span>;
<a name="l00092"></a>00092         macAddr = <a class="code" href="a00020.html#a4c224bf9a1185097d2558f17639620c" title="Pointer to the arp module.">arp</a>-&gt;<a class="code" href="a00005.html#9d8151470f2cf56cf6b4b976cf41d06a" title="returns a L2 address to a given L3 address">getMacAddr</a>(netwAddr);
<a name="l00093"></a>00093     }
<a name="l00094"></a>00094 
<a name="l00095"></a>00095     pkt-&gt;setControlInfo(<span class="keyword">new</span> <a class="code" href="a00088.html" title="Control info to pass next hop L2 addr from netw to MAC layer.">MacControlInfo</a>(macAddr));
<a name="l00096"></a>00096 
<a name="l00097"></a>00097     <span class="comment">//encapsulate the application packet</span>
<a name="l00098"></a>00098     pkt-&gt;encapsulate(appPkt);
<a name="l00099"></a>00099     EV &lt;&lt;<span class="stringliteral">" pkt encapsulated\n"</span>;
<a name="l00100"></a>00100     <span class="keywordflow">return</span> pkt;
<a name="l00101"></a>00101 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="478dcd88ab7a82412deb8075afe61278"></a><!-- doxytag: member="BaseNetwLayer::handleLowerControl" ref="478dcd88ab7a82412deb8075afe61278" args="(cMessage *msg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BaseNetwLayer::handleLowerControl           </td>
          <td>(</td>
          <td class="paramtype">cMessage *&nbsp;</td>
          <td class="paramname"> <em>msg</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Handle control messages from lower layer. 
<p>
Redefine this function if you want to process control messages from lower layers.<p>
This function currently handles one messagetype: TRANSMISSION_OVER. If such a message is received in the network layer it is deleted. This is done as this type of messages is passed on by the <a class="el" href="a00017.html" title="A very simple MAC module template which provides de- and encapsulation of messages...">BaseMacLayer</a>.<p>
It may be used by network protocols to determine when the lower layers are finished sending a message. 
<p>Implements <a class="el" href="a00016.html#a37925527fae20a5de1a755103056219">BaseLayer</a>.</p>

<p>Definition at line <a class="el" href="a00344.html#l00145">145</a> of file <a class="el" href="a00344.html">BaseNetwLayer.cc</a>.</p>

<p>References <a class="el" href="a00339.html#l00051">BaseMacLayer::TX_OVER</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00146"></a>00146 {
<a name="l00147"></a>00147   <span class="keywordflow">switch</span> (msg-&gt;getKind())
<a name="l00148"></a>00148   {
<a name="l00149"></a>00149   <span class="keywordflow">case</span> <a class="code" href="a00017.html#49e0e548a6c20d002bd67afa7b76c4835e5e0e55f7cc75b0d8bad06a212371f1">BaseMacLayer::TX_OVER</a>:
<a name="l00150"></a>00150     <span class="keyword">delete</span> msg;
<a name="l00151"></a>00151     <span class="keywordflow">break</span>;
<a name="l00152"></a>00152   <span class="keywordflow">default</span>:
<a name="l00153"></a>00153     EV &lt;&lt; <span class="stringliteral">"BaseNetwLayer does not handle control messages called "</span> &lt;&lt; msg-&gt;getName() &lt;&lt; endl;
<a name="l00154"></a>00154     <span class="keyword">delete</span> msg;
<a name="l00155"></a>00155   }
<a name="l00156"></a>00156 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="58afc64e0a96fe4d80d6b9f53cfd53c6"></a><!-- doxytag: member="BaseNetwLayer::handleLowerMsg" ref="58afc64e0a96fe4d80d6b9f53cfd53c6" args="(cMessage *msg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BaseNetwLayer::handleLowerMsg           </td>
          <td>(</td>
          <td class="paramtype">cMessage *&nbsp;</td>
          <td class="paramname"> <em>msg</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Handle messages from lower layer. 
<p>
Redefine this function if you want to process messages from lower layers before they are forwarded to upper layers<p>
If you want to forward the message to upper layers please use <a class="el" href="a00016.html#dbf061566606041db811b519f0400ed5">sendUp</a> which will take care of decapsulation and thelike 
<p>Implements <a class="el" href="a00016.html#5ca2278405070baa474dfbf059930247">BaseLayer</a>.</p>

<p>Definition at line <a class="el" href="a00344.html#l00111">111</a> of file <a class="el" href="a00344.html">BaseNetwLayer.cc</a>.</p>

<p>References <a class="el" href="a00344.html#l00047">decapsMsg()</a>, and <a class="el" href="a00336.html#l00113">BaseLayer::sendUp()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00112"></a>00112 {
<a name="l00113"></a>00113     NetwPkt *m = <span class="keyword">static_cast&lt;</span>NetwPkt *<span class="keyword">&gt;</span>(msg);
<a name="l00114"></a>00114     EV &lt;&lt; <span class="stringliteral">" handling packet from "</span> &lt;&lt; m-&gt;getSrcAddr() &lt;&lt; endl;
<a name="l00115"></a>00115     <a class="code" href="a00016.html#dbf061566606041db811b519f0400ed5" title="Sends a message to the upper layer.">sendUp</a>(<a class="code" href="a00020.html#ddca7d4968a09f46dcfc2da9737e2f8e" title="decapsulate higher layer message from NetwPkt">decapsMsg</a>(m));
<a name="l00116"></a>00116 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="758f0a0b17aec922758173e19624f212"></a><!-- doxytag: member="BaseNetwLayer::handleSelfMsg" ref="758f0a0b17aec922758173e19624f212" args="(cMessage *msg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual void BaseNetwLayer::handleSelfMsg           </td>
          <td>(</td>
          <td class="paramtype">cMessage *&nbsp;</td>
          <td class="paramname"> <em>msg</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Handle self messages. 
<p>

<p>Implements <a class="el" href="a00016.html#87d7e1e5aa73216f07e35d7be4358924">BaseLayer</a>.</p>

<p>Definition at line <a class="el" href="a00345.html#l00091">91</a> of file <a class="el" href="a00345.html">BaseNetwLayer.h</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00091"></a>00091                                              {
<a name="l00092"></a>00092   error(<span class="stringliteral">"BaseNetwLayer does not handle self messages"</span>);
<a name="l00093"></a>00093     };
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="5265eb248cc3660c862444a3591f0ec2"></a><!-- doxytag: member="BaseNetwLayer::handleUpperControl" ref="5265eb248cc3660c862444a3591f0ec2" args="(cMessage *msg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual void BaseNetwLayer::handleUpperControl           </td>
          <td>(</td>
          <td class="paramtype">cMessage *&nbsp;</td>
          <td class="paramname"> <em>msg</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Handle control messages from lower layer. 
<p>

<p>Implements <a class="el" href="a00016.html#b412568faae75040194e01d5e541dd67">BaseLayer</a>.</p>

<p>Definition at line <a class="el" href="a00345.html#l00099">99</a> of file <a class="el" href="a00345.html">BaseNetwLayer.h</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00099"></a>00099                                                   {
<a name="l00100"></a>00100         error(<span class="stringliteral">"BaseNetwLayer does not handle control messages"</span>);
<a name="l00101"></a>00101     };
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="0b473fbb2517ac7b0c633afdb002c269"></a><!-- doxytag: member="BaseNetwLayer::handleUpperMsg" ref="0b473fbb2517ac7b0c633afdb002c269" args="(cMessage *msg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BaseNetwLayer::handleUpperMsg           </td>
          <td>(</td>
          <td class="paramtype">cMessage *&nbsp;</td>
          <td class="paramname"> <em>msg</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Handle messages from upper layer. 
<p>
Redefine this function if you want to process messages from upper layers before they are send to lower layers.<p>
For the <a class="el" href="a00020.html" title="Base class for the network layer.">BaseNetwLayer</a> we just use the destAddr of the network message as a nextHop<p>
To forward the message to lower layers after processing it please use <a class="el" href="a00016.html#1873d6e3fc6d92cf8482b39f1c5ac6c8">sendDown</a>. It will take care of anything needed 
<p>Implements <a class="el" href="a00016.html#8c0fcfb2e806357a65d5bdb1c338627b">BaseLayer</a>.</p>

<p>Definition at line <a class="el" href="a00344.html#l00128">128</a> of file <a class="el" href="a00344.html">BaseNetwLayer.cc</a>.</p>

<p>References <a class="el" href="a00344.html#l00061">encapsMsg()</a>, and <a class="el" href="a00336.html#l00108">BaseLayer::sendDown()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00129"></a>00129 {
<a name="l00130"></a>00130   assert(dynamic_cast&lt;cPacket*&gt;(msg));
<a name="l00131"></a>00131     <a class="code" href="a00016.html#1873d6e3fc6d92cf8482b39f1c5ac6c8" title="Sends a message to the lower layer.">sendDown</a>(<a class="code" href="a00020.html#b3da21cae2c9e90d48534f064893ed4a" title="Encapsulate higher layer packet into an NetwPkt.">encapsMsg</a>(static_cast&lt;cPacket*&gt;(msg)));
<a name="l00132"></a>00132 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="1e521b5549bfe29ae94d95265c0fe8d2"></a><!-- doxytag: member="BaseNetwLayer::initialize" ref="1e521b5549bfe29ae94d95265c0fe8d2" args="(int)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BaseNetwLayer::initialize           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>stage</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Initialization of the module and some variables. 
<p>

<p>Reimplemented from <a class="el" href="a00016.html#70f5ea30a9980d57b8384faed29ec3eb">BaseLayer</a>.</p>

<p>Definition at line <a class="el" href="a00344.html#l00032">32</a> of file <a class="el" href="a00344.html">BaseNetwLayer.cc</a>.</p>

<p>References <a class="el" href="a00345.html#l00061">arp</a>, <a class="el" href="a00345.html#l00058">headerLength</a>, <a class="el" href="a00332.html#l00058">BaseArp::myNetwAddr()</a>, and <a class="el" href="a00345.html#l00064">myNetwAddr</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00033"></a>00033 {
<a name="l00034"></a>00034     <a class="code" href="a00020.html#1e521b5549bfe29ae94d95265c0fe8d2" title="Initialization of the module and some variables.">BaseLayer::initialize</a>(stage);
<a name="l00035"></a>00035 
<a name="l00036"></a>00036     <span class="keywordflow">if</span>(stage==0){
<a name="l00037"></a>00037         <a class="code" href="a00020.html#9b802bd94a739e6202690d743ecc83a2" title="Length of the NetwPkt header Read from omnetpp.ini.">headerLength</a>= par(<span class="stringliteral">"headerLength"</span>);
<a name="l00038"></a>00038         <a class="code" href="a00020.html#a4c224bf9a1185097d2558f17639620c" title="Pointer to the arp module.">arp</a> = <a class="code" href="a00006.html" title="Provides access to the hosts ARP module.">BaseArpAccess</a>().get();
<a name="l00039"></a>00039         <a class="code" href="a00020.html#b1415ba246faecc09ac82aac5b01442c" title="cached variable of my networ address">myNetwAddr</a> = <a class="code" href="a00020.html#a4c224bf9a1185097d2558f17639620c" title="Pointer to the arp module.">arp</a>-&gt;<a class="code" href="a00005.html#1a8544ba2ba0d786f9f98043c011acc0" title="Returns the L3 address for the passed net.">myNetwAddr</a>(<span class="keyword">this</span>);
<a name="l00040"></a>00040         EV &lt;&lt; <span class="stringliteral">" myNetwAddr "</span> &lt;&lt; <a class="code" href="a00020.html#b1415ba246faecc09ac82aac5b01442c" title="cached variable of my networ address">myNetwAddr</a> &lt;&lt; endl;
<a name="l00041"></a>00041     }
<a name="l00042"></a>00042 }
</pre></div>
<p>

</div>
</div><p>
<hr><h2>Member Data Documentation</h2>
<a class="anchor" name="a4c224bf9a1185097d2558f17639620c"></a><!-- doxytag: member="BaseNetwLayer::arp" ref="a4c224bf9a1185097d2558f17639620c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="a00005.html">BaseArp</a>* <a class="el" href="a00020.html#a4c224bf9a1185097d2558f17639620c">BaseNetwLayer::arp</a><code> [protected]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Pointer to the arp module. 
<p>

<p>Definition at line <a class="el" href="a00345.html#l00061">61</a> of file <a class="el" href="a00345.html">BaseNetwLayer.h</a>.</p>

<p>Referenced by <a class="el" href="a00344.html#l00061">encapsMsg()</a>, and <a class="el" href="a00344.html#l00032">initialize()</a>.</p>

</div>
</div><p>
<a class="anchor" name="9b802bd94a739e6202690d743ecc83a2"></a><!-- doxytag: member="BaseNetwLayer::headerLength" ref="9b802bd94a739e6202690d743ecc83a2" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="a00020.html#9b802bd94a739e6202690d743ecc83a2">BaseNetwLayer::headerLength</a><code> [protected]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Length of the NetwPkt header Read from omnetpp.ini. 
<p>

<p>Definition at line <a class="el" href="a00345.html#l00058">58</a> of file <a class="el" href="a00345.html">BaseNetwLayer.h</a>.</p>

<p>Referenced by <a class="el" href="a00344.html#l00061">encapsMsg()</a>, and <a class="el" href="a00344.html#l00032">initialize()</a>.</p>

</div>
</div><p>
<a class="anchor" name="b1415ba246faecc09ac82aac5b01442c"></a><!-- doxytag: member="BaseNetwLayer::myNetwAddr" ref="b1415ba246faecc09ac82aac5b01442c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="a00020.html#b1415ba246faecc09ac82aac5b01442c">BaseNetwLayer::myNetwAddr</a><code> [protected]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
cached variable of my networ address 
<p>

<p>Definition at line <a class="el" href="a00345.html#l00064">64</a> of file <a class="el" href="a00345.html">BaseNetwLayer.h</a>.</p>

<p>Referenced by <a class="el" href="a00344.html#l00061">encapsMsg()</a>, and <a class="el" href="a00344.html#l00032">initialize()</a>.</p>

</div>
</div><p>
<hr>The documentation for this class was generated from the following files:<ul>
<li>base/modules/<a class="el" href="a00345.html">BaseNetwLayer.h</a><li>base/modules/<a class="el" href="a00344.html">BaseNetwLayer.cc</a></ul>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Mon Sep 28 15:56:59 2009 for MiXiM by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.8 </small></address>
</body>
</html>
